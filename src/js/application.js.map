{"version":3,"file":"application.js","mappings":"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","sources":["webpack://idiotproof/./src/js/config.js","webpack://idiotproof/./src/js/utils.js","webpack://idiotproof/./src/js/app-core.js","webpack://idiotproof/./src/js/index.js"],"sourcesContent":["// config.js\nexport const CONFIG = {\n    defaultProofingPhase: 'Hamburgers',\n    fontFormats: {\n      truetype: 'ttf',\n      opentype: 'otf',\n    },\n    jsonPath: 'src/js/proof.json',\n  };","import { CONFIG } from './config.js';\n  \n  // utils.js\n  export const getFormattedDate = () => {\n    const now = new Date();\n    return now.toJSON().slice(0, 10).replace(/-/g, '/');\n  };\n  \n  export const preserveUnique = (arr) => {\n    return [...new Set(arr)];\n  };\n  \n  export const showErrorMessage = (message) => {\n    const el = document.getElementById('message');\n    if (el) {\n      el.style.display = message && message.trim().length > 0 ? 'block' : 'none';\n      el.textContent = message;\n    } else {\n      console.error('Message element not found. Error message:', message);\n    }\n  };\n  \n  export const uint8ToBase64 = (buffer) => {\n    const chunk = 8192;\n    let result = '';\n    for (let i = 0; i < buffer.length; i += chunk) {\n      const slice = buffer.subarray(i, i + chunk);\n      result += String.fromCharCode.apply(null, slice);\n    }\n    return btoa(result);\n  };\n  \n  export const sanitizeId = (id) => {\n    return id.replace(/[^a-z0-9]/gi, '_').toLowerCase();\n  };\n\n  export const localStorageClear = () => {\n    localStorage.clear();\n    localStorage.setItem('proofingPhase', CONFIG.defaultProofingPhase);\n    location.reload();\n  };\n\n  export function toggleMode() {\n    const body = document.body;\n    const currentMode = localStorage.getItem('colorMode') || 'light';\n    const newMode = currentMode === 'light' ? 'dark' : 'light';\n    \n    // Save the new mode\n    localStorage.setItem('colorMode', newMode);\n    \n    // Update UI\n    if (newMode === 'light') {\n      body.removeAttribute('data-theme');\n      document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'light_mode';\n    } else {\n      body.setAttribute('data-theme', 'dark');\n      document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'dark_mode';\n    }\n  }\n  export function toggleSettingsVisibility() {\n    const settingsToggle = document.getElementById('btn__settings-toggle');\n    const body = document.body;\n    body.classList.toggle('settings-visible');\n    settingsToggle.classList.toggle('settings-visible');\n  }\n\n  export function toggleUi() {\n\tconst toggleUIButton = document.getElementById('btn__ui-toggle');\n\tconst body = document.body;\n  \n\tbody.classList.toggle('ui-hidden');\n\tthis.classList.toggle('ui-hidden');\n\t\n\t// Optionally, you can save the state to localStorage\n\tlocalStorage.setItem('uiHidden', body.classList.contains('ui-hidden'));\n  \n\t// Check if the UI was hidden in a previous session\n\tif (localStorage.getItem('uiHidden') === 'true') {\n\t  body.classList.add('ui-hidden');\n\t  toggleUIButton.classList.add('ui-hidden');\n\t}\n  }\n  \n  export const calculateTypeScale = (baseSize = 14, ratio = 1.618, steps = 6) => {\n    const sizes = {\n      't__size-xxl': Math.round(baseSize * Math.pow(ratio, 5)),\n      't__size-xl':  Math.round(baseSize * Math.pow(ratio, 4)),\n      't__size-l':   Math.round(baseSize * Math.pow(ratio, 3)),\n      't__size-m':   Math.round(baseSize * Math.pow(ratio, 2)),\n      't__size-s':   Math.round(baseSize * Math.pow(ratio, 1)),\n      't__size-xs':  baseSize\n    };\n    return sizes;\n  };\n  \n  export const whichFontSize = (text, baseSize = 14, ratio = 1.618) => {\n    if (!text) return baseSize.toString();\n  \n    const sizes = calculateTypeScale(baseSize, ratio);\n    \n    const charCount = text.length;\n    if (charCount < 25) return sizes['t__size-xxl'];\n    if (charCount < 50) return sizes['t__size-xl'];\n    if (charCount < 95) return sizes['t__size-l'];\n    if (charCount < 200) return sizes['t__size-m'];\n    if (charCount < 1000) return sizes['t__size-s'];\n    return sizes['t__size-xs'];\n  };\n  \n  export const removeElementsByClass = (className) => {\n    document.querySelectorAll(`.${className}`).forEach(el => el.remove());\n  };\n  \n  export const removeElementById = (id) => {\n    const element = document.getElementById(id);\n    if (element) {\n      element.style.transition = 'opacity 0.5s ease';\n      element.style.opacity = '0';\n      setTimeout(() => element.remove(), 500);\n    }\n  };\n  \n  export const saveData = (id, value) => {\n    if (typeof Storage !== 'undefined') {\n      if (value !== 'thisContent') {\n        localStorage.setItem(id, value);\n      } else {\n        const content = document.getElementById(id).textContent;\n        localStorage.setItem(id, content);\n      }\n    }\n  };\n  \n  // Save content of a contenteditable element to localStorage\n  export const saveEditableContent = (elementId) => {\n    const element = document.getElementById(elementId);\n    if (!element) {\n      console.warn(`Element with ID ${elementId} not found`);\n      return;\n    }\n    \n    const content = element.innerText;\n    localStorage.setItem(elementId, content);\n  };\n\n  // Save value of an input element to localStorage\n  export const saveInputValue = (elementId) => {\n    const element = document.getElementById(elementId);\n    if (!element) {\n      console.warn(`Element with ID ${elementId} not found`);\n      return;\n    }\n    \n    localStorage.setItem(elementId, element.value);\n  };\n\n  // Get content from localStorage or return default\n  export const getStoredContent = (elementId, defaultContent = '') => {\n    return localStorage.getItem(elementId) || defaultContent;\n  };\n  \n  export function initColorMode() {\n\tconst savedMode = localStorage.getItem('colorMode') || 'light';\n\tconst body = document.body;\n  \n\tif (savedMode === 'dark') {\n\t  body.setAttribute('data-theme', 'dark');\n\t  document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'dark_mode';\n\t} else {\n\t  body.removeAttribute('data-theme');\n\t  document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'light_mode';\n\t}\n  }\n  ","import { CONFIG } from './config.js';\nimport { getFormattedDate,\n\tpreserveUnique,\n\tshowErrorMessage,\n\tuint8ToBase64,\n\tlocalStorageClear,\n\twhichFontSize,\n\tremoveElementsByClass,\n\tsaveData,\n\ttoggleMode,\n\ttoggleSettingsVisibility,\n\ttoggleUi,\n\tsaveEditableContent,\n\tsaveInputValue,\n\tgetStoredContent,\n\tcalculateTypeScale,\n\tinitColorMode  } from './utils.js';\n\nlet font = null;\nconst fontFormats = {\n    truetype: 'ttf',\n    opentype: 'otf',\n};\n\nexport const onFontLoaded = (loadedFont, fontFamilySource, fontFamily) => {\n\treturn new Promise(async (resolve, reject) => {\n\t  try {\n\t\tfont = loadedFont;\n\t\tconsole.log(`Font assigned globally: ${fontFamily}`);\n\t\t\n\t\t// Create and load the font face first\n\t\tif ('FontFace' in window) {\n\t\t  const fontFace = new FontFace(\n\t\t\tfontFamily,\n\t\t\t`url('${fontFamilySource}')`,\n\t\t\t{ format: loadedFont.outlinesFormat === 'truetype' ? 'truetype' : 'opentype' }\n\t\t  );\n\n\t\t  // Wait for the font to load\n\t\t  await fontFace.load();\n\t\t  document.fonts.add(fontFace);\n\t\t  console.log(`Font loaded successfully: ${fontFamily}`);\n\t\t}\n\n\t\t// Create and apply the font-face rule for browsers without FontFace API\n\t\tconst fontFaceRule = `\n\t\t  @font-face {\n\t\t\tfont-family: '${fontFamily}';\n\t\t\tsrc: url('${fontFamilySource}') format('${loadedFont.outlinesFormat === 'truetype' ? 'truetype' : 'opentype'}');\n\t\t  }\n\t\t`;\n\t\tconst style = document.createElement('style');\n\t\tstyle.textContent = fontFaceRule;\n\t\tdocument.head.appendChild(style);\n\t\tconsole.log(`Font-face rule applied: ${fontFaceRule}`);\n  \n\t\twindow.fontFamily = fontFamily;\n\t\tconsole.log(`Window.fontFamily set to: ${fontFamily}`);\n  \n\t\t// Wait for font to be ready before displaying data\n\t\tawait document.fonts.ready;\n\t\tawait displayFontData(fontFamily);\n  \n\t\tif (['localhost', '127.0.0.1', ''].includes(location.hostname)) {\n\t\t  localStorage.setItem('fontFamily', fontFamily);\n\t\t  localStorage.setItem('fontFamilySource', fontFamilySource);\n\t\t  console.log(`Font information saved to localStorage`);\n\t\t}\n  \n\t\t// Get current stage before setting new one\n\t\tconst currentStage = document.querySelector('.btn__stage.active')?.dataset?.stage \n\t\t\t|| localStorage.getItem('proofingPhase') \n\t\t\t|| window.proofingPhase \n\t\t\t|| 'Hamburgers';\n  \n\t\tawait setStage(currentStage);\n\t\t\n\t\tconsole.log(`Stage set successfully`);\n\t\tresolve();\n\t  } catch (error) {\n\t\tconsole.error('Error in onFontLoaded:', error);\n\t\treject(error);\n\t  }\n\t});\n  };\n\nexport const onReadFile = (event) => {\n\tconst files = event.target.files;\n\tconst fileButtonParent = document.getElementById('section__header-file-buttons');\n\tfileButtonParent.innerHTML = '';\n\n\t// First add navigation\n\tconst navGroup = generateFontNavigation();\n\tfileButtonParent.appendChild(navGroup);\n\n\t// Then add font buttons\n\tgenerateFontButtons(Array.from(files), 'server')\n\t  .then(container => {\n\t\tfileButtonParent.appendChild(container);\n\t\t// Activate the first button automatically\n\t\tconst firstButton = container.querySelector('.btn__setfont');\n\t\tif (firstButton) {\n\t\t  firstButton.click();\n\t\t}\n\t  });\n};\n\n  const readSingleFile = (file) => {\n\treturn new Promise((resolve, reject) => {\n\t  const reader = new FileReader();\n\t  \n\t  reader.onload = async (e) => {\n\t\ttry {\n\t\t  console.log(`File read successfully: ${file.name}`);\n\t\t  const font = opentype.parse(e.target.result);\n\t\t  console.log(`Font parsed successfully: ${font.names.postScriptName.en}`);\n\t\t  const fontFamily = font.names.postScriptName.en;\n\t\t  const fontFamilySource = `fonts/${fontFamily}`;\n\t\t  \n\t\t  await onFontLoaded(font, fontFamilySource, fontFamily);\n  \n\t\t  font.file = {\n\t\t\tname: file.name,\n\t\t\tlastModified: file.lastModified,\n\t\t\tsize: file.size,\n\t\t\ttype: file.type,\n\t\t  };\n\t\t  font.type = 'user:local';\n  \n\t\t  const tempUint8array = new Uint8Array(e.target.result);\n\t\t  const isVariableFont = font.tables.fvar !== undefined;\n  \n\t\t  // Set the @font-face rule\n\t\t  const fontFaceRule = `@font-face {font-family:'${fontFamily}'; src: url('data:font/ttf;base64,${uint8ToBase64(tempUint8array)}') format('truetype');}`;\n\t\t  document.getElementById('style__fontface').innerHTML += fontFaceRule;\n\t\t  console.log(`Font-face rule added: ${fontFaceRule}`);\n  \n\t\t  console.log(`Loaded font: ${fontFamily}, Variable: ${isVariableFont}`);\n  \n\t\t  showErrorMessage('');\n\t\t  resolve();\n\t\t} catch (err) {\n\t\t  console.error('Error parsing font:', err);\n\t\t  showErrorMessage(`Error loading font: ${err.message}`);\n\t\t  reject(err);\n\t\t}\n\t  };\n  \n\t  reader.onerror = (err) => {\n\t\tconsole.error('Error reading file:', err);\n\t\tshowErrorMessage(err.toString());\n\t\treject(err);\n\t  };\n  \n\t  reader.readAsArrayBuffer(file);\n\t});\n  };\n\nexport const setFont = async (fontPath, fontName) => {\n\tconsole.log(`Attempting to load font: ${fontName} from ${fontPath}`);\n\topentype.load(fontPath, (err, loadedFont) => {\n\t  if (err) {\n\t\tconsole.error('Error loading font:', err);\n\t\tshowErrorMessage(`Error loading font: ${err}`);\n\t  } else {\n\t\tconsole.log(`Font loaded successfully: ${fontName}`);\n\t\tfont = loadedFont; // Ensure this is set globally\n\t\ttry {\n\t\t  onFontLoaded(loadedFont, fontPath, fontName);\n\t\t  // After the font is loaded and processed, set the stage\n\t\t  setStage(localStorage.getItem('proofingPhase') || 'Hamburgers');\n\t\t} catch (error) {\n\t\t  console.error('Error in onFontLoaded:', error);\n\t\t  showErrorMessage(`Error processing font: ${error}`);\n\t\t}\n\t  }\n\t});\n};\n\nexport const displayFontData = async (fontFamily) => {\n    var tablename, table, property, value, tag;\n    var styles = '';\n\n    for (tablename in font.tables) {\n        table = font.tables[tablename];\n        \n        if (tablename === 'name') {\n            let nameHtml = '';\n            if (font.names.postScriptName) {\n                var postScriptName = font.names.postScriptName.en;\n            } else {\n                var postScriptName = \"Untitled Font\";\n            }\n\n            // Get version from head table\n            const version = font.tables.head.fontRevision;\n            // Format version to 2 decimal places\n            const formattedVersion = `Ver ${version}`;\n            \n\t\t\tnameHtml += `<div class=\"section__header-name-font\" spellcheck=\"false\">${postScriptName}</div>`;\n            nameHtml += `<div class=\"section__header-name-version\" spellcheck=\"false\">${formattedVersion}</div>`;\n            styles += `.t__importedfontfamily { font-family: \"${fontFamily}\" }`;\n\n            // Get and format the font's modification date\n            const modifiedDate = font.tables.head.modified;\n            const formattedDate = `Last edited ${new Date(modifiedDate * 1000).toLocaleDateString()}`;\n            nameHtml += `<div class=\"section__header-name-date\">${formattedDate}</div>`;\n            \n            document.getElementById('section__header-names').innerHTML = nameHtml;\n            continue;\n        }\n    }\n\n    // Apply styles only after font is loaded\n    document.getElementById('style__fontfamily').innerHTML = styles;\n    \n    // Set stage after font is ready\n    const currentStage = document.querySelector('.btn__stage.active')?.dataset?.stage \n        || localStorage.getItem('proofingPhase') \n        || window.proofingPhase \n        || 'Hamburgers';\n    \n    setStage(currentStage);\n};\n\nexport const setStage = (stage) => {\n\tconst article = document.getElementById('section__article-app');\n\tconst stageButtons = document.getElementById('section__header-stage-buttons');\n\t\n\tif (!font) {\n\t  console.warn('Font not loaded yet. Deferring stage setting.');\n\t  window.pendingStage = stage;\n\t  return;\n\t}\n  \n\tfetch(CONFIG.jsonPath)\n\t  .then(response => response.json())\n\t  .then(proof => {\n\t\tconst html = generateStageHtml(proof, stage);\n\t\tconst buttonHtml = generateStageButtons(proof, stage);\n  \n\t\tarticle.innerHTML = html;\n\t\tstageButtons.innerHTML = buttonHtml;\n\t\tdocument.getElementById('style__opentype-features').innerHTML = '';\n\t\t\n\t\tsaveData('proofingPhase', stage);\n  \n\t\t// Initialize type scale after rendering\n\t\tinitTypeScale();\n  \n\t\tconst lockDimensions = localStorage.getItem('lockProofDimensions') === 'true';\n\t\tapplyLockProofDimensions(lockDimensions);\n\t  })\n\t  .catch(error => console.error('Error loading JSON:', error));\n  };\n  \nconst generateStageHtml = (proof, stage) => {\n  if (!proof[stage]) {\n    return '<div class=\"item d-flex t__center\"><div class=\"item__proof\">No features found! :...(</div></div>';\n  }\n\n  const fontName = font.names.postScriptName.en;\n  const version = font.tables.head.fontRevision;\n  const formattedVersion = `Ver ${version}`;\n\n  const gsubFeatures = font.tables.gsub?.features || {};\n  const taglist = Object.values(gsubFeatures)\n    .filter(feature => typeof feature === 'object' && feature.tag)\n    .map(feature => feature.tag)\n    .filter(tag => {\n      return proof[\"Features\"][tag] !== undefined || tag.startsWith('ss');\n    });\n\n  let html = '';\n\n  // Generate standard proof windows from JSON\n  for (const title in proof[stage]) {\n    if (stage === \"Features\" && !taglist.includes(title)) {\n      continue;\n    }\n\n    const textClass = whichFontSize(proof[stage][title]);\n    const testAreaID = `section__proofing-${title}`;\n    const itemID = `item--${title}`;\n    const sliderID = `${itemID}`;\n    \n    const { fontSize, lineHeight, letterSpacing, inlineStyle } = getStoredStyles(sliderID, textClass);\n    const fvarStyle = generateFvarStyle(itemID);\n\n    html += `\n      <div id=\"${itemID}\" class=\"item\">\n        <button class=\"btn btn-link add-item-above chip\" onclick=\"insertField('${itemID}')\">+ Add Proof Window</button>\n        <div class=\"item__container d-flex\">\n          <div class=\"item__sliders pt-2\">\n            <div class=\"item__sliders-wrapper\">\n              ${generateSliders(itemID, sliderID, fontSize, lineHeight, letterSpacing)}\n              ${generateVariableSliders(itemID, sliderID)}\n              ${generateStyleButtons(itemID)}\n              ${generateFeatureCheckboxes(itemID, proof, taglist)}\n            </div>\n          </div>\n          <div class=\"item__proof ratio-letter\">\n            <button class=\"btn btn-link remove-item-this invisible\" onclick=\"removeElementsByID('${itemID}')\">×</button>\n            ${generateProofContent(stage, title, proof, testAreaID, fvarStyle, textClass)}\n            <div class=\"item__footer d-flex justify-content-between\">\n              <span class=\"item__footer-name-font\">${fontName}</span>\n              <span class=\"item__footer-name-version\">${formattedVersion}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n  \n  // Add custom proof windows for this stage\n  const customWindows = JSON.parse(localStorage.getItem('customProofWindows') || '{}');\n  if (customWindows[stage] && customWindows[stage].length > 0) {\n    for (const customItemId of customWindows[stage]) {\n      // Fixed: Create correct IDs for custom windows\n      const testAreaID = `section__proofing-custom-${customItemId}`;\n      \n      // Fixed: Use stored values with proper fallbacks\n      const { fontSize, lineHeight, letterSpacing, inlineStyle } = getStoredStyles(customItemId, 'text-xl');\n      const fvarStyle = generateFvarStyle(customItemId);\n      \n      // Fixed: Get stored content with proper fallback values\n      const savedTitle = localStorage.getItem(`${testAreaID}-title`) || 'Custom Proof Window';\n      const savedContent = localStorage.getItem(testAreaID) || 'This is a custom proof window. Type your text here.';\n\n      html += `\n        <div id=\"${customItemId}\" class=\"item custom-item\">\n          <button class=\"btn btn-link add-item-above chip\" onclick=\"insertField('${customItemId}')\">+ Add Proof Window</button>\n          <div class=\"item__container d-flex\">\n            <div class=\"item__sliders pt-2\">\n              <div class=\"item__sliders-wrapper\">\n                ${generateSliders(customItemId, customItemId, fontSize, lineHeight, letterSpacing)}\n                ${generateVariableSliders(customItemId, customItemId)}\n                ${generateStyleButtons(customItemId)}\n                ${generateFeatureCheckboxes(customItemId, proof, taglist)}\n                <div class=\"mt-2\">\n                  <button class=\"btn btn-sm btn-danger d-flex align-items-center g-1\" onclick=\"removeCustomProofWindow('${customItemId}')\">\n                    <span class=\"material-symbols-outlined\">delete</span>\n                    Remove this window\n                  </button>\n                </div>\n              </div>\n            </div>\n            <div class=\"item__proof ratio-letter\">\n              <div class=\"d-flex justify-content-between\">\n                <h6 class=\"h6\" contentEditable=\"true\" \n                    id=\"${testAreaID}-title\"\n                    onkeyup=\"saveEditableContent('${testAreaID}-title')\">${savedTitle}</h6>\n              </div>\n              <div class=\"testarea-container\">\n                <div id=\"${testAreaID}\" \n                     style=\"${inlineStyle} ${fvarStyle}\" \n                     class=\"t__importedfontfamily testarea\" \n                     contenteditable=\"true\" \n                     spellcheck=\"false\" \n                     onkeyup=\"saveEditableContent('${testAreaID}')\">\n                  ${savedContent}\n                </div>\n              </div>\n              <div class=\"item__footer d-flex justify-content-between\">\n                <span class=\"item__footer-name-font\">${fontName}</span>\n                <span class=\"item__footer-name-version\">${formattedVersion}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n  }\n  \n  return html;\n};\n\n// Also add debug logging to troubleshoot any remaining issues\nconst saveCustomProofWindow = (itemId, stage) => {\n  const customWindows = JSON.parse(localStorage.getItem('customProofWindows') || '{}');\n  if (!customWindows[stage]) {\n    customWindows[stage] = [];\n  }\n  if (!customWindows[stage].includes(itemId)) {\n    customWindows[stage].push(itemId);\n    localStorage.setItem('customProofWindows', JSON.stringify(customWindows));\n    console.log(`Added custom window \"${itemId}\" to stage \"${stage}\"`);\n    console.log('Custom windows:', JSON.stringify(customWindows));\n  }\n};\n\nconst getStoredStyles = (itemID, textClass) => {\n  const typeScale = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n  const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n  const content = document.querySelector(`#${itemID} .testarea`)?.textContent || textClass;\n  const fontSize = getItemFontSize(itemID, content, baseSize, typeScale);\n  const lineHeight = getItemLineHeight(itemID);\n  const letterSpacing = localStorage.getItem(`${itemID}-letterSpacing`) || '0';\n  const columnCount = localStorage.getItem(`${itemID}-column-count`) || '1';\n  const columnGap = localStorage.getItem(`${itemID}-column-gap`) || '1em';\n\n  const inlineStyle = `\n    font-size: ${fontSize}pt;\n    line-height: ${lineHeight};\n    letter-spacing: ${letterSpacing}em;\n    column-count: ${columnCount};\n    column-gap: ${columnGap};\n  `;\n\n  return { fontSize, lineHeight, letterSpacing, columnCount, columnGap, inlineStyle };\n};\n\nconst generateFvarStyle = (itemID) => {\n  let fvarStyle = '';\n  if (font.tables.fvar) {\n    const fvarSupport = font.tables.fvar.axes.map(axis => axis.tag);\n    fvarStyle = 'font-variation-settings: ' + \n      font.tables.fvar.axes.map(axis => {\n        const storedValue = localStorage.getItem(`${itemID}-${axis.tag}-val`);\n        const value = storedValue !== null ? storedValue : axis.defaultValue;\n        return `'${axis.tag}' ${value}`;\n      }).join(', ') + ';';\n  }\n  return fvarStyle;\n};\n\nconst generateSliders = (itemID, sliderID, fontSize, lineHeight, letterSpacing) => {\n  const hasCustomLineHeight = localStorage.getItem(`${itemID}-lineHeight`) !== null;\n  const hasCustomFontSize = localStorage.getItem(`${itemID}-fontSize`) !== null;\n  const hasCustomLetterSpacing = localStorage.getItem(`${itemID}-letterSpacing`) !== null;\n  \n  return `\n    <div>\n      <label for=\"${sliderID}-fontSize\">Font Size</label>\n      <span class=\"t__right text-small\" id=\"${sliderID}-fontSize-val\">${fontSize}pt</span>\n      <span class=\"t__right material-symbols-outlined remove\" onclick=\"removeStyleValue('${itemID}', 'fontSize')\">clear</span>\n      <input id=\"${sliderID}-fontSize\" type=\"range\" class=\"slider ${hasCustomFontSize ? 'modified' : ''}\" \n        min=\"4\" max=\"160\" step=\"2\" value=\"${fontSize}\" \n        oninput=\"passStyleValue('${itemID}', 'fontSize', this.value)\">\n    </div>\n    <div>\n      <label for=\"${sliderID}-lineHeight\">Line Height</label>\n      <span class=\"t__right text-small\" id=\"${sliderID}-lineHeight-val\">${lineHeight}</span>\n      <span class=\"t__right material-symbols-outlined remove\" onclick=\"removeStyleValue('${itemID}', 'lineHeight')\">clear</span>\n      <input id=\"${sliderID}-lineHeight\" type=\"range\" class=\"slider ${hasCustomLineHeight ? 'modified' : ''}\" \n        min=\"0.6\" max=\"3.0\" step=\"0.01\" value=\"${lineHeight}\" \n        oninput=\"passStyleValue('${itemID}', 'lineHeight', this.value)\">\n    </div>\n    <div>\n      <label for=\"${sliderID}-letterSpacing\">Letter Spacing </label>\n      <span class=\"t__right text-small\" id=\"${sliderID}-letterSpacing-val\">${letterSpacing}em</span>\n      <span class=\"t__right material-symbols-outlined remove\" onclick=\"removeStyleValue('${itemID}', 'letterSpacing')\">clear</span>\n      <input id=\"${sliderID}-letterSpacing\" type=\"range\" class=\"slider ${hasCustomLetterSpacing ? 'modified' : ''}\" \n        min=\"-0.4\" max=\"0.4\" step=\"0.01\" value=\"${letterSpacing}\" \n        oninput=\"passStyleValue('${itemID}', 'letterSpacing', this.value)\">\n    </div>\n  `;\n};\n\nconst generateVariableSliders = (itemID, sliderID) => {\n  if (!font.tables.fvar) return '';\n\n  return font.tables.fvar.axes.map(axis => {\n    const storedValue = localStorage.getItem(`${itemID}-${axis.tag}-val`);\n    const value = storedValue !== null ? storedValue : axis.defaultValue;\n    return `\n      <label for=\"${sliderID}-${axis.tag}\">${axis.name.en} </label>\n      <span class=\"t__right text-small\" id=\"${sliderID}-${axis.tag}-val\">${value}</span>\n      <input id=\"${sliderID}-${axis.tag}\" type=\"range\" class=\"slider\" min=\"${axis.minValue}\" max=\"${axis.maxValue}\" value=\"${value}\" oninput=\"passfvarValue('${itemID}', '${axis.tag}', this.value, '${font.tables.fvar.axes.map(a => a.tag).join(',')}')\">\n    `;\n  }).join('');\n};\n\nexport const generateFontButton = async (font, mode = 'local') => {\n\tlet fontName, fontPath, fontType, displayName, isVariable;\n  \n\tif (mode === 'local') {\n\t  fontName = font.replace('.', '-');\n\t  fontPath = `fonts/${font}`;\n\t  displayName = font.replace('-', ' ').replace(/\\.[^/.]+$/, \"\");\n\t  fontType = font.split('.').pop().toUpperCase();\n\t  isVariable = await isVariableFont(fontPath);\n\t} else { // server mode\n\t  fontName = font.name.replace('.', '-');\n\t  fontPath = URL.createObjectURL(font);\n\t  displayName = font.name.replace('-', ' ').replace(/\\.[^/.]+$/, \"\");\n\t  fontType = font.name.split('.').pop().toUpperCase();\n\t  isVariable = await isVariableFont(font);\n\t}\n  \n\tif (isVariable) {\n\t  fontType = 'VF';\n\t}\n  \n\tconst button = document.createElement('div');\n\tbutton.className = 'btn__setfont chip btn d-flex justify-content-between';\n\tbutton.title = mode === 'local' ? font : font.name;\n\tbutton.id = `btn__setfont-${fontName}`;\n\tbutton.innerHTML = `${displayName}<span class=\"d-flex-grow text-small text-right\">${fontType}</span>`;\n\t\n\t// Modified onclick handler to support shift-click for secondary font\n\tbutton.onclick = (e) => {\n\t  // Check if shift key is pressed\n\t  if (e.shiftKey) {\n\t\t// If shift is pressed, handle as secondary font\n\t\tconst isAlreadySecondary = button.classList.contains('secondary');\n\t\t\n\t\tif (isAlreadySecondary) {\n\t\t  // If clicking the same secondary font button, clear secondary font\n\t\t  clearSecondaryFont();\n\t\t  return;\n\t\t}\n\t\t\n\t\tdocument.querySelectorAll('.btn__setfont').forEach(btn => {\n\t\t  btn.classList.remove('secondary'); // Remove secondary from all buttons\n\t\t});\n\t\tbutton.classList.add('secondary'); // Add secondary to this button\n\t\t\n\t\t// Store and apply the secondary font\n\t\tlocalStorage.setItem('secondaryFontPath', fontPath);\n\t\tlocalStorage.setItem('secondaryFontName', fontName);\n\t\tapplySecondaryFont(fontPath, fontName);\n\t\t\n\t\t// Don't remove the active class from the primary font\n\t\treturn;\n\t  }\n\t  \n\t  // Regular click (primary font) - original behavior\n\t  document.querySelectorAll('.btn__setfont').forEach(btn => {\n\t\tbtn.classList.remove('active');\n\t\tbtn.classList.remove('visited');\n\t\t// Keep secondary font selection if exists\n\t\tif (!btn.classList.contains('secondary')) {\n\t\t  btn.classList.remove('secondary');\n\t\t}\n\t  });\n\t  \n\t  // Add active class to clicked button\n\t  button.classList.add('active');\n\t  button.classList.add('visited');\n\t  \n\t  // Apply as primary font\n\t  setFont(fontPath, fontName);\n\t};\n  \n\treturn button;\n  };\n  \nconst isVariableFont = async (font) => {\n\ttry {\n\t  let arrayBuffer;\n\t  if (typeof font === 'string') {\n\t\t// Local mode: font is a path\n\t\tconst response = await fetch(font);\n\t\tarrayBuffer = await response.arrayBuffer();\n\t  } else {\n\t\t// Server mode: font is a File object\n\t\tarrayBuffer = await font.arrayBuffer();\n\t  }\n\t  const parsedFont = opentype.parse(arrayBuffer);\n\t  return parsedFont.tables.fvar !== undefined;\n\t} catch (error) {\n\t  console.error('Error checking if font is variable:', error);\n\t  return false;\n\t}\n  };\n  \nconst generateFontFaces = (fonts) => {\n\treturn fonts.map(font => {\n\t  const fontName = font.replace('.', '-');\n\t  return `@font-face { font-family: \"${fontName}\"; src: url(\"fonts/${font}\");}`;\n\t}).join('\\n');\n  };\n\nwindow.updateColumns = (itemID) => {\n\tconst columnCount = document.getElementById(`${itemID}-column-count`).value;\n\tconst columnGap = document.getElementById(`${itemID}-column-gap`).value;\n\t\n\tpassStyleValue(itemID, 'column-count', columnCount);\n\tpassStyleValue(itemID, 'column-gap', columnGap);\n  };\n\nconst generateStyleButtons = (itemID) => `\n  <div id=\"btn__wrapper-case\">\n    <label>Case</label>\n    <div class=\"d-flex g-1 btn__wrapper\">\n      <button class=\"btn btn-link textTransform-uppercase\" title=\"Uppercase\" onclick=\"passStyleValue('${itemID}','textTransform', 'uppercase')\">TT</button>\n      <button class=\"btn btn-link textTransform-capitalize\" title=\"Capitalize\" onclick=\"passStyleValue('${itemID}','textTransform', 'capitalize')\">Tt</button>\n      <button class=\"btn btn-link textTransform-lowercase\" title=\"Lowercase\" onclick=\"passStyleValue('${itemID}','textTransform', 'lowercase')\">tt</button>\n    </div>\n  </div>\n  <div id=\"btn__wrapper-columns\">\n    <label>Columns</label>\n    <div class=\"d-flex g-1 btn__wrapper\">\n\t<span class=\"text-small\">Count</span>\n      <input class=\"input\" type=\"number\" id=\"${itemID}-column-count\" min=\"1\" max=\"6\" value=\"1\" onchange=\"updateColumns('${itemID}')\" style=\"width: 50px;\">\n\t<span class=\"text-small\">Gap</span>\n      <input class=\"input\" type=\"text\" id=\"${itemID}-column-gap\" value=\"10px\" onchange=\"updateColumns('${itemID}')\" style=\"width: 50px;\">\n    </div>\n  </div>\n`;\n\nconst getFeatureDescription = (font, tag, proof) => {\n    if (tag.startsWith('ss')) {\n        const ssNum = parseInt(tag.slice(2), 10);\n        if (ssNum >= 1 && ssNum <= 20) {\n            const nameID = 256 + (ssNum - 1);\n            const ssName = font?.names?.[nameID]?.en;\n            if (ssName) {\n                return ssName;\n            }\n            return `Stylistic Set ${ssNum}`;\n        }\n    }\n    return proof[\"Features\"]?.[tag]?.[\"abstract\"] || tag;\n};\n\nconst generateFeatureCheckboxes = (itemID, proof, taglist) => {\n    const uniqueTags = [...new Set(taglist)];\n    return `\n      <label>Features</label>  \n      <div class=\"btn__wrapper d-flex flex-wrap g-0\">\n        ${uniqueTags.map(tag => {\n          const featureDescription = getFeatureDescription(font, tag, proof);\n          const definition = proof[\"Features\"]?.[tag]?.[\"definition\"] || '';\n          \n          return `\n            <div title=\"${definition}\" class=\"chip d-flex align-items-center justify-content-between d-flex-grow\" onclick=\"document.getElementById('${itemID}-checkbox-${tag}').click()\">\n              <input id=\"${itemID}-checkbox-${tag}\" type=\"checkbox\" onclick=\"passfeatValue('${itemID}', '${tag}', '${uniqueTags.join(',')}')\">\n              <span class=\"d-flex-grow\">${featureDescription}</span>\n              <span class=\"tag-label text-small\">${tag}</span>\n            </div>\n          `;\n        }).join('')}\n      </div>\n    `;\n};\n  \nconst generateProofContent = (stage, title, proof, testAreaID, fvarStyle, textClass) => {\n    if (!proof || !proof[stage] || !proof[stage][title]) {\n      console.warn('Missing proof data:', { stage, title });\n      return '';\n    }\n\n    let content = proof[stage][title];\n    if (stage === \"Features\") {\n      content = proof[stage][title].sample || '';\n    }\n\n    const savedContent = getStoredContent(testAreaID, content) || '';\n    const savedTitle = getStoredContent(`${testAreaID}-title`, title) || '';\n    const fontSize = whichFontSize(savedContent);\n  \n    const lineHeight = getItemLineHeight(testAreaID);\n    const letterSpacing = localStorage.getItem(`${testAreaID}-letterSpacing`) || '0em';\n    const columnCount = localStorage.getItem(`${testAreaID}-column-count`) || '1';\n    const columnGap = localStorage.getItem(`${testAreaID}-column-gap`) || '1em';\n  \n    const inlineStyle = `\n      font-size: ${fontSize}pt;\n      line-height: ${lineHeight};\n      letter-spacing: ${letterSpacing};\n      column-count: ${columnCount};\n      column-gap: ${columnGap};\n    `;\n    const html = `\n      <div class=\"d-flex justify-content-between\">\n        <h6 class=\"h6\" contentEditable=\"true\" \n            id=\"${testAreaID}-title\"\n            onkeyup=\"saveEditableContent('${testAreaID}-title')\">${savedTitle}</h6>\n      </div>\n      <div class=\"testarea-container\">\n        <div id=\"${testAreaID}\" \n             style=\"${inlineStyle} ${fvarStyle}\" \n             class=\"t__importedfontfamily testarea\" \n             contenteditable=\"true\" \n             spellcheck=\"false\" \n             onkeyup=\"saveEditableContent('${testAreaID}')\">\n          ${savedContent}\n        </div>\n      </div>\n    `;\n  \n    return html;\n  };\n  \nconst formatStyleValue = (property, value) => {\n    switch (property) {\n      case 'font-size':\n        return value;\n      case 'line-height':\n        return value;\n      case 'letter-spacing':\n        return value.replace('em', '');\n      default:\n        return value;\n    }\n  };\n  \nconst updateInlineText = (itemID, property, value) => {\n\tconst container = document.querySelector(`#${itemID} .testarea-values`);\n\tif (!container) return;\n\n\tconst fontSizeSlider = document.querySelector(`#${itemID}-fontSize`);\n\tconst lineHeightSlider = document.querySelector(`#${itemID}-lineHeight`);\n\tconst letterSpacingSlider = document.querySelector(`#${itemID}-letterSpacing`);\n\n\tconst currentStyles = {\n\t\t'font-size': `${fontSizeSlider?.value || '14'}pt`,\n\t\t'line-height': lineHeightSlider?.value || '1.0',\n\t\t'letter-spacing': `${letterSpacingSlider?.value || '0'}em`\n\t};\n\n\tconst inlineStyle = Object.entries(currentStyles)\n\t\t.map(([prop, val]) => `${prop}: ${val}`)\n\t\t.join('; ');\n\n\tcontainer.innerHTML = generateTestAreaValues(inlineStyle);\n  };\n\nexport const insertField = (aboveHere) => {\n  const original = document.getElementById(aboveHere);\n  const clone = original.cloneNode(true);\n  \n  // Create a unique ID for the new proof window\n  const timestamp = Date.now();\n  const newId = `custom-item-${timestamp}`;\n  const originalId = original.id;\n  clone.id = newId;\n  \n  // Update all element IDs\n  clone.querySelectorAll('[id]').forEach(el => {\n    el.id = `${el.id}-clone-${timestamp}`;\n  });\n  \n  // Update all event handlers that reference the original ID\n  clone.querySelectorAll('[oninput]').forEach(el => {\n    // Replace the original itemID with the new one in all event handlers\n    const updatedHandler = el.getAttribute('oninput').replace(\n      new RegExp(`'${originalId}'`, 'g'), \n      `'${newId}'`\n    );\n    el.setAttribute('oninput', updatedHandler);\n  });\n  \n  // Also update onclick attributes that may reference the original ID\n  clone.querySelectorAll('[onclick]').forEach(el => {\n    const updatedHandler = el.getAttribute('onclick').replace(\n      new RegExp(`'${originalId}'`, 'g'), \n      `'${newId}'`\n    );\n    el.setAttribute('onclick', updatedHandler);\n  });\n  \n  // Reset input values\n  clone.querySelectorAll('input').forEach(input => {\n    if (input.type === 'range') {\n      // Don't reset slider values - they'll be handled by the style system\n    } else {\n      input.value = '';\n    }\n  });\n  \n  // Change the content to something new\n  const testarea = clone.querySelector('.testarea');\n  if (testarea) {\n    testarea.innerHTML = \"This is a new custom proof window. Type your text here.\";\n    \n    // Save the content to localStorage\n    saveEditableContent(testarea.id);\n  }\n  \n  // Change the title\n  const title = clone.querySelector('[id$=\"-title\"]');\n  if (title) {\n    title.innerHTML = \"Custom Proof Window\";\n    \n    // Save the title to localStorage\n    saveEditableContent(title.id);\n  }\n  \n  original.parentNode.insertBefore(clone, original);\n  \n  // Animate the insertion\n  clone.style.height = '0px';\n  clone.style.overflow = 'hidden';\n  clone.style.transition = 'height 0.6s ease';\n  \n  setTimeout(() => {\n    clone.style.height = `${clone.scrollHeight}px`;\n  }, 0);\n  \n  setTimeout(() => {\n    clone.style.height = 'auto';\n    clone.style.overflow = 'visible';\n    \n    // Save custom proof window to localStorage\n    saveCustomProofWindow(newId, getCurrentStage());\n  }, 600);\n};\n\nconst getCurrentStage = () => {\n  return localStorage.getItem('proofingPhase') || 'Hamburgers';\n};\n\nexport const passStyleValue = (itemID, property, value) => {\n\tconst elementIdSuffix = `-${property}-val`;\n\tconst element = document.querySelector(`[id$=\"${itemID}${elementIdSuffix}\"]`);\n\t\n    if (['fontSize', 'lineHeight', 'letterSpacing', 'column-count', 'column-gap'].includes(property)) {\n        localStorage.setItem(`${itemID}-${property}`, value);\n        \n        let displayValue = value;\n        if (property === 'fontSize') displayValue += 'pt';\n        if (property === 'letterSpacing') displayValue += 'em';\n        if (element) element.textContent = displayValue;\n\n        const slider = document.querySelector(`#${itemID}-${property}`);\n        if (slider) {\n            slider.classList.add('modified');\n        }\n    }\n\n    const testarea = document.querySelector(`#${itemID} .testarea`);\n    if (testarea) {\n        let styleValue = value;\n        if (property === 'fontSize') styleValue += 'pt';\n        if (property === 'letterSpacing') styleValue += 'em';\n        testarea.style[property] = styleValue;\n    }\n\n    updateInlineText(itemID, property, value);\n  };\n  \nexport const passfvarValue = (itemID, property, value, fvarSupport) => {\n    const element = document.getElementById(`${itemID}-${property}-val`);\n    if (element) {\n        element.textContent = value;\n    } else {\n        console.warn(`Element with ID ${itemID}-${property}-val not found.`);\n    }\n\n    saveData(`${itemID}-${property}-val`, value);\n\n    const fvarSupportArray = fvarSupport.split(',');\n    let fvarcss = fvarSupportArray.map(tag => {\n        const tagValue = tag === property ? value : document.getElementById(`${itemID}-${tag}`)?.value;\n        return `'${tag}' ${tagValue}`;\n    }).join(', ');\n\n    const testarea = document.querySelector(`#${itemID} .testarea`);\n    if (testarea) {\n        testarea.style.fontVariationSettings = fvarcss;\n    } else {\n        console.warn(`Test area with ID ${itemID} not found.`);\n    }\n\n    updateInlineText(itemID, 'fvar', fvarcss);\n};\n  \nexport const passfeatValue = (itemID, feature, featureSupport) => {\n\tconst featSupport = featureSupport.split(',');\n\tlet featcss = \"\";\n  \n\tfor (let f = 0; f < featSupport.length; f++) {\n\t  if (document.getElementById(`${itemID}-checkbox-${featSupport[f]}`).checked) {\n\t\tfeatcss += `'${featSupport[f]}',`;\n\t  }\n\t}\n\tfeatcss = featcss.replace(/,\\s*$/, \"\");\n\tdocument.querySelector(`#${itemID} .testarea`).style.fontFeatureSettings = featcss;\n  };\n  \nconst updateActiveButton = (property, value) => {\n\tdocument.querySelectorAll(`.btn.${property}-${value}`).forEach(btn => {\n\t  btn.classList.add('active');\n\t  \n\t  const wrapper = btn.closest('.btn__wrapper');\n\t  \n\t  if (wrapper) {\n\t\twrapper.querySelectorAll('.btn').forEach(sibling => {\n\t\t  if (sibling !== btn) sibling.classList.remove('active');\n\t\t});\n\t  } else {\n\t\tdocument.querySelectorAll(`.btn[class*=\"${property}-\"]`).forEach(sibling => {\n\t\t  if (sibling !== btn) sibling.classList.remove('active');\n\t\t});\n\t  }\n\t});\n  };\n\nexport const removeStyleValue = (itemID, property) => {\n    localStorage.removeItem(`${itemID}-${property}`);\n    \n    let defaultValue;\n    if (property === 'fontSize') {\n        const testarea = document.querySelector(`#${itemID} .testarea`);\n        const text = testarea?.textContent || '';\n        const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n        const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n        defaultValue = whichFontSize(text, baseSize, ratio);\n    } else if (property === 'lineHeight') {\n        defaultValue = getGlobalLineHeight();\n    } else if (property === 'letterSpacing') {\n        defaultValue = '0';\n    } else {\n        defaultValue = '0';\n    }\n\n    const slider = document.querySelector(`#${itemID}-${property}`);\n    if (slider) {\n        slider.value = defaultValue;\n        slider.classList.remove('modified');\n    }\n\n    const valueDisplay = document.querySelector(`#${itemID}-${property}-val`);\n    if (valueDisplay) {\n        let displayValue = defaultValue;\n        if (property === 'fontSize') displayValue += 'pt';\n        if (property === 'letterSpacing') displayValue += 'em';\n        valueDisplay.textContent = displayValue;\n    }\n\n    const testarea = document.querySelector(`#${itemID} .testarea`);\n    if (testarea) {\n        let styleValue = defaultValue;\n        if (property === 'fontSize') styleValue += 'pt';\n        if (property === 'letterSpacing') styleValue += 'em';\n        testarea.style[property] = styleValue;\n    }\n\n    updateInlineText(itemID, property, defaultValue);\n\n};\n\nwindow.removeStyleValue = removeStyleValue;\n\nexport const generateStageButtons = (proof, currentStage) => {\n  const hiddenTabs = JSON.parse(localStorage.getItem('hiddenTabs') || '[]');\n  const visibleStages = Object.keys(proof).filter(stage => !hiddenTabs.includes(stage));\n  \n  if (visibleStages.length === 0 && Object.keys(proof).length > 0) {\n    const defaultTab = 'Hamburgers' in proof ? 'Hamburgers' : Object.keys(proof)[0];\n    visibleStages.push(defaultTab);\n    const updatedHiddenTabs = hiddenTabs.filter(tab => tab !== defaultTab);\n    localStorage.setItem('hiddenTabs', JSON.stringify(updatedHiddenTabs));\n  }\n  \n  return visibleStages.map(stage => {\n    const isActive = stage === currentStage ? 'active' : '';\n    return `\n      <div class=\"tab-item ${isActive} tab__setstage\" onclick=\"setStage('${stage}')\">\n      <a href=\"#\" class=\"stage-button d-flex justify-content-between g-2\">\n        <span class=\"stage-name\">\n        ${stage}\n        </span>\n        <span class=\"t__right tab-remove material-symbols-outlined remove\" \n          onclick=\"event.stopPropagation(); removeTab('${stage}')\">\n        clear\n        </span>\n      </a>\n      </div>\n    `;\n  }).join('');\n};\n\nexport const removeTab = (stageName) => {\n  const hiddenTabs = JSON.parse(localStorage.getItem('hiddenTabs') || '[]');\n  \n  if (!hiddenTabs.includes(stageName)) {\n    hiddenTabs.push(stageName);\n    localStorage.setItem('hiddenTabs', JSON.stringify(hiddenTabs));\n  }\n  \n  const currentStage = localStorage.getItem('proofingPhase');\n  if (currentStage === stageName) {\n    fetch(CONFIG.jsonPath)\n      .then(response => response.json())\n      .then(proof => {\n        const allTabs = Object.keys(proof);\n        const visibleTabs = allTabs.filter(tab => !hiddenTabs.includes(tab));\n        \n        if (visibleTabs.length > 0) {\n          setStage(visibleTabs[0]);\n        } else {\n          const defaultTab = 'Hamburgers' in proof ? 'Hamburgers' : allTabs[0];\n          hiddenTabs.splice(hiddenTabs.indexOf(defaultTab), 1);\n          localStorage.setItem('hiddenTabs', JSON.stringify(hiddenTabs));\n          setStage(defaultTab);\n        }\n      });\n  } else {\n    fetch(CONFIG.jsonPath)\n      .then(response => response.json())\n      .then(proof => {\n        const stageButtons = document.getElementById('section__header-stage-buttons');\n        stageButtons.innerHTML = generateStageButtons(proof, currentStage);\n      });\n  }\n};\n\nwindow.removeTab = removeTab;\n\nexport const restoreAllTabs = () => {\n  localStorage.removeItem('hiddenTabs');\n  \n  const currentStage = localStorage.getItem('proofingPhase') || 'Hamburgers';\n  setStage(currentStage);\n};\n\nconst originalLocalStorageClear = window.localStorageClear;\nwindow.localStorageClear = () => {\n  originalLocalStorageClear();\n  localStorage.removeItem('hiddenTabs');\n};\n\nexport const localLoad = () => {\n\tconst fileButtonParent = document.getElementById('section__header-file-buttons');\n\t\n\tfetch('../src/txt/fonts.txt')\n\t  .then(response => response.text())\n\t  .then(data => {\n\t\tconst fonts = data.split('fonts/')\n\t\t  .filter(font => font.trim() !== '')\n\t\t  .map(font => font.trim());\n  \n\t\tconst uniqueFonts = preserveUnique(fonts.sort());\n\t\t\n\t\tif (uniqueFonts.length === 0) {\n\t\t  fileButtonParent.innerHTML = 'Place fonts you want to proof into <code>/fonts</code> to begin';\n\t\t} else {\n\t\t  const navGroup = generateFontNavigation();\n\t\t  fileButtonParent.appendChild(navGroup);\n\t\t  \n\t\t  generateFontButtons(uniqueFonts, 'local')\n\t\t    .then(container => {\n\t\t      fileButtonParent.appendChild(container);\n\t\t      const fontFamilySource = localStorage.getItem('fontFamilySource') || \n\t\t        `fonts/${uniqueFonts[uniqueFonts.length - 1]}`;\n\t\t      const fontFamily = localStorage.getItem('fontFamily') || \n\t\t        fontFamilySource.replace('.', '-');\n\t\t      setFont(fontFamilySource, fontFamily);\n\t\t    });\n\t\t}\n\t  })\n\t  .catch(error => {\n\t\tconsole.error('Error loading fonts:', error);\n\t\tfileButtonParent.innerHTML = 'Place fonts you want to proof into <code>/fonts</code> to begin';\n\t  });\n  };\n  \nexport const serverLoad = () => {\n\tconst fileButtonParent = document.getElementById('section__header-file-buttons');\n\t\n\tsetFont('fonts/gooper-VF.ttf', 'gooper-VF-ttf');\n\tdocument.getElementById('style__fontface').innerHTML = '@font-face { font-family: \"gooper-VF-ttf\"; src: url(\"fonts/gooper-VF.ttf\");}';\n  \n\tconst dragDropHtml = `\n\t  <div id=\"drag-drop-area\" class=\"drag-drop-area\">\n\t\t<p>Drag & drop font files here</p>\n\t\t<p>or</p>\n\t\t<label for=\"fontInput\" class=\"file-input-label\">Choose Files</label>\n\t\t<input id=\"fontInput\" type=\"file\" class=\"file-input\" multiple accept=\".ttf,.otf,.woff,.woff2\" />\n\t  </div>\n\t`;\n\n\tfileButtonParent.innerHTML = dragDropHtml;\n  \n\tconst dragDropArea = document.getElementById('drag-drop-area');\n\tconst fileInput = document.getElementById('fontInput');\n  \n\t['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n\t  dragDropArea.addEventListener(eventName, preventDefaults, false);\n\t  document.body.addEventListener(eventName, preventDefaults, false);\n\t});\n  \n\t['dragenter', 'dragover'].forEach(eventName => {\n\t  dragDropArea.addEventListener(eventName, highlight, false);\n\t});\n  \n\t['dragleave', 'drop'].forEach(eventName => {\n\t  dragDropArea.addEventListener(eventName, unhighlight, false);\n\t});\n  \n\tdragDropArea.addEventListener('drop', handleDrop, false);\n  \n\tfileInput.addEventListener('change', handleFiles, false);\n  };\n  \nfunction preventDefaults(e) {\n\te.preventDefault();\n\te.stopPropagation();\n  }\n  \nfunction highlight(e) {\n\tdocument.getElementById('drag-drop-area').classList.add('highlight');\n  }\n  \nfunction unhighlight(e) {\n\tdocument.getElementById('drag-drop-area').classList.remove('highlight');\n  }\n  \nfunction handleDrop(e) {\n\tconst dt = e.dataTransfer;\n\tconst files = dt.files;\n\thandleFiles(files);\n  }\n  \nfunction handleFiles(filesOrEvent) {\n\tlet files;\n\tif (filesOrEvent instanceof Event) {\n\t  files = filesOrEvent.target.files;\n\t} else {\n\t  files = filesOrEvent;\n\t}\n  \n\tfiles = Array.from(files);\n\t\n\tconst uploadPromises = files.map(file => uploadFile(file));\n  \n\tPromise.all(uploadPromises).then(() => {\n\t  setTimeout(() => {\n\t\tconst firstButton = document.querySelector('.btn__setfont');\n\t\tif (firstButton) {\n\t\t  firstButton.click();\n\t\t}\n\t  }, 100);\n\t});\n  }\n  \nfunction uploadFile(file) {\n\treturn new Promise((resolve) => {\n\t  onReadFile({ target: { files: [file] } });\n\t  setTimeout(resolve, 50);\n\t});\n  }\n  \nfunction previewFile(file) {\n\tconst reader = new FileReader();\n\treader.readAsDataURL(file);\n\treader.onloadend = function() {\n\t  const img = document.createElement('img');\n\t  img.src = reader.result;\n\t  document.getElementById('drag-drop-area').appendChild(img);\n\t}\n  }\n  \nexport const setupEventListeners = () => {\n\tconst fileButtons = document.getElementById('section__header-file-buttons');\n\tconst stageButtons = document.getElementById('section__header-stage-buttons');\n\tconst toolsToggle = document.getElementById('btn__view-tools-toggle');\n\tconst modeToggle = document.getElementById('btn__mode-toggle');\n\tconst localStorageClearButton = document.getElementById('btn__reset-local-storage');\n\tconst settingsToggle = document.getElementById('btn__settings-toggle');\n\tconst addNameAndVersionCheckbox = document.getElementById('checkbox__add-name-and-version');\n\tconst lockProofDimensionsCheckbox = document.getElementById('checkbox__lock-proof-dimensions');\n\tif (fileButtons) {\n\t  fileButtons.addEventListener('click', handleFileButtonClick);\n\t}\n\tif (stageButtons) {\n\t  stageButtons.addEventListener('click', handleStageButtonClick);\n\t}\n\tif (toolsToggle) {\n\t  toolsToggle.addEventListener('click', toggleToolsVisibility);\n\t}\n\tif (modeToggle) {\n\t\tmodeToggle.addEventListener('click', toggleMode);\n\t}\n\tif (localStorageClearButton) {\n\t\tlocalStorageClearButton.addEventListener('click', localStorageClear);\n\t}\n\tif (settingsToggle) {\n\t\tsettingsToggle.addEventListener('click', toggleSettingsVisibility);\n\t}\n\tif (addNameAndVersionCheckbox) {\n\t\tconst savedState = localStorage.getItem('showNameAndVersion') === 'true';\n\t\taddNameAndVersionCheckbox.checked = savedState;\n\t\tdocument.body.classList.toggle('show-font-details', savedState);\n\t\t\n\t\taddNameAndVersionCheckbox.addEventListener('change', toggleNameAndVersion);\n\t}\n\tif (lockProofDimensionsCheckbox) {\n\t\tconst savedState = localStorage.getItem('lockProofDimensions') === 'true';\n\t\tlockProofDimensionsCheckbox.checked = savedState;\n\t\t\n\t\tapplyLockProofDimensions(savedState);\n\t\t\n\t\tlockProofDimensionsCheckbox.addEventListener('change', toggleLockProofDimensions);\n\t}\n\tsetupPasteHandling();\n\n\tconst aspectRatioSelect = document.getElementById('select__aspect-ratio');\n\tif (aspectRatioSelect) {\n\t\tconst proofs = document.querySelectorAll('.item__proof');\n\t\tproofs.forEach(proof => proof.classList.add('ratio-letter'));\n\n\t\taspectRatioSelect.addEventListener('change', (e) => {\n\t\t\tconst ratio = e.target.value;\n\t\t\tconst proofs = document.querySelectorAll('.item__proof');\n\t\t\t\n\t\t\tproofs.forEach(proof => {\n\t\t\t\tproof.classList.remove('ratio-letter', 'ratio-a4');\n\t\t\t\tproof.classList.add(ratio === '8.5:11' ? 'ratio-letter' : 'ratio-a4');\n\t\t\t});\n\n\t\t\tlocalStorage.setItem('preferred-ratio', ratio);\n\t\t});\n\n\t\tconst savedRatio = localStorage.getItem('preferred-ratio');\n\t\tif (savedRatio) {\n\t\t\taspectRatioSelect.value = savedRatio;\n\t\t\taspectRatioSelect.dispatchEvent(new Event('change'));\n\t\t}\n\t}\n\n\tconst baseFontInput = document.getElementById('input__base-font-size');\n\tif (baseFontInput) {\n\t\tbaseFontInput.addEventListener('change', (e) => {\n\t\t\tconst baseSize = parseFloat(e.target.value);\n\t\t\tlocalStorage.setItem('base-font-size', baseSize);\n\t\t\tupdateAllTypeScales();\n\t\t});\n\n\t\tconst savedBaseSize = localStorage.getItem('base-font-size') || '14';\n\t\tbaseFontInput.value = savedBaseSize;\n\t}\n\n\tconst lineHeightInput = document.getElementById('input__line-height');\n\tif (lineHeightInput) {\n\t\tlineHeightInput.addEventListener('change', (e) => {\n\t\t\tconst lineHeight = parseFloat(e.target.value);\n\t\t\tlocalStorage.setItem('line-height', lineHeight);\n\t\t\tupdateAllLineHeights();\n\t\t});\n\n\t\tconst savedLineHeight = getGlobalLineHeight();\n\t\tlineHeightInput.value = savedLineHeight;\n\t}\n\n\tconst typeScaleSelect = document.getElementById('select__type-scale');\n\tif (typeScaleSelect) {\n\t\ttypeScaleSelect.addEventListener('change', () => {\n\t\t\tupdateAllTypeScales();\n\t\t});\n\t}\n\n\tinitColorMode();\n\n\tsetupCycleSpeedListener();\n  };\n  \nconst handleFileButtonClick = (event) => {\n\tif (event.target.classList.contains('btn__setfont')) {\n\t  event.target.classList.add('active', 'visited');\n\t  const siblings = Array.from(event.target.parentNode.children).filter(child => child !== event.target);\n\t  siblings.forEach(sibling => sibling.classList.remove('active'));\n\t}\n  };\n  \nconst handleStageButtonClick = (event) => {\n\tif (event.target.classList.contains('btn__setstage')) {\n\t  event.target.classList.add('active');\n\t  const siblings = Array.from(event.target.parentNode.children).filter(child => child !== event.target);\n\t  siblings.forEach(sibling => sibling.classList.remove('active'));\n\t}\n  };\n  \nconst toggleToolsVisibility = () => {\n\tdocument.body.classList.toggle('tools-visible');\n  };\n\nconst setupPasteHandling = () => {\n  document.addEventListener('paste', (e) => {\n    if (!e.target.classList.contains('testarea')) {\n      return;\n    }\n\n    e.preventDefault();\n\n    const text = (e.clipboardData || window.clipboardData).getData('text/plain');\n\n    const selection = window.getSelection();\n    if (selection.rangeCount) {\n      const range = selection.getRangeAt(0);\n      range.deleteContents();\n      range.insertNode(document.createTextNode(text));\n    } else {\n      e.target.textContent += text;\n    }\n\n    const event = new Event('keyup');\n    e.target.dispatchEvent(event);\n  });\n\n  // Handle keyboard shortcuts for italic formatting\n  document.addEventListener('keydown', (e) => {\n    // Check for Cmd+I (Mac) or Ctrl+I (Windows/Linux)\n    if ((e.metaKey || e.ctrlKey) && e.key === 'i') {\n      const activeElement = document.activeElement;\n      \n      // Only handle if we're in a testarea and have a secondary font selected\n      if (activeElement && activeElement.classList.contains('testarea')) {\n        const secondaryFontName = localStorage.getItem('secondaryFontName');\n        \n        if (secondaryFontName) {\n          e.preventDefault(); // Prevent default italic behavior\n          \n          // Toggle italic using our secondary font system\n          document.execCommand('italic', false, null);\n          \n          // The CSS we added will handle the font substitution and prevent faux italic\n        }\n      }\n    }\n  });\n};\n\nexport const generateFontButtons = async (fonts, mode = 'local') => {\n  const container = document.createElement('div');\n  container.className = 'font-buttons-container';\n\n  const chipsContainer = document.createElement('div');\n  chipsContainer.className = 'font-chips';\n  \n  for (const font of fonts) {\n    const button = await generateFontButton(font, mode);\n    chipsContainer.appendChild(button);\n  }\n\n  return chipsContainer;\n};\n\nexport const generateFontNavigation = () => {\n  const navGroup = document.createElement('div');\n  navGroup.className = 'btn-group d-flex g-1 mb-2 font-nav-group';\n  \n  const prevButton = document.createElement('button');\n  prevButton.className = 'btn d-flex align-items-center justify-content-between d-flex-grow';\n  prevButton.innerHTML = '<span class=\"material-symbols-outlined\">chevron_left</span> Prev';\n  prevButton.onclick = () => navigateFonts('prev');\n  \n  const playButton = document.createElement('button');\n  playButton.className = 'btn font-play-btn d-flex align-items-center justify-content-center';\n  playButton.title = 'Auto-cycle through fonts';\n  playButton.innerHTML = '<span class=\"material-symbols-outlined\">play_arrow</span>';\n  playButton.setAttribute('data-playing', 'false');\n  playButton.onclick = toggleFontAnimation;\n  \n  const nextButton = document.createElement('button');\n  nextButton.className = 'btn d-flex align-items-center justify-content-between d-flex-grow';\n  nextButton.innerHTML = 'Next <span class=\"material-symbols-outlined\">chevron_right</span>';\n  nextButton.onclick = () => navigateFonts('next');\n  \n  navGroup.appendChild(prevButton);\n  navGroup.appendChild(playButton);\n  navGroup.appendChild(nextButton);\n  \n  return navGroup;\n};\n\nconst navigateFonts = (direction) => {\n  const buttons = document.querySelectorAll('.btn__setfont');\n  const activeButton = document.querySelector('.btn__setfont.active');\n  \n  if (!buttons.length) return;\n  \n  let nextIndex = 0;\n  \n  if (activeButton) {\n    const currentIndex = Array.from(buttons).indexOf(activeButton);\n    \n    if (direction === 'next') {\n      nextIndex = (currentIndex + 1) % buttons.length;\n    } else {\n      nextIndex = (currentIndex - 1 + buttons.length) % buttons.length;\n    }\n  }\n  \n  buttons[nextIndex].click();\n};\n\nconst initAspectRatio = () => {\n  const select = document.getElementById('select__aspect-ratio');\n  const proofs = document.querySelectorAll('.item__proof');\n\n  const normalizeRatio = (ratioStr) => {\n    const [width, height] = ratioStr.split(':').map(Number);\n    return width / height;\n  };\n\n  proofs.forEach(proof => {\n    const ratioStr = select.value;\n    const ratio = normalizeRatio(ratioStr);\n    proof.style.aspectRatio = ratio;\n  });\n\n  select.addEventListener('change', (e) => {\n    const ratioStr = e.target.value;\n    const ratio = normalizeRatio(ratioStr);\n    \n    proofs.forEach(proof => {\n      proof.style.aspectRatio = ratio;\n    });\n    \n    localStorage.setItem('preferred-ratio', ratioStr);\n  });\n\n  const savedRatio = localStorage.getItem('preferred-ratio');\n  if (savedRatio) {\n    select.value = savedRatio;\n    select.dispatchEvent(new Event('change'));\n  }\n};\n\nconst initTypeScale = () => {\n    const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n    const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n    \n    document.querySelectorAll('.item').forEach(item => {\n        const itemID = item.id;\n        const testarea = item.querySelector('.testarea');\n        const text = testarea?.textContent || '';\n        \n        const itemLineHeight = getItemLineHeight(itemID);\n        const itemFontSize = getItemFontSize(itemID, text, baseSize, ratio);\n        \n        if (testarea) {\n            testarea.style.fontSize = `${itemFontSize}pt`;\n            testarea.style.lineHeight = itemLineHeight;\n        }\n        \n        const fontSizeSlider = item.querySelector(`#${itemID}-fontSize`);\n        const fontSizeVal = item.querySelector(`#${itemID}-fontSize-val`);\n        if (fontSizeSlider) {\n            fontSizeSlider.value = itemFontSize;\n            if (localStorage.getItem(`${itemID}-fontSize`)) {\n                fontSizeSlider.classList.add('modified');\n            }\n        }\n        if (fontSizeVal) {\n            fontSizeVal.textContent = `${itemFontSize}pt`;\n        }\n    });\n};\n\nconst updateAllTypeScales = () => {\n    const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n    const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n    \n    localStorage.setItem('preferred-scale', ratio);\n    \n    document.querySelectorAll('.item').forEach(item => {\n        const itemID = item.id;\n        const testarea = item.querySelector('.testarea');\n        const text = testarea?.textContent || '';\n        \n        const fontSize = getItemFontSize(itemID, text, baseSize, ratio);\n        const itemLineHeight = getItemLineHeight(itemID);\n        \n        if (testarea) {\n            testarea.style.fontSize = `${fontSize}pt`;\n            testarea.style.lineHeight = itemLineHeight;\n        }\n        \n        const fontSizeSlider = item.querySelector(`#${itemID}-fontSize`);\n        const fontSizeVal = item.querySelector(`#${itemID}-fontSize-val`);\n        if (fontSizeSlider) {\n            fontSizeSlider.value = fontSize;\n            if (localStorage.getItem(`${itemID}-fontSize`)) {\n                fontSizeSlider.classList.add('modified');\n            }\n        }\n        if (fontSizeVal) {\n            fontSizeVal.textContent = `${fontSize}pt`;\n        }\n\n        updateItemLineHeightDisplay(itemID, itemLineHeight);\n    });\n};\n\nconst updateAllLineHeights = () => {\n    const globalLineHeight = getGlobalLineHeight();\n    localStorage.setItem('line-height', globalLineHeight);\n    \n    document.querySelectorAll('.item').forEach(item => {\n        const itemID = item.id;\n        if (!localStorage.getItem(`${itemID}-lineHeight`)) {\n            updateItemLineHeightDisplay(itemID, globalLineHeight);\n        }\n    });\n};\n\nconst applyNameAndVersion = (isChecked) => {\n  const headerNames = document.getElementById('section__header-names');\n  const proofItems = document.querySelectorAll('.item__proof');\n\n  proofItems.forEach(item => {\n    const existingFooter = item.querySelector('.proof-footer');\n    if (existingFooter) {\n      existingFooter.remove();\n    }\n\n    if (isChecked) {\n      const footer = document.createElement('div');\n      footer.className = 'proof-footer';\n      footer.innerHTML = headerNames.innerHTML;\n      item.appendChild(footer);\n    }\n  });\n};\n\nconst toggleNameAndVersion = (event) => {\n  const isChecked = event.target.checked;\n  localStorage.setItem('showNameAndVersion', isChecked);\n  document.body.classList.toggle('show-font-details', isChecked);\n};\n\nconst applyLockProofDimensions = (isChecked) => {\n  document.querySelectorAll('.item__proof').forEach(proof => {\n    if (isChecked) {\n      proof.classList.add('locked-dimensions');\n    } else {\n      proof.classList.remove('locked-dimensions');\n    }\n  });\n};\nconst toggleLockProofDimensions = (event) => {\n  const isChecked = event.target.checked;\n  localStorage.setItem('lockProofDimensions', isChecked);\n  applyLockProofDimensions(isChecked);\n};\n\nconst getItemFontSize = (itemID, text, baseSize, ratio) => {\n    const storedSize = localStorage.getItem(`${itemID}-fontSize`);\n    if (storedSize !== null) {\n        return parseFloat(storedSize);\n    }\n    return whichFontSize(text, baseSize, ratio);\n};\n\nconst getItemLineHeight = (itemID) => {\n    return parseFloat(\n        localStorage.getItem(`${itemID}-lineHeight`) ||\n        getGlobalLineHeight()\n    );\n};\n\nconst getGlobalLineHeight = () => {\n    return parseFloat(\n        document.getElementById('input__line-height')?.value ||\n        localStorage.getItem('line-height') || 1.0\n    );\n};\n\nconst setItemLineHeight = (itemID, value) => {\n    localStorage.setItem(`${itemID}-lineHeight`, value);\n    updateItemLineHeightDisplay(itemID, value);\n};\n\nconst updateItemLineHeightDisplay = (itemID, value) => {\n    const item = document.getElementById(itemID);\n    if (!item) return;\n\n    const testarea = item.querySelector('.testarea');\n    const lineHeightSlider = item.querySelector(`#${itemID}-lineHeight`);\n    const lineHeightVal = item.querySelector(`#${itemID}-lineHeight-val`);\n    const valuesDisplay = item.querySelector('.testarea-values');\n    \n    if (testarea) testarea.style.lineHeight = value;\n    if (lineHeightSlider) lineHeightSlider.value = value;\n    if (lineHeightVal) lineHeightVal.textContent = value;\n    \n    if (valuesDisplay) {\n        const currentStyles = {\n            'font-size': testarea?.style.fontSize || '14pt',\n            'line-height': `${value}`,\n            'letter-spacing': testarea?.style.letterSpacing || '0em'\n        };\n        valuesDisplay.innerHTML = generateTestAreaValues(\n            Object.entries(currentStyles)\n                .map(([prop, val]) => `${prop}: ${val}`)\n                .join('; ')\n        );\n    }\n};\n\nexport const resetCustomValue = (itemID, property) => {\n    localStorage.removeItem(`${itemID}-${property}`);\n    \n    let globalValue;\n    if (property === 'lineHeight') {\n        globalValue = getGlobalLineHeight();\n    } else if (property === 'fontSize') {\n        const testarea = document.querySelector(`#${itemID} .testarea`);\n        const text = testarea?.textContent || '';\n        const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n        const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n        globalValue = whichFontSize(text, baseSize, ratio);\n    }\n        \n    updateItemDisplay(itemID, property, globalValue);\n    \n    const slider = document.querySelector(`#${itemID}-${property}`);\n    if (slider) {\n        slider.classList.remove('modified');\n    }\n};\n\nexport const applySecondaryFont = (fontPath, fontName) => {\n  console.log(`Applying secondary font: ${fontName} from ${fontPath}`);\n  \n  opentype.load(fontPath, (err, loadedFont) => {\n    if (err) {\n      console.error('Error loading secondary font:', err);\n      showErrorMessage(`Error loading secondary font: ${err}`);\n      return;\n    }\n    \n    window.secondaryFont = loadedFont;\n    \n    if ('FontFace' in window) {\n      const secondaryFontFamily = `${fontName}-secondary`;\n      const fontFace = new FontFace(\n        secondaryFontFamily,\n        `url('${fontPath}')`,\n        { format: loadedFont.outlinesFormat === 'truetype' ? 'truetype' : 'opentype' }\n      );\n      \n      fontFace.load().then(() => {\n        document.fonts.add(fontFace);\n        console.log(`Secondary font loaded successfully: ${secondaryFontFamily}`);\n        \n        const fontFaceRule = `\n          @font-face {\n            font-family: '${secondaryFontFamily}';\n            src: url('${fontPath}') format('${loadedFont.outlinesFormat === 'truetype' ? 'truetype' : 'opentype'}');\n          }\n        `;\n        \n        let secondaryStyleElement = document.getElementById('style__secondary-font');\n        if (!secondaryStyleElement) {\n          secondaryStyleElement = document.createElement('style');\n          secondaryStyleElement.id = 'style__secondary-font';\n          document.head.appendChild(secondaryStyleElement);\n        }\n        \n        secondaryStyleElement.textContent = fontFaceRule;\n        \n        secondaryStyleElement.textContent += `\n          .testarea em, \n          .testarea i, \n          .testarea [style*=\"italic\"],\n          .testarea .emphasis,\n          .font-italic {\n            font-family: '${secondaryFontFamily}', var(--font-secondary, sans-serif) !important;\n            font-style: normal !important;\n          }\n        `;\n        \n        const currentStage = localStorage.getItem('proofingPhase') || 'Hamburgers';\n        setStage(currentStage);\n      });\n    }\n  });\n};\n\nexport const clearSecondaryFont = () => {\n  // Remove secondary font styling\n  const secondaryStyleElement = document.getElementById('style__secondary-font');\n  if (secondaryStyleElement) {\n    secondaryStyleElement.remove();\n  }\n  \n  // Clear localStorage\n  localStorage.removeItem('secondaryFontPath');\n  localStorage.removeItem('secondaryFontName');\n  \n  // Remove secondary class from all buttons\n  document.querySelectorAll('.btn__setfont.secondary').forEach(btn => {\n    btn.classList.remove('secondary');\n  });\n  \n  // Clear global reference\n  window.secondaryFont = null;\n  \n  console.log('Secondary font cleared');\n};\n\nlet fontAnimationInterval = null;\n\nconst toggleFontAnimation = (event) => {\n  const playButton = event.currentTarget;\n  const isPlaying = playButton.getAttribute('data-playing') === 'true';\n  \n  if (isPlaying) {\n    stopFontAnimation();\n    playButton.innerHTML = '<span class=\"material-symbols-outlined\">play_arrow</span>';\n    playButton.setAttribute('data-playing', 'false');\n  } else {\n    startFontAnimation();\n    playButton.innerHTML = '<span class=\"material-symbols-outlined\">pause</span>';\n    playButton.setAttribute('data-playing', 'true');\n  }\n};\n\nconst startFontAnimation = () => {\n  stopFontAnimation();\n  \n  const speedInput = document.getElementById('input__cycle-speed');\n  const speed = speedInput ? parseInt(speedInput.value, 10) : 300;\n  \n  const safeSpeed = Math.max(100, speed);\n  \n  fontAnimationInterval = setInterval(() => {\n    navigateFonts('next');\n  }, safeSpeed);\n};\n\nconst stopFontAnimation = () => {\n  if (fontAnimationInterval) {\n    clearInterval(fontAnimationInterval);\n    fontAnimationInterval = null;\n  }\n};\n\nconst setupCycleSpeedListener = () => {\n  const speedInput = document.getElementById('input__cycle-speed');\n  if (!speedInput) return;\n  \n  const savedSpeed = localStorage.getItem('font-cycle-speed');\n  if (savedSpeed) {\n    speedInput.value = savedSpeed;\n  }\n  \n  speedInput.addEventListener('change', () => {\n    localStorage.setItem('font-cycle-speed', speedInput.value);\n    \n    const playButton = document.querySelector('.font-play-btn');\n    if (playButton && playButton.getAttribute('data-playing') === 'true') {\n      startFontAnimation();\n    }\n  });\n};\n\nexport const removeCustomProofWindow = (itemId) => {\n  const customWindows = JSON.parse(localStorage.getItem('customProofWindows') || '{}');\n  const currentStage = getCurrentStage();\n  \n  if (customWindows[currentStage]) {\n    const index = customWindows[currentStage].indexOf(itemId);\n    if (index !== -1) {\n      customWindows[currentStage].splice(index, 1);\n      localStorage.setItem('customProofWindows', JSON.stringify(customWindows));\n    }\n  }\n  \n  const element = document.getElementById(itemId);\n  if (element) {\n    element.remove();\n  }\n};\n\nwindow.removeCustomProofWindow = removeCustomProofWindow;\n\n","import { CONFIG } from './config.js';\nimport * as AppCore from './app-core.js';\nimport { localStorageClear, saveEditableContent, saveInputValue } from './utils.js';\n\n// Global error handlers\nwindow.addEventListener('unhandledrejection', function(event) {\n  console.error('Unhandled promise rejection:', event.reason);\n});\n\nwindow.addEventListener('error', function(event) {\n  console.error('Uncaught error:', event.error);\n});\n\n// Make functions globally available\nwindow.setFont = AppCore.setFont;\nwindow.onReadFile = AppCore.onReadFile;\nwindow.setStage = AppCore.setStage;\nwindow.passStyleValue = AppCore.passStyleValue;\nwindow.passfvarValue = AppCore.passfvarValue;\nwindow.passfeatValue = AppCore.passfeatValue;\nwindow.insertField = AppCore.insertField;\nwindow.clearSecondaryFont = AppCore.clearSecondaryFont;\nwindow.localStorageClear = localStorageClear;\nwindow.saveEditableContent = saveEditableContent;\nwindow.saveInputValue = saveInputValue;\n\nconst init = (forceServerLoad = false) => {\n\ttry {\n\t  if (forceServerLoad || !['localhost', '127.0.0.1', ''].includes(location.hostname)) {\n\t\tAppCore.serverLoad();\n\t  } else {\n\t\tAppCore.localLoad();\n\t  }\n  \n\t  AppCore.setupEventListeners();\n\t  document.body.classList.add('loaded');\n  \n\t} catch (error) {\n\t  console.error('Error during initialization:', error);\n\t}\n  };\n\ndocument.addEventListener('DOMContentLoaded', () => init(false));"],"names":["CONFIG","showErrorMessage","message","el","document","getElementById","style","display","trim","length","textContent","console","error","localStorageClear","localStorage","clear","setItem","location","reload","toggleMode","body","newMode","getItem","removeAttribute","querySelector","setAttribute","toggleSettingsVisibility","settingsToggle","classList","toggle","whichFontSize","text","baseSize","arguments","undefined","ratio","toString","sizes","Math","round","pow","calculateTypeScale","charCount","saveData","id","value","Storage","content","saveEditableContent","elementId","element","innerText","warn","concat","getStoredContent","defaultContent","_regeneratorRuntime","e","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","asyncGeneratorStep","_asyncToGenerator","apply","_next","_throw","font","onFontLoaded","loadedFont","fontFamilySource","fontFamily","_ref","_callee","reject","_document$querySelect","fontFace","fontFaceRule","currentStage","_context","log","window","FontFace","format","outlinesFormat","load","fonts","add","createElement","head","appendChild","ready","displayFontData","includes","hostname","dataset","stage","proofingPhase","setStage","t0","_x","_x2","onReadFile","event","files","target","fileButtonParent","innerHTML","navGroup","generateFontNavigation","generateFontButtons","Array","from","container","firstButton","click","setFont","_ref3","_callee3","fontPath","fontName","_context3","opentype","err","_x4","_x5","_ref4","_callee4","_document$querySelect2","tablename","styles","nameHtml","postScriptName","version","formattedVersion","modifiedDate","formattedDate","_context4","tables","t1","names","en","fontRevision","modified","Date","toLocaleDateString","_x6","article","stageButtons","pendingStage","fetch","response","json","proof","html","generateStageHtml","buttonHtml","generateStageButtons","initTypeScale","lockDimensions","applyLockProofDimensions","_font$tables$gsub","gsubFeatures","gsub","features","taglist","filter","feature","tag","map","startsWith","title","textClass","testAreaID","itemID","sliderID","_getStoredStyles","getStoredStyles","fontSize","lineHeight","letterSpacing","fvarStyle","inlineStyle","generateFvarStyle","generateSliders","generateVariableSliders","generateStyleButtons","generateFeatureCheckboxes","generateProofContent","customWindows","JSON","parse","_step","_iterator","_createForOfIteratorHelper","customItemId","_getStoredStyles2","savedTitle","savedContent","_document$getElementB","_document$getElementB2","_document$querySelect3","typeScale","parseFloat","getItemFontSize","getItemLineHeight","columnCount","columnGap","fvar","axes","axis","storedValue","defaultValue","join","hasCustomLineHeight","hasCustomFontSize","hasCustomLetterSpacing","minValue","maxValue","generateFontButton","_ref5","_callee5","mode","fontType","isVariable","button","_args5","_context5","replace","split","toUpperCase","isVariableFont","URL","createObjectURL","className","onclick","shiftKey","contains","clearSecondaryFont","querySelectorAll","btn","remove","applySecondaryFont","_x7","_ref6","_callee6","arrayBuffer","parsedFont","_context6","_x8","updateColumns","passStyleValue","uniqueTags","Set","_proof$Features2","featureDescription","_proof$Features","ssNum","parseInt","_font$names","nameID","getFeatureDescription","definition","sample","updateInlineText","property","fontSizeSlider","lineHeightSlider","letterSpacingSlider","currentStyles","entries","_ref7","_ref8","_slicedToArray","prop","val","generateTestAreaValues","getCurrentStage","elementIdSuffix","displayValue","slider","testarea","styleValue","removeStyleValue","removeItem","_document$getElementB4","_document$getElementB5","getGlobalLineHeight","valueDisplay","hiddenTabs","visibleStages","defaultTab","updatedHiddenTabs","tab","stringify","removeTab","stageName","allTabs","visibleTabs","splice","indexOf","originalLocalStorageClear","localLoad","data","arr","uniqueFonts","sort","preventDefaults","preventDefault","stopPropagation","highlight","unhighlight","handleDrop","handleFiles","dataTransfer","filesOrEvent","Event","uploadPromises","file","setTimeout","uploadFile","all","handleFileButtonClick","parentNode","children","child","sibling","handleStageButtonClick","toggleToolsVisibility","setupPasteHandling","addEventListener","clipboardData","getData","selection","getSelection","rangeCount","range","getRangeAt","deleteContents","insertNode","createTextNode","dispatchEvent","metaKey","ctrlKey","key","activeElement","execCommand","_ref9","_callee7","chipsContainer","_iterator2","_step2","_font2","_args7","_context7","_x9","prevButton","navigateFonts","playButton","toggleFontAnimation","nextButton","direction","buttons","activeButton","nextIndex","currentIndex","_document$getElementB6","_document$getElementB7","item","itemLineHeight","itemFontSize","fontSizeVal","updateAllTypeScales","_document$getElementB8","_document$getElementB9","updateItemLineHeightDisplay","updateAllLineHeights","globalLineHeight","toggleNameAndVersion","isChecked","checked","toggleLockProofDimensions","storedSize","_document$getElementB10","lineHeightVal","valuesDisplay","_ref10","_ref11","secondaryFont","secondaryFontFamily","secondaryStyleElement","fontAnimationInterval","currentTarget","getAttribute","stopFontAnimation","startFontAnimation","speedInput","speed","safeSpeed","max","setInterval","clearInterval","setupCycleSpeedListener","savedSpeed","removeCustomProofWindow","itemId","index","reason","AppCore","passfvarValue","fvarSupport","fvarcss","_document$getElementB3","tagValue","fontVariationSettings","passfeatValue","featureSupport","featSupport","featcss","fontFeatureSettings","insertField","aboveHere","original","clone","cloneNode","timestamp","now","newId","originalId","updatedHandler","RegExp","input","insertBefore","height","overflow","transition","scrollHeight","saveInputValue","init","forceServerLoad","dragDropArea","fileInput","eventName","fileButtons","toolsToggle","modeToggle","localStorageClearButton","addNameAndVersionCheckbox","lockProofDimensionsCheckbox","savedState","aspectRatioSelect","savedRatio","baseFontInput","savedBaseSize","lineHeightInput","savedLineHeight","savedMode","typeScaleSelect"],"sourceRoot":""}