{"version":3,"file":"application.js","mappings":"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","sources":["webpack://idiotproof/./src/js/utils.js","webpack://idiotproof/./src/js/config.js","webpack://idiotproof/./src/js/app-core.js","webpack://idiotproof/./src/js/index.js"],"sourcesContent":["import { CONFIG } from './config.js';\n  \n  // utils.js\n  export const getFormattedDate = () => {\n    const now = new Date();\n    return now.toJSON().slice(0, 10).replace(/-/g, '/');\n  };\n  \n  export const preserveUnique = (arr) => {\n    return [...new Set(arr)];\n  };\n  \n  export const showErrorMessage = (message) => {\n    const el = document.getElementById('message');\n    if (el) {\n      el.style.display = message && message.trim().length > 0 ? 'block' : 'none';\n      el.textContent = message;\n    } else {\n      console.error('Message element not found. Error message:', message);\n    }\n  };\n  \n  export const uint8ToBase64 = (buffer) => {\n    const chunk = 8192;\n    let result = '';\n    for (let i = 0; i < buffer.length; i += chunk) {\n      const slice = buffer.subarray(i, i + chunk);\n      result += String.fromCharCode.apply(null, slice);\n    }\n    return btoa(result);\n  };\n  \n  export const sanitizeId = (id) => {\n    return id.replace(/[^a-z0-9]/gi, '_').toLowerCase();\n  };\n\n  export const localStorageClear = () => {\n    localStorage.clear();\n    localStorage.setItem('proofingPhase', CONFIG.defaultProofingPhase);\n    location.reload();\n  };\n\n  export function toggleMode() {\n    const body = document.body;\n    const currentMode = localStorage.getItem('colorMode') || 'light';\n    const newMode = currentMode === 'light' ? 'dark' : 'light';\n    \n    // Save the new mode\n    localStorage.setItem('colorMode', newMode);\n    \n    // Update UI\n    if (newMode === 'light') {\n      body.removeAttribute('data-theme');\n      document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'light_mode';\n    } else {\n      body.setAttribute('data-theme', 'dark');\n      document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'dark_mode';\n    }\n  }\n  export function toggleSettingsVisibility() {\n    const settingsToggle = document.getElementById('btn__settings-toggle');\n    const body = document.body;\n    body.classList.toggle('settings-visible');\n    settingsToggle.classList.toggle('settings-visible');\n  }\n\n  export function toggleUi() {\n\tconst toggleUIButton = document.getElementById('btn__ui-toggle');\n\tconst body = document.body;\n  \n\tbody.classList.toggle('ui-hidden');\n\tthis.classList.toggle('ui-hidden');\n\t\n\t// Optionally, you can save the state to localStorage\n\tlocalStorage.setItem('uiHidden', body.classList.contains('ui-hidden'));\n  \n\t// Check if the UI was hidden in a previous session\n\tif (localStorage.getItem('uiHidden') === 'true') {\n\t  body.classList.add('ui-hidden');\n\t  toggleUIButton.classList.add('ui-hidden');\n\t}\n  }\n  \n  export const calculateTypeScale = (baseSize = 14, ratio = 1.618, steps = 6) => {\n    const sizes = {\n      't__size-xxl': Math.round(baseSize * Math.pow(ratio, 5)),\n      't__size-xl':  Math.round(baseSize * Math.pow(ratio, 4)),\n      't__size-l':   Math.round(baseSize * Math.pow(ratio, 3)),\n      't__size-m':   Math.round(baseSize * Math.pow(ratio, 2)),\n      't__size-s':   Math.round(baseSize * Math.pow(ratio, 1)),\n      't__size-xs':  baseSize\n    };\n    return sizes;\n  };\n  \n  export const whichFontSize = (text, baseSize = 14, ratio = 1.618) => {\n    if (!text) return baseSize.toString();\n  \n    const sizes = calculateTypeScale(baseSize, ratio);\n    \n    const charCount = text.length;\n    if (charCount < 25) return sizes['t__size-xxl'];\n    if (charCount < 50) return sizes['t__size-xl'];\n    if (charCount < 95) return sizes['t__size-l'];\n    if (charCount < 200) return sizes['t__size-m'];\n    if (charCount < 1000) return sizes['t__size-s'];\n    return sizes['t__size-xs'];\n  };\n  \n  export const removeElementsByClass = (className) => {\n    document.querySelectorAll(`.${className}`).forEach(el => el.remove());\n  };\n  \n  export const removeElementById = (id) => {\n    const element = document.getElementById(id);\n    if (element) {\n      element.style.transition = 'opacity 0.5s ease';\n      element.style.opacity = '0';\n      setTimeout(() => element.remove(), 500);\n    }\n  };\n  \n  export const saveData = (id, value) => {\n    if (typeof Storage !== 'undefined') {\n      if (value !== 'thisContent') {\n        localStorage.setItem(id, value);\n      } else {\n        const content = document.getElementById(id).textContent;\n        localStorage.setItem(id, content);\n      }\n    }\n  };\n  \n  // Save content of a contenteditable element to localStorage\n  export const saveEditableContent = (elementId) => {\n    const element = document.getElementById(elementId);\n    if (!element) {\n      console.warn(`Element with ID ${elementId} not found`);\n      return;\n    }\n    \n    const content = element.innerText;\n    localStorage.setItem(elementId, content);\n  };\n\n  // Save value of an input element to localStorage\n  export const saveInputValue = (elementId) => {\n    const element = document.getElementById(elementId);\n    if (!element) {\n      console.warn(`Element with ID ${elementId} not found`);\n      return;\n    }\n    \n    localStorage.setItem(elementId, element.value);\n  };\n\n  // Get content from localStorage or return default\n  export const getStoredContent = (elementId, defaultContent = '') => {\n    return localStorage.getItem(elementId) || defaultContent;\n  };\n  \n  export function initColorMode() {\n\tconst savedMode = localStorage.getItem('colorMode') || 'light';\n\tconst body = document.body;\n  \n\tif (savedMode === 'dark') {\n\t  body.setAttribute('data-theme', 'dark');\n\t  document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'dark_mode';\n\t} else {\n\t  body.removeAttribute('data-theme');\n\t  document.querySelector('#btn__mode-toggle .material-symbols-outlined').textContent = 'light_mode';\n\t}\n  }\n  ","// config.js\nexport const CONFIG = {\n    defaultProofingPhase: 'Hamburgers',\n    fontFormats: {\n      truetype: 'ttf',\n      opentype: 'otf',\n    },\n    jsonPath: 'src/js/proof.json',\n  };","import { CONFIG } from './config.js';\nimport { getFormattedDate,\n\tpreserveUnique,\n\tshowErrorMessage,\n\tuint8ToBase64,\n\tlocalStorageClear,\n\twhichFontSize,\n\tremoveElementsByClass,\n\tsaveData,\n\ttoggleMode,\n\ttoggleSettingsVisibility,\n\ttoggleUi,\n\tsaveEditableContent,\n\tsaveInputValue,\n\tgetStoredContent,\n\tcalculateTypeScale,\n\tinitColorMode  } from './utils.js';\n\n// Re-export localStorageClear\nexport { localStorageClear };\n\nlet font = null;\nconst fontFormats = {\n    truetype: 'ttf',\n    opentype: 'otf',\n};\n\nexport const onFontLoaded = (loadedFont, fontFamilySource, fontFamily) => {\n\treturn new Promise(async (resolve, reject) => {\n\t  try {\n\t\tfont = loadedFont;\n\t\tconsole.log(`Font assigned globally: ${fontFamily}`);\n\t\t\n\t\t// Create and load the font face first\n\t\tif ('FontFace' in window) {\n\t\t  const fontFace = new FontFace(\n\t\t\tfontFamily,\n\t\t\t`url('${fontFamilySource}')`,\n\t\t\t{ format: loadedFont.outlinesFormat === 'truetype' ? 'truetype' : 'opentype' }\n\t\t  );\n\n\t\t  // Wait for the font to load\n\t\t  await fontFace.load();\n\t\t  document.fonts.add(fontFace);\n\t\t  console.log(`Font loaded successfully: ${fontFamily}`);\n\t\t}\n\n\t\t// Create and apply the font-face rule for browsers without FontFace API\n\t\tconst fontFaceRule = `\n\t\t  @font-face {\n\t\t\tfont-family: '${fontFamily}';\n\t\t\tsrc: url('${fontFamilySource}') format('${loadedFont.outlinesFormat === 'truetype' ? 'truetype' : 'opentype'}');\n\t\t  }\n\t\t`;\n\t\tconst style = document.createElement('style');\n\t\tstyle.textContent = fontFaceRule;\n\t\tdocument.head.appendChild(style);\n\t\tconsole.log(`Font-face rule applied: ${fontFaceRule}`);\n  \n\t\twindow.fontFamily = fontFamily;\n\t\tconsole.log(`Window.fontFamily set to: ${fontFamily}`);\n  \n\t\t// Wait for font to be ready before displaying data\n\t\tawait document.fonts.ready;\n\t\tawait displayFontData(fontFamily);\n  \n\t\tif (['localhost', '127.0.0.1', ''].includes(location.hostname)) {\n\t\t  localStorage.setItem('fontFamily', fontFamily);\n\t\t  localStorage.setItem('fontFamilySource', fontFamilySource);\n\t\t  console.log(`Font information saved to localStorage`);\n\t\t}\n  \n\t\t// Get current stage before setting new one\n\t\tconst currentStage = document.querySelector('.btn__stage.active')?.dataset?.stage \n\t\t\t|| localStorage.getItem('proofingPhase') \n\t\t\t|| window.proofingPhase \n\t\t\t|| 'Hamburgers';\n  \n\t\tawait setStage(currentStage);\n\t\t\n\t\tconsole.log(`Stage set successfully`);\n\t\tresolve();\n\t  } catch (error) {\n\t\tconsole.error('Error in onFontLoaded:', error);\n\t\treject(error);\n\t  }\n\t});\n  };\n\nexport const onReadFile = (event) => {\n\tconst files = event.target.files;\n\tconst fileButtonParent = document.getElementById('section__header-file-buttons');\n\tfileButtonParent.innerHTML = '';\n\n\t// First add navigation\n\tconst navGroup = generateFontNavigation();\n\tfileButtonParent.appendChild(navGroup);\n\n\t// Then add font buttons\n\tgenerateFontButtons(Array.from(files), 'server')\n\t  .then(container => {\n\t\tfileButtonParent.appendChild(container);\n\t\t// Activate the first button automatically\n\t\tconst firstButton = container.querySelector('.btn__setfont');\n\t\tif (firstButton) {\n\t\t  firstButton.click();\n\t\t}\n\t  });\n};\n\n  const readSingleFile = (file) => {\n\treturn new Promise((resolve, reject) => {\n\t  const reader = new FileReader();\n\t  \n\t  reader.onload = async (e) => {\n\t\ttry {\n\t\t  console.log(`File read successfully: ${file.name}`);\n\t\t  const font = opentype.parse(e.target.result);\n\t\t  console.log(`Font parsed successfully: ${font.names.postScriptName.en}`);\n\t\t  const fontFamily = font.names.postScriptName.en;\n\t\t  const fontFamilySource = `fonts/${fontFamily}`;\n\t\t  \n\t\t  await onFontLoaded(font, fontFamilySource, fontFamily);\n  \n\t\t  font.file = {\n\t\t\tname: file.name,\n\t\t\tlastModified: file.lastModified,\n\t\t\tsize: file.size,\n\t\t\ttype: file.type,\n\t\t  };\n\t\t  font.type = 'user:local';\n  \n\t\t  const tempUint8array = new Uint8Array(e.target.result);\n\t\t  const isVariableFont = font.tables.fvar !== undefined;\n  \n\t\t  // Set the @font-face rule\n\t\t  const fontFaceRule = `@font-face {font-family:'${fontFamily}'; src: url('data:font/ttf;base64,${uint8ToBase64(tempUint8array)}') format('truetype');}`;\n\t\t  document.getElementById('style__fontface').innerHTML += fontFaceRule;\n\t\t  console.log(`Font-face rule added: ${fontFaceRule}`);\n  \n\t\t  console.log(`Loaded font: ${fontFamily}, Variable: ${isVariableFont}`);\n  \n\t\t  showErrorMessage('');\n\t\t  resolve();\n\t\t} catch (err) {\n\t\t  console.error('Error parsing font:', err);\n\t\t  showErrorMessage(`Error loading font: ${err.message}`);\n\t\t  reject(err);\n\t\t}\n\t  };\n  \n\t  reader.onerror = (err) => {\n\t\tconsole.error('Error reading file:', err);\n\t\tshowErrorMessage(err.toString());\n\t\treject(err);\n\t  };\n  \n\t  reader.readAsArrayBuffer(file);\n\t});\n  };\n\nexport const setFont = async (fontPath, fontName) => {\n\tconsole.log(`Attempting to load font: ${fontName} from ${fontPath}`);\n\topentype.load(fontPath, (err, loadedFont) => {\n\t  if (err) {\n\t\tconsole.error('Error loading font:', err);\n\t\tshowErrorMessage(`Error loading font: ${err}`);\n\t  } else {\n\t\tconsole.log(`Font loaded successfully: ${fontName}`);\n\t\tfont = loadedFont; // Ensure this is set globally\n\t\ttry {\n\t\t  onFontLoaded(loadedFont, fontPath, fontName);\n\t\t  // After the font is loaded and processed, set the stage\n\t\t  setStage(localStorage.getItem('proofingPhase') || 'Hamburgers');\n\t\t} catch (error) {\n\t\t  console.error('Error in onFontLoaded:', error);\n\t\t  showErrorMessage(`Error processing font: ${error}`);\n\t\t}\n\t  }\n\t});\n};\n\nexport const displayFontData = async (fontFamily) => {\n    var tablename, table, property, value, tag;\n    var styles = '';\n\n    for (tablename in font.tables) {\n        table = font.tables[tablename];\n        \n        if (tablename === 'name') {\n            let nameHtml = '';\n            if (font.names.postScriptName) {\n                var postScriptName = font.names.postScriptName.en;\n            } else {\n                var postScriptName = \"Untitled Font\";\n            }\n\n            // Get version from head table\n            const version = font.tables.head.fontRevision;\n            // Format version to 2 decimal places\n            const formattedVersion = `Ver ${version}`;\n            \n\t\t\tnameHtml += `<div class=\"section__header-name-font\" spellcheck=\"false\">${postScriptName}</div>`;\n            nameHtml += `<div class=\"section__header-name-version\" spellcheck=\"false\">${formattedVersion}</div>`;\n            styles += `.t__importedfontfamily { font-family: \"${fontFamily}\" }`;\n\n            // Get and format the font's modification date\n            const modifiedDate = font.tables.head.modified;\n            const formattedDate = `Last edited ${new Date(modifiedDate * 1000).toLocaleDateString()}`;\n            nameHtml += `<div class=\"section__header-name-date\">${formattedDate}</div>`;\n            \n            document.getElementById('section__header-names').innerHTML = nameHtml;\n            continue;\n        }\n    }\n\n    // Apply styles only after font is loaded\n    document.getElementById('style__fontfamily').innerHTML = styles;\n    \n    // Set stage after font is ready\n    const currentStage = document.querySelector('.btn__stage.active')?.dataset?.stage \n        || localStorage.getItem('proofingPhase') \n        || window.proofingPhase \n        || 'Hamburgers';\n    \n    setStage(currentStage);\n};\n\nexport const setStage = (stage) => {\n\tconst article = document.getElementById('section__article-app');\n\tconst stageButtons = document.getElementById('section__header-stage-buttons');\n\t\n\tif (!font) {\n\t  console.warn('Font not loaded yet. Deferring stage setting.');\n\t  window.pendingStage = stage;\n\t  return;\n\t}\n  \n\tfetch(CONFIG.jsonPath)\n\t  .then(response => response.json())\n\t  .then(proof => {\n\t\tconst html = generateStageHtml(proof, stage);\n\t\tconst buttonHtml = generateStageButtons(proof, stage);\n  \n\t\tarticle.innerHTML = html;\n\t\tstageButtons.innerHTML = buttonHtml;\n\t\tdocument.getElementById('style__opentype-features').innerHTML = '';\n\t\t\n\t\tsaveData('proofingPhase', stage);\n  \n\t\t// Initialize type scale after rendering\n\t\tinitTypeScale();\n  \n\t\tconst lockDimensions = localStorage.getItem('lockProofDimensions') === 'true';\n\t\tapplyLockProofDimensions(lockDimensions);\n\t  })\n\t  .catch(error => console.error('Error loading JSON:', error));\n  };\n  \n  const generateStageHtml = (proof, stage) => {\n    if (!proof[stage]) {\n      return '<div class=\"item d-flex t__center\"><div class=\"item__proof\">No features found! :...(</div></div>';\n    }\n\tconst fontName = font.names.postScriptName.en;\n\t// Get version from head table\n\tconst version = font.tables.head.fontRevision;\n\tconst formattedVersion = `Ver ${version}`;\n\n    const gsubFeatures = font.tables.gsub.features;\n    const taglist = Object.values(gsubFeatures)\n\t\t.filter(feature => typeof feature === 'object' && feature.tag)\n\t\t.map(feature => feature.tag)\n\t\t.filter(tag => {\n\t\t\t// Include the tag if it's either in proof.json OR if it's a stylistic set\n\t\t\treturn proof[\"Features\"][tag] !== undefined || tag.startsWith('ss');\n\t\t});\n  \n    let html = '';\n  \n    for (const title in proof[stage]) {\n      if (stage === \"Features\" && !taglist.includes(title)) {\n        continue;\n      }\n  \n      const textClass = whichFontSize(proof[stage][title]);\n      const testAreaID = `section__proofing-${title}`;\n      const itemID = `item--${title}`;\n      const sliderID = `${itemID}`;\n      \n      const { fontSize, lineHeight, letterSpacing, inlineStyle } = getStoredStyles(sliderID, textClass);\n      const fvarStyle = generateFvarStyle(itemID);\n  \n      html += `\n        <div id=\"${itemID}\" class=\"item\">\n          <button class=\"btn btn-link add-item-above chip\" onclick=\"insertField('${itemID}')\">+ Add Proof Window</button>\n          <div class=\"item__container d-flex\">\n            <div class=\"item__sliders pt-2\">\n              <div class=\"item__sliders-wrapper\">\n                ${generateSliders(itemID, sliderID, fontSize, lineHeight, letterSpacing)}\n                ${generateVariableSliders(itemID, sliderID)}\n                ${generateStyleButtons(itemID)}\n                ${generateFeatureCheckboxes(itemID, proof, taglist)}\n              </div>\n            </div>\n            <div class=\"item__proof ratio-letter\">\n              <button class=\"btn btn-link remove-item-this invisible\" onclick=\"removeElementsByID('${itemID}')\"></button>\n              ${generateProofContent(stage, title, proof, testAreaID, fvarStyle, textClass)}\n\t\t\t\t<div class=\"item__footer d-flex justify-content-between\">\n\t\t\t\t\t<span class=\"item__footer-name-font\">${fontName}</span>\n\t\t\t\t<span class=\"item__footer-name-version\">${formattedVersion}</span>\n\t\t\t\t</div>\n            </div>\n          </div>\n        </div>\n      `;\n    }\n\treturn html;\n  };\n  \n// Modify the getStoredStyles function to include column properties\nconst getStoredStyles = (itemID, textClass) => {\n  // Get the current type scale ratio and base size\n  const typeScale = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n  const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n  \n  // Use whichFontSize to calculate the font size based on the text\n  const content = document.querySelector(`#${itemID} .testarea`)?.textContent || textClass;\n  \n  // Check if there's a stored fontSize, otherwise calculate it\n  const fontSize = getItemFontSize(itemID, content, baseSize, typeScale);\n  \n  const lineHeight = getItemLineHeight(itemID);\n  const letterSpacing = localStorage.getItem(`${itemID}-letterSpacing`) || '0';\n  const columnCount = localStorage.getItem(`${itemID}-column-count`) || '1';\n  const columnGap = localStorage.getItem(`${itemID}-column-gap`) || '1em';\n\n  const inlineStyle = `\n    font-size: ${fontSize}pt;\n    line-height: ${lineHeight};\n    letter-spacing: ${letterSpacing}em;\n    column-count: ${columnCount};\n    column-gap: ${columnGap};\n  `;\n\n  return { fontSize, lineHeight, letterSpacing, columnCount, columnGap, inlineStyle };\n};\n  \n  const generateFvarStyle = (itemID) => {\n    let fvarStyle = '';\n    if (font.tables.fvar) {\n      const fvarSupport = font.tables.fvar.axes.map(axis => axis.tag);\n      fvarStyle = 'font-variation-settings: ' + \n        font.tables.fvar.axes.map(axis => {\n          const storedValue = localStorage.getItem(`${itemID}-${axis.tag}-val`);\n          const value = storedValue !== null ? storedValue : axis.defaultValue;\n          return `'${axis.tag}' ${value}`;\n        }).join(', ') + ';';\n    }\n    return fvarStyle;\n  };\n  \n  const generateSliders = (itemID, sliderID, fontSize, lineHeight, letterSpacing) => {\n    const hasCustomLineHeight = localStorage.getItem(`${itemID}-lineHeight`) !== null;\n    const hasCustomFontSize = localStorage.getItem(`${itemID}-fontSize`) !== null;\n    \n    return `\n\t\t<div>\n\t\t\t<label for=\"${sliderID}-fontSize\">Font Size</label>\n\t\t\t<span class=\"t__right text-small\" id=\"${sliderID}-fontSize-val\">${fontSize}pt</span>\n\t\t\t<span class=\"t__right material-symbols-outlined remove\" onclick=\"removeStyleValue('${itemID}', 'fontSize')\">clear</span>\n\t\t\t<input id=\"${sliderID}-fontSize\" type=\"range\" class=\"slider ${hasCustomFontSize ? 'modified' : ''}\" \n\t\t\t\tmin=\"4\" max=\"160\" step=\"2\" value=\"${fontSize}\" \n\t\t\t\toninput=\"passStyleValue('${itemID}', 'fontSize', this.value)\">\n\t\t</div>\n        <div>\n\t\t\t<label for=\"${sliderID}-lineHeight\">Line Height</label>\n\t\t\t<span class=\"t__right text-small\" id=\"${sliderID}-lineHeight-val\">${lineHeight}</span>\n\t\t\t<span class=\"t__right material-symbols-outlined remove\" onclick=\"removeStyleValue('${itemID}', 'lineHeight')\">clear</span>\n\t\t\t<input id=\"${sliderID}-lineHeight\" type=\"range\" class=\"slider ${hasCustomLineHeight ? 'modified' : ''}\" \n\t\t\t\tmin=\"0.6\" max=\"3.0\" step=\"0.01\" value=\"${lineHeight}\" \n\t\t\t\toninput=\"passStyleValue('${itemID}', 'lineHeight', this.value)\">\n\t\t</div>\n        <div>\n\t\t\t<label for=\"${sliderID}-letterSpacing\">Letter Spacing </label>\n\t\t\t<span class=\"t__right text-small\" id=\"${sliderID}-letterSpacing-val\">${letterSpacing}</span>\n\t\t\t<span class=\"t__right material-symbols-outlined remove\" onclick=\"removeStyleValue('${itemID}', 'letterSpacing')\">clear</span>\n\t\t\t<input id=\"${sliderID}-letterSpacing\" type=\"range\" class=\"slider\" min=\"-0.4\" max=\"0.4\" step=\"0.01\" value=\"${letterSpacing}\" oninput=\"passStyleValue('${itemID}', 'letterSpacing', this.value)\">\n\t\t</div>\n    `;\n  };\n  \n  const generateVariableSliders = (itemID, sliderID) => {\n    if (!font.tables.fvar) return '';\n  \n    return font.tables.fvar.axes.map(axis => {\n      const storedValue = localStorage.getItem(`${itemID}-${axis.tag}-val`);\n      const value = storedValue !== null ? storedValue : axis.defaultValue;\n      return `\n        <label for=\"${sliderID}-${axis.tag}\">${axis.name.en} </label>\n        <span class=\"t__right text-small\" id=\"${sliderID}-${axis.tag}-val\">${value}</span>\n        <input id=\"${sliderID}-${axis.tag}\" type=\"range\" class=\"slider\" min=\"${axis.minValue}\" max=\"${axis.maxValue}\" value=\"${value}\" oninput=\"passfvarValue('${itemID}', '${axis.tag}', this.value, '${font.tables.fvar.axes.map(a => a.tag).join(',')}')\">\n      `;\n    }).join('');\n  };\n  \n  export const generateFontButton = async (font, mode = 'local') => {\n\tlet fontName, fontPath, fontType, displayName, isVariable;\n  \n\tif (mode === 'local') {\n\t  fontName = font.replace('.', '-');\n\t  fontPath = `fonts/${font}`;\n\t  displayName = font.replace('-', ' ').replace(/\\.[^/.]+$/, \"\");\n\t  fontType = font.split('.').pop().toUpperCase();\n\t  isVariable = await isVariableFont(fontPath);\n\t} else { // server mode\n\t  fontName = font.name.replace('.', '-');\n\t  fontPath = URL.createObjectURL(font);\n\t  displayName = font.name.replace('-', ' ').replace(/\\.[^/.]+$/, \"\");\n\t  fontType = font.name.split('.').pop().toUpperCase();\n\t  isVariable = await isVariableFont(font);\n\t}\n  \n\tif (isVariable) {\n\t  fontType = 'VF';\n\t}\n  \n\tconst button = document.createElement('div');\n\tbutton.className = 'btn__setfont chip btn d-flex justify-content-between';\n\tbutton.title = mode === 'local' ? font : font.name;\n\tbutton.id = `btn__setfont-${fontName}`;\n\tbutton.innerHTML = `${displayName}<span class=\"d-flex-grow text-small text-right\">${fontType}</span>`;\n\tbutton.onclick = () => {\n\t  // Remove active class from all buttons\n\t  document.querySelectorAll('.btn__setfont').forEach(btn => {\n\t    btn.classList.remove('active');\n\t    btn.classList.remove('visited'); // Remove visited from all buttons\n\t  });\n\t  // Add active class to clicked button\n\t  button.classList.add('active');\n\t  button.classList.add('visited'); // Add visited only when clicked\n\t  setFont(fontPath, fontName);\n\t};\n  \n\treturn button;\n  };\n  \n  const isVariableFont = async (font) => {\n\ttry {\n\t  let arrayBuffer;\n\t  if (typeof font === 'string') {\n\t\t// Local mode: font is a path\n\t\tconst response = await fetch(font);\n\t\tarrayBuffer = await response.arrayBuffer();\n\t  } else {\n\t\t// Server mode: font is a File object\n\t\tarrayBuffer = await font.arrayBuffer();\n\t  }\n\t  const parsedFont = opentype.parse(arrayBuffer);\n\t  return parsedFont.tables.fvar !== undefined;\n\t} catch (error) {\n\t  console.error('Error checking if font is variable:', error);\n\t  return false;\n\t}\n  };\n  \n  const generateFontFaces = (fonts) => {\n\treturn fonts.map(font => {\n\t  const fontName = font.replace('.', '-');\n\t  return `@font-face { font-family: \"${fontName}\"; src: url(\"fonts/${font}\");}`;\n\t}).join('\\n');\n  };\n\n  // Add new function to handle column updates\nwindow.updateColumns = (itemID) => {\n\tconst columnCount = document.getElementById(`${itemID}-column-count`).value;\n\tconst columnGap = document.getElementById(`${itemID}-column-gap`).value;\n\t\n\tpassStyleValue(itemID, 'column-count', columnCount);\n\tpassStyleValue(itemID, 'column-gap', columnGap);\n  };\n\n  const generateStyleButtons = (itemID) => `\n  <div id=\"btn__wrapper-case\">\n    <label>Case</label>\n    <div class=\"d-flex g-1 btn__wrapper\">\n      <button class=\"btn btn-link textTransform-uppercase\" title=\"Uppercase\" onclick=\"passStyleValue('${itemID}','textTransform', 'uppercase')\">TT</button>\n      <button class=\"btn btn-link textTransform-capitalize\" title=\"Capitalize\" onclick=\"passStyleValue('${itemID}','textTransform', 'capitalize')\">Tt</button>\n      <button class=\"btn btn-link textTransform-lowercase\" title=\"Lowercase\" onclick=\"passStyleValue('${itemID}','textTransform', 'lowercase')\">tt</button>\n    </div>\n  </div>\n  <div id=\"btn__wrapper-columns\">\n    <label>Columns</label>\n    <div class=\"d-flex g-1 btn__wrapper\">\n\t<span class=\"text-small\">Count</span>\n      <input class=\"input\" type=\"number\" id=\"${itemID}-column-count\" min=\"1\" max=\"6\" value=\"1\" onchange=\"updateColumns('${itemID}')\" style=\"width: 50px;\">\n\t<span class=\"text-small\">Gap</span>\n      <input class=\"input\" type=\"text\" id=\"${itemID}-column-gap\" value=\"10px\" onchange=\"updateColumns('${itemID}')\" style=\"width: 50px;\">\n    </div>\n  </div>\n`;\n\nconst getFeatureDescription = (font, tag, proof) => {\n    // Check if it's a stylistic set feature (ss01-ss20)\n    if (tag.startsWith('ss')) {\n        const ssNum = parseInt(tag.slice(2), 10);\n        if (ssNum >= 1 && ssNum <= 20) {\n            const nameID = 256 + (ssNum - 1);\n            const ssName = font?.names?.[nameID]?.en;\n            if (ssName) {\n                return ssName;\n            }\n            // If no name in font, return generic stylistic set name\n            return `Stylistic Set ${ssNum}`;\n        }\n    }\n    \n    // For non-stylistic set features, use proof.json\n    return proof[\"Features\"]?.[tag]?.[\"abstract\"] || tag;\n};\n\nconst generateFeatureCheckboxes = (itemID, proof, taglist) => {\n    const uniqueTags = [...new Set(taglist)];\n    return `\n      <label>Features</label>  \n      <div class=\"btn__wrapper d-flex flex-wrap g-0\">\n        ${uniqueTags.map(tag => {\n          const featureDescription = getFeatureDescription(font, tag, proof);\n          const definition = proof[\"Features\"]?.[tag]?.[\"definition\"] || '';\n          \n          return `\n            <div title=\"${definition}\" class=\"chip d-flex align-items-center justify-content-between d-flex-grow\" onclick=\"document.getElementById('${itemID}-checkbox-${tag}').click()\">\n              <input id=\"${itemID}-checkbox-${tag}\" type=\"checkbox\" onclick=\"passfeatValue('${itemID}', '${tag}', '${uniqueTags.join(',')}')\">\n              <span class=\"d-flex-grow\">${featureDescription}</span>\n              <span class=\"tag-label text-small\">${tag}</span>\n            </div>\n          `;\n        }).join('')}\n      </div>\n    `;\n};\n  \n  \n  const generateProofContent = (stage, title, proof, testAreaID, fvarStyle, textClass) => {\n    // Add safety checks\n    if (!proof || !proof[stage] || !proof[stage][title]) {\n      console.warn('Missing proof data:', { stage, title });\n      return '';\n    }\n\n    // Special handling for Features stage\n    let content = proof[stage][title];\n    if (stage === \"Features\") {\n      // Features content is stored as an object with 'sample', 'definition', and 'abstract' properties\n      content = proof[stage][title].sample || '';\n    }\n\n    const savedContent = getStoredContent(testAreaID, content) || '';\n    const savedTitle = getStoredContent(`${testAreaID}-title`, title) || '';\n    const fontSize = whichFontSize(savedContent);\n  \n    // Get other style values\n    const lineHeight = getItemLineHeight(testAreaID);\n    const letterSpacing = localStorage.getItem(`${testAreaID}-letterSpacing`) || '0em';\n    const columnCount = localStorage.getItem(`${testAreaID}-column-count`) || '1';\n    const columnGap = localStorage.getItem(`${testAreaID}-column-gap`) || '1em';\n  \n    const inlineStyle = `\n      font-size: ${fontSize}pt;\n      line-height: ${lineHeight};\n      letter-spacing: ${letterSpacing};\n      column-count: ${columnCount};\n      column-gap: ${columnGap};\n    `;\n   // previously included testarea-values\n   // <span class=\"testarea-values small\">${generateTestAreaValues(inlineStyle)}</span>\n   // couldn't get them to stay cons\n    const html = `\n      <div class=\"d-flex justify-content-between\">\n        <h6 class=\"h6\" contentEditable=\"true\" \n            id=\"${testAreaID}-title\"\n            onkeyup=\"saveEditableContent('${testAreaID}-title')\">${savedTitle}</h6>\n      </div>\n      <div class=\"testarea-container\">\n        <div id=\"${testAreaID}\" \n             style=\"${inlineStyle} ${fvarStyle}\" \n             class=\"t__importedfontfamily testarea\" \n             contenteditable=\"true\" \n             spellcheck=\"false\" \n             onkeyup=\"saveEditableContent('${testAreaID}')\">\n          ${savedContent}\n        </div>\n      </div>\n    `;\n  \n    return html;\n  };\n  \n  const formatStyleValue = (property, value) => {\n    switch (property) {\n      case 'font-size':\n        return value;\n      case 'line-height':\n        return value;\n      case 'letter-spacing':\n        return value.replace('em', '');\n      default:\n        return value;\n    }\n  };\n  \n  const generateTestAreaValues = (inlineStyle) => {\n    // Only show these core properties\n    const styleMap = {\n      'font-size': 'Size',\n      'line-height': 'Leading',\n      'letter-spacing': 'Tracking'\n    };\n\n    const styles = inlineStyle.split(';')\n      .filter(s => s.trim())\n      // Only process styles that are in our styleMap\n      .filter(style => {\n        const property = style.split(':')[0].trim();\n        return styleMap.hasOwnProperty(property);\n      });\n\n    return styles.map(style => {\n      const [property, value] = style.split(':').map(s => s.trim());\n      const label = styleMap[property];\n      const formattedValue = formatStyleValue(property, value);\n      return `<span class=\"${property}\">${label}: ${formattedValue}</span>`;\n    }).join('  ');\n  };\n  \n  const updateInlineText = (itemID, property, value) => {\n\tconst container = document.querySelector(`#${itemID} .testarea-values`);\n\tif (!container) return;\n\n\t// Get values from the sliders\n\tconst fontSizeSlider = document.querySelector(`#${itemID}-fontSize`);\n\tconst lineHeightSlider = document.querySelector(`#${itemID}-lineHeight`);\n\tconst letterSpacingSlider = document.querySelector(`#${itemID}-letterSpacing`);\n\n\tconst currentStyles = {\n\t\t'font-size': `${fontSizeSlider?.value || '14'}pt`,\n\t\t'line-height': lineHeightSlider?.value || '1.0',\n\t\t'letter-spacing': `${letterSpacingSlider?.value || '0'}em`\n\t};\n\n\tconst inlineStyle = Object.entries(currentStyles)\n\t\t.map(([prop, val]) => `${prop}: ${val}`)\n\t\t.join('; ');\n\n\tcontainer.innerHTML = generateTestAreaValues(inlineStyle);\n  };\n\n// Global functions\n\nexport const insertField = (aboveHere) => {\n\tconst original = document.getElementById(aboveHere);\n\tconst clone = original.cloneNode(true);\n\t\n\t// Reset any unique IDs or input values in the clone\n\tclone.id = `${aboveHere}-clone-${Date.now()}`;\n\tclone.querySelectorAll('[id]').forEach(el => {\n\t  el.id = `${el.id}-clone-${Date.now()}`;\n\t});\n\tclone.querySelectorAll('input').forEach(input => {\n\t  input.value = '';\n\t});\n  \n\toriginal.parentNode.insertBefore(clone, original);\n\t\n\t// Animate the insertion\n\tclone.style.height = '0px';\n\tclone.style.overflow = 'hidden';\n\tclone.style.transition = 'height 0.6s ease';\n\t\n\tsetTimeout(() => {\n\t  clone.style.height = `${clone.scrollHeight}px`;\n\t}, 0);\n\t\n\tsetTimeout(() => {\n\t  clone.style.height = 'auto';\n\t  clone.style.overflow = 'visible';\n\t}, 600);\n  };\n  \n  export const passStyleValue = (itemID, property, value) => {\n\tconst elementIdSuffix = `-${property}-val`;\n\tconst element = document.querySelector(`[id$=\"${itemID}${elementIdSuffix}\"]`);\n\t\n    // Save to localStorage for persistent properties\n    if (['fontSize', 'lineHeight', 'letterSpacing', 'column-count', 'column-gap'].includes(property)) {\n        localStorage.setItem(`${itemID}-${property}`, value);\n        \n        // Add unit suffixes\n        let displayValue = value;\n        if (property === 'fontSize') displayValue += 'pt';\n        if (property === 'letterSpacing') displayValue += 'em';\n        if (element) element.textContent = displayValue;\n\n        // Add .modified class to slider\n        const slider = document.querySelector(`#${itemID}-${property}`);\n        if (slider) {\n            slider.classList.add('modified');\n        }\n    }\n\n    // Update the testarea with proper units\n    const testarea = document.querySelector(`#${itemID} .testarea`);\n    if (testarea) {\n        let styleValue = value;\n        if (property === 'fontSize') styleValue += 'pt';\n        if (property === 'letterSpacing') styleValue += 'em';\n        testarea.style[property] = styleValue;\n    }\n\n    // Update the testarea-values display\n    updateInlineText(itemID, property, value);\n  };\n  \n  export const passfvarValue = (itemID, property, value, fvarSupport) => {\n    const element = document.getElementById(`${itemID}-${property}-val`);\n    if (element) {\n        element.textContent = value;\n    } else {\n        console.warn(`Element with ID ${itemID}-${property}-val not found.`);\n    }\n\n    saveData(`${itemID}-${property}-val`, value);\n\n    const fvarSupportArray = fvarSupport.split(',');\n    let fvarcss = fvarSupportArray.map(tag => {\n        const tagValue = tag === property ? value : document.getElementById(`${itemID}-${tag}`)?.value; // Use optional chaining\n        return `'${tag}' ${tagValue}`;\n    }).join(', ');\n\n    const testarea = document.querySelector(`#${itemID} .testarea`);\n    if (testarea) {\n        testarea.style.fontVariationSettings = fvarcss;\n    } else {\n        console.warn(`Test area with ID ${itemID} not found.`);\n    }\n\n    updateInlineText(itemID, 'fvar', fvarcss);\n};\n  \n  export const passfeatValue = (itemID, feature, featureSupport) => {\n\tconst featSupport = featureSupport.split(',');\n\tlet featcss = \"\";\n  \n\tfor (let f = 0; f < featSupport.length; f++) {\n\t  if (document.getElementById(`${itemID}-checkbox-${featSupport[f]}`).checked) {\n\t\tfeatcss += `'${featSupport[f]}',`;\n\t  }\n\t}\n\tfeatcss = featcss.replace(/,\\s*$/, \"\");\n\tdocument.querySelector(`#${itemID} .testarea`).style.fontFeatureSettings = featcss;\n  };\n  \n  const updateActiveButton = (property, value) => {\n\tdocument.querySelectorAll(`.btn.${property}-${value}`).forEach(btn => {\n\t  btn.classList.add('active');\n\t  \n\t  // Find the parent wrapper\n\t  const wrapper = btn.closest('.btn__wrapper');\n\t  \n\t  if (wrapper) {\n\t\t// If we found a wrapper, remove 'active' class from all sibling buttons\n\t\twrapper.querySelectorAll('.btn').forEach(sibling => {\n\t\t  if (sibling !== btn) sibling.classList.remove('active');\n\t\t});\n\t  } else {\n\t\t// Fallback: remove 'active' class from all buttons with the same property\n\t\tdocument.querySelectorAll(`.btn[class*=\"${property}-\"]`).forEach(sibling => {\n\t\t  if (sibling !== btn) sibling.classList.remove('active');\n\t\t});\n\t  }\n\t});\n  };\n\n  // Export the function\nexport const removeStyleValue = (itemID, property) => {\n    localStorage.removeItem(`${itemID}-${property}`);\n    \n    // Get default value based on property\n    let defaultValue;\n    if (property === 'fontSize') {\n        const testarea = document.querySelector(`#${itemID} .testarea`);\n        const text = testarea?.textContent || '';\n        const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n        const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n        defaultValue = whichFontSize(text, baseSize, ratio);\n    } else if (property === 'lineHeight') {\n        defaultValue = getGlobalLineHeight();\n    } else {\n        defaultValue = '0'; // Default for letter-spacing\n    }\n\n    // Update the display and slider\n    const slider = document.querySelector(`#${itemID}-${property}`);\n    if (slider) {\n        slider.value = defaultValue;\n        slider.classList.remove('modified');\n\t\tconsole.log(slider);\n    }\n\n    // Update the value display\n    const valueDisplay = document.querySelector(`#${itemID}-${property}-val`);\n    if (valueDisplay) {\n        valueDisplay.textContent = property === 'fontSize' ? `${defaultValue}pt` : defaultValue;\n    }\n\n    // Update the testarea style\n    const testarea = document.querySelector(`#${itemID} .testarea`);\n    if (testarea) {\n        let styleValue = defaultValue;\n        if (property === 'fontSize') styleValue += 'pt';\n        if (property === 'letterSpacing') styleValue += 'em';\n        testarea.style[property] = styleValue;\n    }\n\n    // Update the inline text display\n    updateInlineText(itemID, property, defaultValue);\n\n};\n\n// Add to window object for HTML onclick access\nwindow.removeStyleValue = removeStyleValue;\n\n// generate buttons\nexport const generateStageButtons = (proof, currentStage) => {\n    return Object.keys(proof).map(stage => {\n      const isActive = stage === currentStage ? 'active' : '';\n      return `\n        <div class=\"tab-item ${isActive} tab__setstage\" onclick=\"setStage('${stage}')\">\n          <a href=\"#\" class=\"stage-button\">${stage}</a>\n        </div>\n      `;\n    }).join('');\n  };\n\n  // localload vs server\n\n  export const localLoad = () => {\n\tconst fileButtonParent = document.getElementById('section__header-file-buttons');\n\t\n\tfetch('../src/txt/fonts.txt')\n\t  .then(response => response.text())\n\t  .then(data => {\n\t\tconst fonts = data.split('fonts/')\n\t\t  .filter(font => font.trim() !== '')\n\t\t  .map(font => font.trim());\n  \n\t\tconst uniqueFonts = preserveUnique(fonts.sort());\n\t\t\n\t\tif (uniqueFonts.length === 0) {\n\t\t  // Only show the message if no fonts are found\n\t\t  fileButtonParent.innerHTML = 'Place fonts you want to proof into <code>/fonts</code> to begin';\n\t\t} else {\n\t\t  // First add navigation\n\t\t  const navGroup = generateFontNavigation();\n\t\t  fileButtonParent.appendChild(navGroup);\n\t\t  \n\t\t  // Then add font buttons\n\t\t  generateFontButtons(uniqueFonts, 'local')\n\t\t    .then(container => {\n\t\t      fileButtonParent.appendChild(container);\n\t\t      // Set the default font\n\t\t      const fontFamilySource = localStorage.getItem('fontFamilySource') || \n\t\t        `fonts/${uniqueFonts[uniqueFonts.length - 1]}`;\n\t\t      const fontFamily = localStorage.getItem('fontFamily') || \n\t\t        fontFamilySource.replace('.', '-');\n\t\t      setFont(fontFamilySource, fontFamily);\n\t\t    });\n\t\t}\n\t  })\n\t  .catch(error => {\n\t\tconsole.error('Error loading fonts:', error);\n\t\t// Show the message if there's an error loading fonts\n\t\tfileButtonParent.innerHTML = 'Place fonts you want to proof into <code>/fonts</code> to begin';\n\t  });\n  };\n  \n  export const serverLoad = () => {\n\tconst fileButtonParent = document.getElementById('section__header-file-buttons');\n\t\n\t// Load the default Gooper font\n\tsetFont('fonts/gooper-VF.ttf', 'gooper-VF-ttf');\n\tdocument.getElementById('style__fontface').innerHTML = '@font-face { font-family: \"gooper-VF-ttf\"; src: url(\"fonts/gooper-VF.ttf\");}';\n  \n\tconst dragDropHtml = `\n\t  <div id=\"drag-drop-area\" class=\"drag-drop-area\">\n\t\t<p>Drag & drop font files here</p>\n\t\t<p>or</p>\n\t\t<label for=\"fontInput\" class=\"file-input-label\">Choose Files</label>\n\t\t<input id=\"fontInput\" type=\"file\" class=\"file-input\" multiple accept=\".ttf,.otf\" />\n\t  </div>\n\t`;\n\n\tfileButtonParent.innerHTML = dragDropHtml;\n  \n\tconst dragDropArea = document.getElementById('drag-drop-area');\n\tconst fileInput = document.getElementById('fontInput');\n  \n\t// Prevent default drag behaviors\n\t['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n\t  dragDropArea.addEventListener(eventName, preventDefaults, false);\n\t  document.body.addEventListener(eventName, preventDefaults, false);\n\t});\n  \n\t// Highlight drop area when item is dragged over it\n\t['dragenter', 'dragover'].forEach(eventName => {\n\t  dragDropArea.addEventListener(eventName, highlight, false);\n\t});\n  \n\t['dragleave', 'drop'].forEach(eventName => {\n\t  dragDropArea.addEventListener(eventName, unhighlight, false);\n\t});\n  \n\t// Handle dropped files\n\tdragDropArea.addEventListener('drop', handleDrop, false);\n  \n\t// Handle selected files\n\tfileInput.addEventListener('change', handleFiles, false);\n  };\n  \n  function preventDefaults(e) {\n\te.preventDefault();\n\te.stopPropagation();\n  }\n  \n  function highlight(e) {\n\tdocument.getElementById('drag-drop-area').classList.add('highlight');\n  }\n  \n  function unhighlight(e) {\n\tdocument.getElementById('drag-drop-area').classList.remove('highlight');\n  }\n  \n  function handleDrop(e) {\n\tconst dt = e.dataTransfer;\n\tconst files = dt.files;\n\thandleFiles(files);\n  }\n  \n  function handleFiles(filesOrEvent) {\n\tlet files;\n\tif (filesOrEvent instanceof Event) {\n\t  files = filesOrEvent.target.files;\n\t} else {\n\t  files = filesOrEvent;\n\t}\n  \n\tfiles = Array.from(files);\n\t\n\t// Process all files\n\tconst uploadPromises = files.map(file => uploadFile(file));\n  \n\t// After all files are processed, select the first font chip\n\tPromise.all(uploadPromises).then(() => {\n\t  setTimeout(() => {\n\t\tconst firstButton = document.querySelector('.btn__setfont');\n\t\tif (firstButton) {\n\t\t  firstButton.click();\n\t\t}\n\t  }, 100); // Short delay to ensure DOM is updated\n\t});\n  }\n  \n  function uploadFile(file) {\n\treturn new Promise((resolve) => {\n\t  onReadFile({ target: { files: [file] } });\n\t  // Assume onReadFile is asynchronous and use a setTimeout to simulate its completion\n\t  setTimeout(resolve, 50);\n\t});\n  }\n  \n  // Make sure onReadFile returns a Promise or is modified to work with this approach\n  \n  function previewFile(file) {\n\tconst reader = new FileReader();\n\treader.readAsDataURL(file);\n\treader.onloadend = function() {\n\t  const img = document.createElement('img');\n\t  img.src = reader.result;\n\t  document.getElementById('drag-drop-area').appendChild(img);\n\t}\n  }\n  \n  export const setupEventListeners = () => {\n\tconst fileButtons = document.getElementById('section__header-file-buttons');\n\tconst stageButtons = document.getElementById('section__header-stage-buttons');\n\tconst toolsToggle = document.getElementById('btn__view-tools-toggle');\n\tconst modeToggle = document.getElementById('btn__mode-toggle');\n\tconst localStorageClearButton = document.getElementById('btn__reset-local-storage');\n\tconst settingsToggle = document.getElementById('btn__settings-toggle');\n\tconst addNameAndVersionCheckbox = document.getElementById('checkbox__add-name-and-version');\n\tconst lockProofDimensionsCheckbox = document.getElementById('checkbox__lock-proof-dimensions');\n\tif (fileButtons) {\n\t  fileButtons.addEventListener('click', handleFileButtonClick);\n\t}\n\tif (stageButtons) {\n\t  stageButtons.addEventListener('click', handleStageButtonClick);\n\t}\n\tif (toolsToggle) {\n\t  toolsToggle.addEventListener('click', toggleToolsVisibility);\n\t}\n\tif (modeToggle) {\n\t\tmodeToggle.addEventListener('click', toggleMode);\n\t}\n\tif (localStorageClearButton) {\n\t\tlocalStorageClearButton.addEventListener('click', localStorageClear);\n\t}\n\tif (settingsToggle) {\n\t\tsettingsToggle.addEventListener('click', toggleSettingsVisibility);\n\t}\n\tif (addNameAndVersionCheckbox) {\n\t\t// Restore saved state\n\t\tconst savedState = localStorage.getItem('showNameAndVersion') === 'true';\n\t\taddNameAndVersionCheckbox.checked = savedState;\n\t\tdocument.body.classList.toggle('show-font-details', savedState);\n\t\t\n\t\taddNameAndVersionCheckbox.addEventListener('change', toggleNameAndVersion);\n\t}\n\tif (lockProofDimensionsCheckbox) {\n\t\t// Restore saved state\n\t\tconst savedState = localStorage.getItem('lockProofDimensions') === 'true';\n\t\tlockProofDimensionsCheckbox.checked = savedState;\n\t\t\n\t\t// Apply the saved state immediately\n\t\tapplyLockProofDimensions(savedState);\n\t\t\n\t\tlockProofDimensionsCheckbox.addEventListener('change', toggleLockProofDimensions);\n\t}\n\tsetupPasteHandling();\n\n\t// Add aspect ratio select listener\n\tconst aspectRatioSelect = document.getElementById('select__aspect-ratio');\n\tif (aspectRatioSelect) {\n\t\t// Set initial value\n\t\tconst proofs = document.querySelectorAll('.item__proof');\n\t\tproofs.forEach(proof => proof.classList.add('ratio-letter'));\n\n\t\t// Watch for changes\n\t\taspectRatioSelect.addEventListener('change', (e) => {\n\t\t\tconst ratio = e.target.value;\n\t\t\tconst proofs = document.querySelectorAll('.item__proof');\n\t\t\t\n\t\t\tproofs.forEach(proof => {\n\t\t\t\tproof.classList.remove('ratio-letter', 'ratio-a4');\n\t\t\t\tproof.classList.add(ratio === '8.5:11' ? 'ratio-letter' : 'ratio-a4');\n\t\t\t});\n\n\t\t\tlocalStorage.setItem('preferred-ratio', ratio);\n\t\t});\n\n\t\t// Restore saved preference if it exists\n\t\tconst savedRatio = localStorage.getItem('preferred-ratio');\n\t\tif (savedRatio) {\n\t\t\taspectRatioSelect.value = savedRatio;\n\t\t\taspectRatioSelect.dispatchEvent(new Event('change'));\n\t\t}\n\t}\n\n\t// Add base font size input listener\n\tconst baseFontInput = document.getElementById('input__base-font-size');\n\tif (baseFontInput) {\n\t\tbaseFontInput.addEventListener('change', (e) => {\n\t\t\tconst baseSize = parseFloat(e.target.value);\n\t\t\tlocalStorage.setItem('base-font-size', baseSize);\n\t\t\tupdateAllTypeScales();\n\t\t});\n\n\t\t// Restore saved base font size\n\t\tconst savedBaseSize = localStorage.getItem('base-font-size') || '14';\n\t\tbaseFontInput.value = savedBaseSize;\n\t}\n\n\t// Add line height input listener\n\tconst lineHeightInput = document.getElementById('input__line-height');\n\tif (lineHeightInput) {\n\t\tlineHeightInput.addEventListener('change', (e) => {\n\t\t\tconst lineHeight = parseFloat(e.target.value);\n\t\t\tlocalStorage.setItem('line-height', lineHeight);\n\t\t\tupdateAllLineHeights();\n\t\t});\n\n\t\t// Restore saved line height\n\t\tconst savedLineHeight = getGlobalLineHeight();\n\t\tlineHeightInput.value = savedLineHeight;\n\t}\n\n\t// Modify type scale select listener\n\tconst typeScaleSelect = document.getElementById('select__type-scale');\n\tif (typeScaleSelect) {\n\t\ttypeScaleSelect.addEventListener('change', () => {\n\t\t\tupdateAllTypeScales();\n\t\t});\n\t}\n\n\t// Initialize color mode from localStorage\n\tinitColorMode();\n  };\n  \n  const handleFileButtonClick = (event) => {\n\tif (event.target.classList.contains('btn__setfont')) {\n\t  event.target.classList.add('active', 'visited');\n\t  // Remove 'active' class from sibling elements\n\t  const siblings = Array.from(event.target.parentNode.children).filter(child => child !== event.target);\n\t  siblings.forEach(sibling => sibling.classList.remove('active'));\n\t}\n  };\n  \n  const handleStageButtonClick = (event) => {\n\tif (event.target.classList.contains('btn__setstage')) {\n\t  event.target.classList.add('active');\n\t  // Remove 'active' class from sibling elements\n\t  const siblings = Array.from(event.target.parentNode.children).filter(child => child !== event.target);\n\t  siblings.forEach(sibling => sibling.classList.remove('active'));\n\t}\n  };\n  \n  const toggleToolsVisibility = () => {\n\tdocument.body.classList.toggle('tools-visible');\n  };\n\nconst setupPasteHandling = () => {\n  document.addEventListener('paste', (e) => {\n    // Only handle paste events in testarea elements\n    if (!e.target.classList.contains('testarea')) {\n      return;\n    }\n\n    // Prevent the default paste\n    e.preventDefault();\n\n    // Get plain text from clipboard\n    const text = (e.clipboardData || window.clipboardData).getData('text/plain');\n\n    // Insert the plain text at cursor position\n    const selection = window.getSelection();\n    if (selection.rangeCount) {\n      const range = selection.getRangeAt(0);\n      range.deleteContents();\n      range.insertNode(document.createTextNode(text));\n    } else {\n      e.target.textContent += text;\n    }\n\n    // Trigger the onkeyup event to save the content\n    const event = new Event('keyup');\n    e.target.dispatchEvent(event);\n  });\n};\n\nexport const generateFontButtons = async (fonts, mode = 'local') => {\n  const container = document.createElement('div');\n  container.className = 'font-buttons-container';\n\n  // Create font chips container\n  const chipsContainer = document.createElement('div');\n  chipsContainer.className = 'font-chips';\n  \n  // Generate individual font buttons\n  for (const font of fonts) {\n    const button = await generateFontButton(font, mode);\n    chipsContainer.appendChild(button);\n  }\n\n  return chipsContainer; // Return only the chips container\n};\n\n// Create a separate function for navigation\nexport const generateFontNavigation = () => {\n  const navGroup = document.createElement('div');\n  navGroup.className = 'btn-group d-flex g-1 mb-2 font-nav-group';\n  \n  const prevButton = document.createElement('button');\n  prevButton.className = 'btn d-flex align-items-center justify-content-between d-flex-grow';\n  prevButton.innerHTML = '<span class=\"material-symbols-outlined\">chevron_left</span> Prev';\n  prevButton.onclick = () => navigateFonts('prev');\n  \n  const nextButton = document.createElement('button');\n  nextButton.className = 'btn d-flex align-items-center justify-content-between d-flex-grow';\n  nextButton.innerHTML = 'Next <span class=\"material-symbols-outlined\">chevron_right</span>';\n  nextButton.onclick = () => navigateFonts('next');\n  \n  navGroup.appendChild(prevButton);\n  navGroup.appendChild(nextButton);\n  \n  return navGroup;\n};\n\nconst navigateFonts = (direction) => {\n  const buttons = document.querySelectorAll('.btn__setfont');\n  const activeButton = document.querySelector('.btn__setfont.active');\n  \n  if (!activeButton || buttons.length <= 1) return;\n  \n  const currentIndex = Array.from(buttons).indexOf(activeButton);\n  let nextIndex;\n  \n  if (direction === 'next') {\n    nextIndex = currentIndex + 1 >= buttons.length ? 0 : currentIndex + 1;\n  } else {\n    nextIndex = currentIndex - 1 < 0 ? buttons.length - 1 : currentIndex - 1;\n  }\n  \n  buttons[nextIndex].click();\n};\n\nconst initAspectRatio = () => {\n  const select = document.getElementById('select__aspect-ratio');\n  const proofs = document.querySelectorAll('.item__proof');\n\n  // Set default on load\n  proofs.forEach(proof => {\n    proof.classList.add('ratio-letter');\n  });\n\n  select.addEventListener('change', (e) => {\n    const ratio = e.target.value;\n    proofs.forEach(proof => {\n      // Remove existing ratio classes\n      proof.classList.remove('ratio-letter', 'ratio-a4');\n      \n      // Add new ratio class\n      switch(ratio) {\n        case '8.5:11':\n          proof.classList.add('ratio-letter');\n          break;\n        case '7:10':\n          proof.classList.add('ratio-a4');\n          break;\n      }\n    });\n\n    // Optionally save preference\n    localStorage.setItem('preferred-ratio', ratio);\n  });\n\n  // Restore saved preference if it exists\n  const savedRatio = localStorage.getItem('preferred-ratio');\n  if (savedRatio) {\n    select.value = savedRatio;\n    select.dispatchEvent(new Event('change'));\n  }\n};\n\n// Use the imported function where needed\nconst getFontSize = (text, ratio = 1.618) => {\n  const sizes = calculateTypeScale(14, ratio);\n  const length = text.length;\n  \n  if (length <= 5) return sizes[0];        // Largest size\n  if (length <= 15) return sizes[1];       // Second largest\n  if (length <= 30) return sizes[2];       // Third largest\n  if (length <= 100) return sizes[3];      // Medium\n  if (length <= 250) return sizes[4];      // Second smallest\n  return sizes[5];                         // Smallest/base size\n};\n\n// Update your proof generation to use the selected scale\nconst generateProof = (text, options = {}) => {\n  const typeScale = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n  const fontSize = getFontSize(text, typeScale);\n  \n  // ... rest of your proof generation code ...\n};\n\n// Add this function to initialize the type scale on page load\nconst initTypeScale = () => {\n    const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n    const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n    \n    document.querySelectorAll('.item').forEach(item => {\n        const itemID = item.id;\n        const testarea = item.querySelector('.testarea');\n        const text = testarea?.textContent || '';\n        \n        // Get the item-specific line height and font size\n        const itemLineHeight = getItemLineHeight(itemID);\n        const itemFontSize = getItemFontSize(itemID, text, baseSize, ratio);\n        \n        if (testarea) {\n            testarea.style.fontSize = `${itemFontSize}pt`;\n            testarea.style.lineHeight = itemLineHeight;\n        }\n        \n        // Update fontSize slider and its value display\n        const fontSizeSlider = item.querySelector(`#${itemID}-fontSize`);\n        const fontSizeVal = item.querySelector(`#${itemID}-fontSize-val`);\n        if (fontSizeSlider) {\n            fontSizeSlider.value = itemFontSize;\n            // Add .modified class if using custom font size\n            if (localStorage.getItem(`${itemID}-fontSize`)) {\n                fontSizeSlider.classList.add('modified');\n            }\n        }\n        if (fontSizeVal) {\n            fontSizeVal.textContent = `${itemFontSize}pt`;\n        }\n\n        // Update the testarea-values display\n        const valuesDisplay = item.querySelector('.testarea-values');\n        if (valuesDisplay) {\n            const currentStyles = {\n                'font-size': `${newSize}pt`,\n                'line-height': `${itemLineHeight}`, // Use item-specific line height\n                'letter-spacing': testarea?.style.letterSpacing || '0em'\n            };\n\n            const inlineStyle = Object.entries(currentStyles)\n                .map(([prop, val]) => `${prop}: ${val}`)\n                .join('; ');\n\n            valuesDisplay.innerHTML = generateTestAreaValues(inlineStyle);\n        }\n    });\n};\n\n// New function to update all proofs when either base size or ratio changes\nconst updateAllTypeScales = () => {\n    const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n    const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n    \n    localStorage.setItem('preferred-scale', ratio);\n    \n    document.querySelectorAll('.item').forEach(item => {\n        const itemID = item.id;\n        const testarea = item.querySelector('.testarea');\n        const text = testarea?.textContent || '';\n        \n        // Get the appropriate font size (either stored or calculated)\n        const fontSize = getItemFontSize(itemID, text, baseSize, ratio);\n        const itemLineHeight = getItemLineHeight(itemID);\n        \n        if (testarea) {\n            testarea.style.fontSize = `${fontSize}pt`;\n            testarea.style.lineHeight = itemLineHeight;\n        }\n        \n        // Update font size display\n        const fontSizeSlider = item.querySelector(`#${itemID}-fontSize`);\n        const fontSizeVal = item.querySelector(`#${itemID}-fontSize-val`);\n        if (fontSizeSlider) {\n            fontSizeSlider.value = fontSize;\n            // Add .modified class if using custom font size\n            if (localStorage.getItem(`${itemID}-fontSize`)) {\n                fontSizeSlider.classList.add('modified');\n            }\n        }\n        if (fontSizeVal) {\n            fontSizeVal.textContent = `${fontSize}pt`;\n        }\n\n        // Update line height display\n        updateItemLineHeightDisplay(itemID, itemLineHeight);\n    });\n};\n\n\n\nconst updateAllLineHeights = () => {\n    const globalLineHeight = getGlobalLineHeight();\n    localStorage.setItem('line-height', globalLineHeight);\n    \n    document.querySelectorAll('.item').forEach(item => {\n        const itemID = item.id;\n        // Only update items that don't have specific line heights\n        if (!localStorage.getItem(`${itemID}-lineHeight`)) {\n            updateItemLineHeightDisplay(itemID, globalLineHeight);\n        }\n    });\n};\n\nconst applyNameAndVersion = (isChecked) => {\n  const headerNames = document.getElementById('section__header-names');\n  const proofItems = document.querySelectorAll('.item__proof');\n\n  proofItems.forEach(item => {\n    // Remove any existing footer\n    const existingFooter = item.querySelector('.proof-footer');\n    if (existingFooter) {\n      existingFooter.remove();\n    }\n\n    if (isChecked) {\n      // Create new footer\n      const footer = document.createElement('div');\n      footer.className = 'proof-footer';\n      footer.innerHTML = headerNames.innerHTML;\n      item.appendChild(footer);\n    }\n  });\n};\n\nconst toggleNameAndVersion = (event) => {\n  const isChecked = event.target.checked;\n  localStorage.setItem('showNameAndVersion', isChecked);\n  document.body.classList.toggle('show-font-details', isChecked);\n};\n\nconst applyLockProofDimensions = (isChecked) => {\n  document.querySelectorAll('.item__proof').forEach(proof => {\n    if (isChecked) {\n      proof.classList.add('locked-dimensions');\n    } else {\n      proof.classList.remove('locked-dimensions');\n    }\n  });\n};\nconst toggleLockProofDimensions = (event) => {\n  const isChecked = event.target.checked;\n  localStorage.setItem('lockProofDimensions', isChecked);\n  applyLockProofDimensions(isChecked);\n};\n\n// Add new function to get item-specific font size\nconst getItemFontSize = (itemID, text, baseSize, ratio) => {\n    // Check for stored custom value first\n    const storedSize = localStorage.getItem(`${itemID}-fontSize`);\n    if (storedSize !== null) {\n        return parseFloat(storedSize);\n    }\n    // Otherwise calculate based on text length\n    return whichFontSize(text, baseSize, ratio);\n};\n\nconst getItemLineHeight = (itemID) => {\n    return parseFloat(\n        localStorage.getItem(`${itemID}-lineHeight`) ||\n        getGlobalLineHeight()\n    );\n};\n// Line Height Utilities\nconst getGlobalLineHeight = () => {\n    return parseFloat(\n        document.getElementById('input__line-height')?.value ||\n        localStorage.getItem('line-height') || 1.0\n    );\n};\n\nconst setItemLineHeight = (itemID, value) => {\n    localStorage.setItem(`${itemID}-lineHeight`, value);\n    updateItemLineHeightDisplay(itemID, value);\n};\n\nconst updateItemLineHeightDisplay = (itemID, value) => {\n    const item = document.getElementById(itemID);\n    if (!item) return;\n\n    const testarea = item.querySelector('.testarea');\n    const lineHeightSlider = item.querySelector(`#${itemID}-lineHeight`);\n    const lineHeightVal = item.querySelector(`#${itemID}-lineHeight-val`);\n    const valuesDisplay = item.querySelector('.testarea-values');\n    \n    if (testarea) testarea.style.lineHeight = value;\n    if (lineHeightSlider) lineHeightSlider.value = value;\n    if (lineHeightVal) lineHeightVal.textContent = value;\n    \n    if (valuesDisplay) {\n        const currentStyles = {\n            'font-size': testarea?.style.fontSize || '14pt',\n            'line-height': `${value}`,\n            'letter-spacing': testarea?.style.letterSpacing || '0em'\n        };\n        valuesDisplay.innerHTML = generateTestAreaValues(\n            Object.entries(currentStyles)\n                .map(([prop, val]) => `${prop}: ${val}`)\n                .join('; ')\n        );\n    }\n};\n\n// Update resetCustomValue to handle font size reset\nexport const resetCustomValue = (itemID, property) => {\n    localStorage.removeItem(`${itemID}-${property}`);\n    \n    let globalValue;\n    if (property === 'lineHeight') {\n        globalValue = getGlobalLineHeight();\n    } else if (property === 'fontSize') {\n        const testarea = document.querySelector(`#${itemID} .testarea`);\n        const text = testarea?.textContent || '';\n        const ratio = parseFloat(document.getElementById('select__type-scale')?.value || 1.618);\n        const baseSize = parseFloat(document.getElementById('input__base-font-size')?.value || 14);\n        globalValue = whichFontSize(text, baseSize, ratio);\n    }\n        \n    updateItemDisplay(itemID, property, globalValue);\n    \n    // Remove modified class\n    const slider = document.querySelector(`#${itemID}-${property}`);\n    if (slider) {\n        slider.classList.remove('modified');\n    }\n};\n\n","import { CONFIG } from './config.js';\nimport * as AppCore from './app-core.js';\nimport { localStorageClear, saveEditableContent, saveInputValue } from './utils.js';\n\n// Global error handlers\nwindow.addEventListener('unhandledrejection', function(event) {\n  console.error('Unhandled promise rejection:', event.reason);\n});\n\nwindow.addEventListener('error', function(event) {\n  console.error('Uncaught error:', event.error);\n});\n\n// Make functions globally available\nwindow.setFont = AppCore.setFont;\nwindow.onReadFile = AppCore.onReadFile;\nwindow.setStage = AppCore.setStage;\nwindow.passStyleValue = AppCore.passStyleValue;\nwindow.passfvarValue = AppCore.passfvarValue;\nwindow.passfeatValue = AppCore.passfeatValue;\nwindow.insertField = AppCore.insertField;\nwindow.localStorageClear = localStorageClear;\nwindow.saveEditableContent = saveEditableContent;\nwindow.saveInputValue = saveInputValue;\n\nconst init = (forceServerLoad = false) => {\n\ttry {\n\t  if (forceServerLoad || !['localhost', '127.0.0.1', ''].includes(location.hostname)) {\n\t\tAppCore.serverLoad();\n\t  } else {\n\t\tAppCore.localLoad();\n\t  }\n  \n\t  AppCore.setupEventListeners();\n\t  document.body.classList.add('loaded');\n  \n\t} catch (error) {\n\t  console.error('Error during initialization:', error);\n\t}\n  };\n\ndocument.addEventListener('DOMContentLoaded', () => init(false));"],"names":["showErrorMessage","message","el","document","getElementById","style","display","trim","length","textContent","console","error","localStorageClear","localStorage","clear","setItem","location","reload","toggleMode","body","newMode","getItem","removeAttribute","querySelector","setAttribute","toggleSettingsVisibility","settingsToggle","classList","toggle","whichFontSize","text","baseSize","arguments","undefined","ratio","toString","sizes","Math","round","pow","calculateTypeScale","charCount","saveData","id","value","Storage","content","getStoredContent","elementId","defaultContent","_regeneratorRuntime","e","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","asyncGeneratorStep","_asyncToGenerator","apply","_next","_throw","font","onFontLoaded","loadedFont","fontFamilySource","fontFamily","_ref","_callee","reject","_document$querySelect","fontFace","fontFaceRule","currentStage","_context","log","concat","window","FontFace","format","outlinesFormat","load","fonts","add","createElement","head","appendChild","ready","displayFontData","includes","hostname","dataset","stage","proofingPhase","setStage","t0","_x","_x2","onReadFile","event","files","target","fileButtonParent","innerHTML","navGroup","generateFontNavigation","generateFontButtons","Array","from","container","firstButton","click","setFont","_ref3","_callee3","fontPath","fontName","_context3","opentype","err","_x4","_x5","_ref4","_callee4","_document$querySelect2","tablename","styles","nameHtml","postScriptName","version","formattedVersion","modifiedDate","formattedDate","_context4","tables","t1","names","en","fontRevision","modified","Date","toLocaleDateString","_x6","article","stageButtons","warn","pendingStage","fetch","response","json","proof","html","generateStageHtml","buttonHtml","generateStageButtons","initTypeScale","lockDimensions","applyLockProofDimensions","gsubFeatures","gsub","features","taglist","filter","feature","tag","map","startsWith","title","textClass","testAreaID","itemID","sliderID","_getStoredStyles","getStoredStyles","fontSize","lineHeight","letterSpacing","fvarStyle","inlineStyle","generateFvarStyle","generateSliders","generateVariableSliders","generateStyleButtons","generateFeatureCheckboxes","generateProofContent","_document$getElementB","_document$getElementB2","_document$querySelect3","typeScale","parseFloat","getItemFontSize","getItemLineHeight","columnCount","columnGap","fvar","axes","axis","storedValue","defaultValue","join","hasCustomLineHeight","hasCustomFontSize","minValue","maxValue","generateFontButton","_ref5","_callee5","mode","fontType","isVariable","button","_args5","_context5","replace","split","toUpperCase","isVariableFont","URL","createObjectURL","className","onclick","querySelectorAll","btn","remove","_x7","_ref6","_callee6","arrayBuffer","parsedFont","_context6","parse","_x8","updateColumns","passStyleValue","uniqueTags","Set","_proof$Features2","featureDescription","_proof$Features","ssNum","parseInt","_font$names","nameID","getFeatureDescription","definition","sample","savedContent","savedTitle","generateTestAreaValues","styleMap","property","_style$split$map2","_slicedToArray","label","formattedValue","formatStyleValue","updateInlineText","fontSizeSlider","lineHeightSlider","letterSpacingSlider","currentStyles","entries","_ref7","_ref8","prop","val","elementIdSuffix","element","displayValue","slider","testarea","styleValue","removeStyleValue","removeItem","_document$getElementB4","_document$getElementB5","getGlobalLineHeight","valueDisplay","localLoad","data","arr","uniqueFonts","sort","preventDefaults","preventDefault","stopPropagation","highlight","unhighlight","handleDrop","handleFiles","dataTransfer","filesOrEvent","Event","uploadPromises","file","setTimeout","uploadFile","all","handleFileButtonClick","contains","parentNode","children","child","sibling","handleStageButtonClick","toggleToolsVisibility","setupPasteHandling","addEventListener","clipboardData","getData","selection","getSelection","rangeCount","range","getRangeAt","deleteContents","insertNode","createTextNode","dispatchEvent","_ref9","_callee7","chipsContainer","_iterator","_step","_font2","_args7","_context7","_createForOfIteratorHelper","_x9","prevButton","navigateFonts","nextButton","direction","buttons","activeButton","currentIndex","indexOf","_document$getElementB7","_document$getElementB8","item","itemLineHeight","itemFontSize","fontSizeVal","valuesDisplay","newSize","_ref10","_ref11","updateAllTypeScales","_document$getElementB9","_document$getElementB10","updateItemLineHeightDisplay","updateAllLineHeights","globalLineHeight","toggleNameAndVersion","isChecked","checked","toggleLockProofDimensions","storedSize","_document$getElementB11","lineHeightVal","_ref12","_ref13","reason","AppCore","passfvarValue","fvarSupport","fvarcss","_document$getElementB3","tagValue","fontVariationSettings","passfeatValue","featureSupport","featSupport","featcss","fontFeatureSettings","insertField","aboveHere","original","clone","cloneNode","now","input","insertBefore","height","overflow","transition","scrollHeight","saveEditableContent","innerText","saveInputValue","init","forceServerLoad","dragDropArea","fileInput","eventName","fileButtons","toolsToggle","modeToggle","localStorageClearButton","addNameAndVersionCheckbox","lockProofDimensionsCheckbox","savedState","aspectRatioSelect","savedRatio","baseFontInput","savedBaseSize","lineHeightInput","savedLineHeight","savedMode","typeScaleSelect"],"sourceRoot":""}