/*! For license information please see application.js.LICENSE.txt */
(()=>{"use strict";var t="src/js/proof.json";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}var n=function(t){var e=document.getElementById("message");e?(e.style.display=t&&t.trim().length>0?"block":"none",e.textContent=t):console.error("Message element not found. Error message:",t)},o=function(){localStorage.clear(),localStorage.setItem("proofingPhase","Hamburgers"),location.reload()};function a(){var t=document.body,e="light"===(localStorage.getItem("colorMode")||"light")?"dark":"light";localStorage.setItem("colorMode",e),"light"===e?(t.removeAttribute("data-theme"),document.querySelector("#btn__mode-toggle .material-symbols-outlined").textContent="light_mode"):(t.setAttribute("data-theme","dark"),document.querySelector("#btn__mode-toggle .material-symbols-outlined").textContent="dark_mode")}function r(){var t=document.getElementById("btn__settings-toggle");document.body.classList.toggle("settings-visible"),t.classList.toggle("settings-visible")}var c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.618;if(!t)return e.toString();var o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:14,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.618;return{"t__size-xxl":Math.round(t*Math.pow(e,5)),"t__size-xl":Math.round(t*Math.pow(e,4)),"t__size-l":Math.round(t*Math.pow(e,3)),"t__size-m":Math.round(t*Math.pow(e,2)),"t__size-s":Math.round(t*Math.pow(e,1)),"t__size-xs":t}}(e,n),a=t.length;return a<25?o["t__size-xxl"]:a<50?o["t__size-xl"]:a<95?o["t__size-l"]:a<200?o["t__size-m"]:a<1e3?o["t__size-s"]:o["t__size-xs"]},i=function(t,e){if("undefined"!=typeof Storage)if("thisContent"!==e)localStorage.setItem(t,e);else{var n=document.getElementById(t).textContent;localStorage.setItem(t,n)}},l=function(t){var e=document.getElementById(t);if(e){var n=e.innerText;localStorage.setItem(t,n)}else console.warn("Element with ID ".concat(t," not found"))},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return localStorage.getItem(t)||e};function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,a,r,c,i=[],l=!0,s=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=r.call(n)).done)&&(i.push(o.value),i.length!==e);l=!0);}catch(t){s=!0,a=t}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw a}}return i}}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=f(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){i=!0,r=t},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw r}}}}function f(t,e){if(t){if("string"==typeof t)return m(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function p(){var t=_(),e=t.m(p),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function o(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var a={throw:1,return:2,break:3,continue:3};function r(t){var e,n;return function(o){e||(e={stop:function(){return n(o.a,2)},catch:function(){return o.v},abrupt:function(t,e){return n(o.a,a[t],e)},delegateYield:function(t,a,r){return e.resultName=a,n(o.d,g(t),r)},finish:function(t){return n(o.f,t)}},n=function(t,n,a){o.p=e.prev,o.n=e.next;try{return t(n,a)}finally{e.next=o.n}}),e.resultName&&(e[e.resultName]=o.v,e.resultName=void 0),e.sent=o.v,e.next=o.n;try{return t.call(this,e)}finally{o.p=e.prev,o.n=e.next}}}return(p=function(){return{wrap:function(e,n,o,a){return t.w(r(e),n,o,a&&a.reverse())},isGeneratorFunction:o,mark:t.m,awrap:function(t,e){return new x(t,e)},AsyncIterator:S,async:function(t,e,n,a,c){return(o(e)?b:h)(r(t),e,n,a,c)},keys:y,values:g}})()}function g(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(v(t)+" is not iterable")}function y(t){var e=Object(t),n=[];for(var o in e)n.unshift(o);return function t(){for(;n.length;)if((o=n.pop())in e)return t.value=o,t.done=!1,t;return t.done=!0,t}}function h(t,e,n,o,a){var r=b(t,e,n,o,a);return r.next().then(function(t){return t.done?t.value:r.next()})}function b(t,e,n,o,a){return new S(_().w(t,e,n,o),a||Promise)}function S(t,e){function n(o,a,r,c){try{var i=t[o](a),l=i.value;return l instanceof x?e.resolve(l.v).then(function(t){n("next",t,r,c)},function(t){n("throw",t,r,c)}):e.resolve(l).then(function(t){i.value=t,r(i)},function(t){return n("throw",t,r,c)})}catch(t){c(t)}}var o;this.next||(w(S.prototype),w(S.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),w(this,"_invoke",function(t,a,r){function c(){return new e(function(e,o){n(t,r,e,o)})}return o=o?o.then(c,c):c()},!0)}function _(){var t,e,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function r(n,o,a,r){var l=o&&o.prototype instanceof i?o:i,s=Object.create(l.prototype);return w(s,"_invoke",function(n,o,a){var r,i,l,s=0,u=a||[],d=!1,f={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(e,n){return r=e,i=0,l=t,f.n=n,c}};function m(n,o){for(i=n,l=o,e=0;!d&&s&&!a&&e<u.length;e++){var a,r=u[e],m=f.p,v=r[2];n>3?(a=v===o)&&(l=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=t):r[0]<=m&&((a=n<2&&m<r[1])?(i=0,f.v=o,f.n=r[1]):m<v&&(a=n<3||r[0]>o||o>v)&&(r[4]=n,r[5]=o,f.n=v,i=0))}if(a||n>1)return c;throw d=!0,o}return function(a,u,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,v),i=u,l=v;(e=i<2?t:l)||!d;){r||(i?i<3?(i>1&&(f.n=-1),m(i,l)):f.n=l:f.v=l);try{if(s=2,r){if(i||(a="next"),e=r[a]){if(!(e=e.call(r,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,i<2&&(i=0)}else 1===i&&(e=r.return)&&e.call(r),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);r=t}else if((e=(d=f.n<0)?l:n.call(o,f))!==c)break}catch(e){r=t,i=1,l=e}finally{s=1}}return{value:e,done:d}}}(n,a,r),!0),s}var c={};function i(){}function l(){}function s(){}e=Object.getPrototypeOf;var u=[][o]?e(e([][o]())):(w(e={},o,function(){return this}),e),d=s.prototype=i.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,w(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=s,w(d,"constructor",s),w(s,"constructor",l),l.displayName="GeneratorFunction",w(s,a,"GeneratorFunction"),w(d),w(d,a,"Generator"),w(d,o,function(){return this}),w(d,"toString",function(){return"[object Generator]"}),(_=function(){return{w:r,m:f}})()}function w(t,e,n,o){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}w=function(t,e,n,o){function r(e,n){w(t,e,function(t){return this._invoke(e,n,t)})}e?a?a(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(r("next",0),r("throw",1),r("return",2))},w(t,e,n,o)}function x(t,e){this.v=t,this.k=e}function I(t,e,n,o,a,r,c){try{var i=t[r](c),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(o,a)}function E(t){return function(){var e=this,n=arguments;return new Promise(function(o,a){var r=t.apply(e,n);function c(t){I(r,o,a,c,i,"next",t)}function i(t){I(r,o,a,c,i,"throw",t)}c(void 0)})}}var k=null,L=function(t,e,n){return new Promise(function(){var o=E(p().mark(function o(a,r){var c,i,l,s,u;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,k=t,console.log("Font assigned globally: ".concat(n)),!("FontFace"in window)){o.next=9;break}return i=new FontFace(n,"url('".concat(e,"')"),{format:"truetype"===t.outlinesFormat?"truetype":"opentype"}),o.next=7,i.load();case 7:document.fonts.add(i),console.log("Font loaded successfully: ".concat(n));case 9:return l="\n\t\t  @font-face {\n\t\t\tfont-family: '".concat(n,"';\n\t\t\tsrc: url('").concat(e,"') format('").concat("truetype"===t.outlinesFormat?"truetype":"opentype","');\n\t\t  }\n\t\t"),(s=document.createElement("style")).textContent=l,document.head.appendChild(s),console.log("Font-face rule applied: ".concat(l)),window.fontFamily=n,console.log("Window.fontFamily set to: ".concat(n)),o.next=18,document.fonts.ready;case 18:return o.next=20,T(n);case 20:return["localhost","127.0.0.1",""].includes(location.hostname)&&(localStorage.setItem("fontFamily",n),localStorage.setItem("fontFamilySource",e),console.log("Font information saved to localStorage")),u=(null===(c=document.querySelector(".btn__stage.active"))||void 0===c||null===(c=c.dataset)||void 0===c?void 0:c.stage)||localStorage.getItem("proofingPhase")||window.proofingPhase||"Hamburgers",o.next=24,B(u);case 24:console.log("Stage set successfully"),a(),o.next=32;break;case 28:o.prev=28,o.t0=o.catch(0),console.error("Error in onFontLoaded:",o.t0),r(o.t0);case 32:case"end":return o.stop()}},o,null,[[0,28]])}));return function(t,e){return o.apply(this,arguments)}}())},F=function(t){var e=t.target.files,n=document.getElementById("section__header-file-buttons");n.innerHTML="";var o=ut();n.appendChild(o),st(Array.from(e),"server").then(function(t){n.appendChild(t);var e=t.querySelector(".btn__setfont");e&&e.click()})},A=function(){var t=E(p().mark(function t(e,o){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Attempting to load font: ".concat(o," from ").concat(e)),console.log("Font file extension: ".concat(e.split(".").pop())),opentype.load(e,function(t,a){if(t)console.error("Error loading font:",t),console.error("Font path:",e),console.error("Font name:",o),n("Error loading font: ".concat(t));else{var r,c,i,l,s;console.log("âœ… Font loaded successfully: ".concat(o)),console.log("ðŸ“‹ Font tables:",Object.keys(a.tables||{})),console.log("ðŸ”„ Has fvar table:",!(null===(r=a.tables)||void 0===r||!r.fvar)),console.log("ðŸŽ›ï¸ Font format:",a.outlinesFormat),null!==(c=a.tables)&&void 0!==c&&c.fvar?(console.log("ðŸ“Š Variable font axes:",(null===(i=a.tables.fvar.axes)||void 0===i?void 0:i.length)||0),console.log("ðŸ·ï¸ Named instances:",(null===(l=a.tables.fvar.instances)||void 0===l?void 0:l.length)||0),console.log("ðŸŽ¯ Axes details:",(null===(s=a.tables.fvar.axes)||void 0===s?void 0:s.map(function(t){return t.tag}))||[])):console.warn("âŒ No fvar table found - this is not a variable font"),k=a;try{L(a,e,o),B(localStorage.getItem("proofingPhase")||"Hamburgers")}catch(t){console.error("Error in onFontLoaded:",t),n("Error processing font: ".concat(t))}}});case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),T=function(){var t=E(p().mark(function t(e){var n,o,a,r,c,i,l,s,u,d;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a="",t.t0=p().keys(k.tables);case 2:if((t.t1=t.t0()).done){t.next=20;break}if(o=t.t1.value,k.tables[o],"name"!==o){t.next=18;break}return r="",c=k.names.postScriptName?k.names.postScriptName.en:"Untitled Font",i=k.tables.head.fontRevision,l="Ver ".concat(i),r+='<div class="section__header-name-font" spellcheck="false">'.concat(c,"</div>"),r+='<div class="section__header-name-version" spellcheck="false">'.concat(l,"</div>"),a+='.t__importedfontfamily { font-family: "'.concat(e,'" }'),s=k.tables.head.modified,u="Last edited ".concat(new Date(1e3*s).toLocaleDateString()),r+='<div class="section__header-name-date">'.concat(u,"</div>"),document.getElementById("section__header-names").innerHTML=r,t.abrupt("continue",2);case 18:t.next=2;break;case 20:document.getElementById("style__fontfamily").innerHTML=a,d=(null===(n=document.querySelector(".btn__stage.active"))||void 0===n||null===(n=n.dataset)||void 0===n?void 0:n.stage)||localStorage.getItem("proofingPhase")||window.proofingPhase||"Hamburgers",B(d);case 23:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),B=function(e){var n=document.getElementById("section__article-app"),o=document.getElementById("section__header-stage-buttons");if(!k)return console.warn("Font not loaded yet. Deferring stage setting."),void(window.pendingStage=e);fetch(t).then(function(t){return t.json()}).then(function(t){var a=C(t,e),r=Q(t,e);n.innerHTML=a,o.innerHTML=r,document.getElementById("style__opentype-features").innerHTML="",i("proofingPhase",e),ft();var c="true"===localStorage.getItem("lockProofDimensions");gt(c)}).catch(function(t){return console.error("Error loading JSON:",t)})},C=function(t,e){var n;if(!t[e])return'<div class="item d-flex t__center"><div class="item__proof">No features found! :...(</div></div>';var o=k.names.postScriptName.en,a=k.tables.head.fontRevision,r="Ver ".concat(a),i=(null===(n=k.tables.gsub)||void 0===n?void 0:n.features)||{},l=Object.values(i).filter(function(t){return"object"===v(t)&&t.tag}).map(function(t){return t.tag}).filter(function(e){return void 0!==t.Features[e]||e.startsWith("ss")}),s="";for(var u in t[e])if("Features"!==e||l.includes(u)){var f=c(t[e][u]),m="section__proofing-".concat(u),p="item--".concat(u),g="".concat(p),y=j(g,f),h=y.fontSize,b=y.lineHeight,S=y.letterSpacing,_=(y.inlineStyle,N(p));s+='\n      <div id="'.concat(p,'" class="item">\n        <button class="btn btn-link add-item-above chip" onclick="insertField(\'').concat(p,'\')">+ Add Proof Window</button>\n        <div class="item__container d-flex">\n          <div class="item__sliders pt-2">\n            <div class="item__sliders-wrapper">\n              ').concat(z(p,g,h,b,S),"\n              ").concat(H(p,g),"\n              ").concat(W(p),"\n              ").concat(J(p,t,l),'\n            </div>\n          </div>\n          <div class="item__proof ratio-letter">\n            <button class="btn btn-link remove-item-this invisible" onclick="removeElementsByID(\'').concat(p,"')\">Ã—</button>\n            ").concat(U(e,u,t,m,_,f),'\n            <div class="item__footer d-flex justify-content-between">\n              <span class="item__footer-name-font">').concat(o,'</span>\n              <span class="item__footer-name-version">').concat(r,"</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    ")}var w=JSON.parse(localStorage.getItem("customProofWindows")||"{}");if(w[e]&&w[e].length>0){var x,I=d(w[e]);try{for(I.s();!(x=I.n()).done;){var E=x.value,L="section__proofing-custom-".concat(E),F=j(E,"text-xl"),A=F.fontSize,T=F.lineHeight,B=F.letterSpacing,C=F.inlineStyle,q=N(E),O=localStorage.getItem("".concat(L,"-title"))||"Custom Proof Window",M=localStorage.getItem(L)||"This is a custom proof window. Type your text here.";s+='\n        <div id="'.concat(E,'" class="item custom-item">\n          <button class="btn btn-link add-item-above chip" onclick="insertField(\'').concat(E,'\')">+ Add Proof Window</button>\n          <div class="item__container d-flex">\n            <div class="item__sliders pt-2">\n              <div class="item__sliders-wrapper">\n                ').concat(z(E,E,A,T,B),"\n                ").concat(H(E,E),"\n                ").concat(W(E),"\n                ").concat(J(E,t,l),'\n                <div class="mt-2">\n                  <button class="btn btn-sm btn-danger d-flex align-items-center g-1" onclick="removeCustomProofWindow(\'').concat(E,'\')">\n                    <span class="material-symbols-outlined">delete</span>\n                    Remove this window\n                  </button>\n                </div>\n              </div>\n            </div>\n            <div class="item__proof ratio-letter">\n              <div class="d-flex justify-content-between">\n                <h6 class="h6" contentEditable="true" \n                    id="').concat(L,'-title"\n                    onkeyup="saveEditableContent(\'').concat(L,"-title')\">").concat(O,'</h6>\n              </div>\n              <div class="testarea-container">\n                <div id="').concat(L,'" \n                     style="').concat(C," ").concat(q,'" \n                     class="t__importedfontfamily testarea" \n                     contenteditable="true" \n                     spellcheck="false" \n                     onkeyup="saveEditableContent(\'').concat(L,"')\">\n                  ").concat(M,'\n                </div>\n              </div>\n              <div class="item__footer d-flex justify-content-between">\n                <span class="item__footer-name-font">').concat(o,'</span>\n                <span class="item__footer-name-version">').concat(r,"</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      ")}}catch(t){I.e(t)}finally{I.f()}}return s},j=function(t,e){var n,o,a,r=parseFloat((null===(n=document.getElementById("select__type-scale"))||void 0===n?void 0:n.value)||1.618),c=parseFloat((null===(o=document.getElementById("input__base-font-size"))||void 0===o?void 0:o.value)||14),i=(null===(a=document.querySelector("#".concat(t," .testarea")))||void 0===a?void 0:a.textContent)||e,l=ht(t,i,c,r),s=bt(t),u=localStorage.getItem("".concat(t,"-letterSpacing"))||"0",d=localStorage.getItem("".concat(t,"-column-count"))||"1",f=localStorage.getItem("".concat(t,"-column-gap"))||"1em";return{fontSize:l,lineHeight:s,letterSpacing:u,columnCount:d,columnGap:f,inlineStyle:"\n    font-size: ".concat(l,"pt;\n    line-height: ").concat(s,";\n    letter-spacing: ").concat(u,"em;\n    column-count: ").concat(d,";\n    column-gap: ").concat(f,";\n  ")}},N=function(t){var e="";return k.tables.fvar&&(k.tables.fvar.axes.map(function(t){return t.tag}),e="font-variation-settings: "+k.tables.fvar.axes.map(function(e){var n=localStorage.getItem("".concat(t,"-").concat(e.tag,"-val")),o=null!==n?n:e.defaultValue;return"'".concat(e.tag,"' ").concat(o)}).join(", ")+";"),e},z=function(t,e,n,o,a){var r=null!==localStorage.getItem("".concat(t,"-lineHeight")),c=null!==localStorage.getItem("".concat(t,"-fontSize")),i=null!==localStorage.getItem("".concat(t,"-letterSpacing"));return'\n    <div>\n      <label for="'.concat(e,'-fontSize">Font Size</label>\n      <span class="t__right text-small" id="').concat(e,'-fontSize-val">').concat(n,'pt</span>\n      <span class="t__right material-symbols-outlined remove" onclick="removeStyleValue(\'').concat(t,"', 'fontSize')\">clear</span>\n      <input id=\"").concat(e,'-fontSize" type="range" class="slider ').concat(c?"modified":"",'" \n        min="4" max="160" step="2" value="').concat(n,'" \n        oninput="passStyleValue(\'').concat(t,"', 'fontSize', this.value)\">\n    </div>\n    <div>\n      <label for=\"").concat(e,'-lineHeight">Line Height</label>\n      <span class="t__right text-small" id="').concat(e,'-lineHeight-val">').concat(o,'</span>\n      <span class="t__right material-symbols-outlined remove" onclick="removeStyleValue(\'').concat(t,"', 'lineHeight')\">clear</span>\n      <input id=\"").concat(e,'-lineHeight" type="range" class="slider ').concat(r?"modified":"",'" \n        min="0.6" max="3.0" step="0.01" value="').concat(o,'" \n        oninput="passStyleValue(\'').concat(t,"', 'lineHeight', this.value)\">\n    </div>\n    <div>\n      <label for=\"").concat(e,'-letterSpacing">Letter Spacing </label>\n      <span class="t__right text-small" id="').concat(e,'-letterSpacing-val">').concat(a,'em</span>\n      <span class="t__right material-symbols-outlined remove" onclick="removeStyleValue(\'').concat(t,"', 'letterSpacing')\">clear</span>\n      <input id=\"").concat(e,'-letterSpacing" type="range" class="slider ').concat(i?"modified":"",'" \n        min="-0.4" max="0.4" step="0.01" value="').concat(a,'" \n        oninput="passStyleValue(\'').concat(t,"', 'letterSpacing', this.value)\">\n    </div>\n  ")},H=function(t,e){if(!k.tables.fvar)return"";var n=q(),o=O(t,n),a=k.tables.fvar.axes.map(function(n){var o=localStorage.getItem("".concat(t,"-").concat(n.tag,"-val")),a=null!==o?o:n.defaultValue,r=M(n.tag),c=P(n,r);return'\n      <div class="variable-axis-container" data-axis="'.concat(n.tag,'">\n        <label for="').concat(e,"-").concat(n.tag,'">').concat(n.name.en,' </label>\n        <span class="t__right text-small" id="').concat(e,"-").concat(n.tag,'-val">').concat(a,'</span>\n        <div class="slider-container">\n          <input id="').concat(e,"-").concat(n.tag,'" type="range" class="slider variable-slider" \n                 min="').concat(n.minValue,'" max="').concat(n.maxValue,'" value="').concat(a,'" \n                 data-axis="').concat(n.tag,'"\n                 oninput="handleSliderInput(\'').concat(t,"', '").concat(n.tag,"', this.value, '").concat(k.tables.fvar.axes.map(function(t){return t.tag}).join(","),'\')"\n                 onchange="updateSliderNodes(this)">\n          ').concat(c,"\n        </div>\n      </div>\n    ")}).join("");return"\n    ".concat(a,"\n    ").concat(o,"\n  ")},q=function(){return k.tables.fvar&&k.tables.fvar.instances?k.tables.fvar.instances.map(function(t){var e;return{name:(null===(e=t.name)||void 0===e?void 0:e.en)||"Unnamed Instance",coordinates:t.coordinates}}):[]},O=function(t,e){if(!e.length)return"";var n="".concat(t,"-master-instances"),o=e.map(function(t){return"<option value='".concat(JSON.stringify(t.coordinates),"'>").concat(t.name,"</option>")}).join("");return'\n    <div class="master-instance-dropdown-container">\n      <label for="'.concat(n,'" class="text-small">Named Instances:</label>\n      <select id="').concat(n,'" class="instance-dropdown" \n              onchange="applyMasterInstance(\'').concat(t,'\', this)">\n        <option value="">Select Instance...</option>\n        ').concat(o,"\n      </select>\n    </div>\n  ")},M=function(t){if(!k.tables.fvar||!k.tables.fvar.instances)return[];var e=k.tables.fvar.instances.filter(function(e){return e.coordinates&&void 0!==e.coordinates[t]}).map(function(e){var n;return{name:(null===(n=e.name)||void 0===n?void 0:n.en)||"Unnamed Instance",value:e.coordinates[t],coordinates:e.coordinates}}),n=[],o=new Set;return e.forEach(function(t){o.has(t.value)||(o.add(t.value),n.push(t))}),n.sort(function(t,e){return t.value-e.value}).slice(0,10)},P=function(t,e){if(!e.length)return"";if(!t||"number"!=typeof t.maxValue||"number"!=typeof t.minValue)return console.warn("Invalid axis values for node generation:",t),"";var n=t.maxValue-t.minValue;return 0===n?(console.warn("Axis range is zero, cannot generate nodes"),""):(console.log("Generating ".concat(e.length," nodes for axis ").concat(t.tag)),e.map(function(e){if("number"!=typeof e.value)return console.warn("Invalid instance value:",e),"";var o=(e.value-t.minValue)/n*100;return isNaN(o)?(console.warn("Calculated NaN position for instance:",e,"axis:",t),""):'\n      <div class="slider-node" \n           style="left: calc('.concat(4+92*o/100,'% - 3px)" \n           title="').concat(e.name,": ").concat(e.value,'"\n           data-value="').concat(e.value,'"\n           onclick="snapToInstanceValue(\'').concat(t.tag,"', ").concat(e.value,')">\n      </div>\n    ')}).join(""))},V=function(){var t=E(p().mark(function t(e){var n,o,a,r,c,i,l,s,u,d=arguments;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l=!0,"local"!==(n=d.length>1&&void 0!==d[1]?d[1]:"local")){t.next=17;break}if(o=e.replace(".","-"),a="fonts/".concat(e),c=e.replace("-"," ").replace(/\.[^/.]+$/,""),r=e.split(".").pop().toUpperCase(),!(l=!["WOFF2"].includes(r))){t.next=14;break}return t.next=11,D(a);case 11:i=t.sent,t.next=15;break;case 14:i=!1;case 15:t.next=29;break;case 17:if(o=e.name.replace(".","-"),a=URL.createObjectURL(e),c=e.name.replace("-"," ").replace(/\.[^/.]+$/,""),r=e.name.split(".").pop().toUpperCase(),!(l=!["WOFF2"].includes(r))){t.next=28;break}return t.next=25,D(e);case 25:i=t.sent,t.next=29;break;case 28:i=!1;case 29:return i&&(r="VF"),(s=document.createElement("div")).className="btn__setfont chip btn d-flex justify-content-between",s.title="local"===n?e:e.name,s.id="btn__setfont-".concat(o),u=l?r:'<span style="text-decoration: line-through;">'.concat(r,"</span>"),s.innerHTML="".concat(c,'<span class="d-flex-grow text-small text-right">').concat(u,"</span>"),s.onclick=function(t){if(t.shiftKey)return s.classList.contains("secondary")?void xt():(document.querySelectorAll(".btn__setfont").forEach(function(t){t.classList.remove("secondary")}),s.classList.add("secondary"),localStorage.setItem("secondaryFontPath",a),localStorage.setItem("secondaryFontName",o),void wt(a,o));document.querySelectorAll(".btn__setfont").forEach(function(t){t.classList.remove("active"),t.classList.remove("visited"),t.classList.contains("secondary")||t.classList.remove("secondary")}),s.classList.add("active"),s.classList.add("visited"),A(a,o)},t.abrupt("return",s);case 38:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),D=function(){var t=E(p().mark(function t(e){var n,o,a;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"string"!=typeof e){t.next=10;break}return t.next=4,fetch(e);case 4:return o=t.sent,t.next=7,o.arrayBuffer();case 7:n=t.sent,t.next=13;break;case 10:return t.next=12,e.arrayBuffer();case 12:n=t.sent;case 13:return a=opentype.parse(n),t.abrupt("return",void 0!==a.tables.fvar);case 17:return t.prev=17,t.t0=t.catch(0),console.error("Error checking if font is variable:",t.t0),t.abrupt("return",!1);case 21:case"end":return t.stop()}},t,null,[[0,17]])}));return function(e){return t.apply(this,arguments)}}();window.updateColumns=function(t){var e=document.getElementById("".concat(t,"-column-count")).value,n=document.getElementById("".concat(t,"-column-gap")).value;$(t,"column-count",e),$(t,"column-gap",n)};var W=function(t){return'\n  <div id="btn__wrapper-case">\n    <label>Case</label>\n    <div class="d-flex g-1 btn__wrapper">\n      <button class="btn btn-link textTransform-uppercase" title="Uppercase" onclick="passStyleValue(\''.concat(t,"','textTransform', 'uppercase')\">TT</button>\n      <button class=\"btn btn-link textTransform-capitalize\" title=\"Capitalize\" onclick=\"passStyleValue('").concat(t,"','textTransform', 'capitalize')\">Tt</button>\n      <button class=\"btn btn-link textTransform-lowercase\" title=\"Lowercase\" onclick=\"passStyleValue('").concat(t,'\',\'textTransform\', \'lowercase\')">tt</button>\n    </div>\n  </div>\n  <div id="btn__wrapper-columns">\n    <label>Columns</label>\n    <div class="d-flex g-1 btn__wrapper">\n\t<span class="text-small">Count</span>\n      <input class="input" type="number" id="').concat(t,'-column-count" min="1" max="6" value="1" onchange="updateColumns(\'').concat(t,'\')" style="width: 50px;">\n\t<span class="text-small">Gap</span>\n      <input class="input" type="text" id="').concat(t,'-column-gap" value="10px" onchange="updateColumns(\'').concat(t,'\')" style="width: 50px;">\n    </div>\n  </div>\n')},J=function(t,e,n){var o,a=function(t){if(Array.isArray(t))return m(t)}(o=new Set(n))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||f(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return'\n      <label>Features</label>  \n      <div class="btn__wrapper d-flex flex-wrap g-0">\n        '.concat(a.map(function(n){var o,r=function(t,e,n){var o;if(e.startsWith("ss")){var a=parseInt(e.slice(2),10);if(a>=1&&a<=20){var r,c=a-1+256;return(null==t||null===(r=t.names)||void 0===r||null===(r=r[c])||void 0===r?void 0:r.en)||"Stylistic Set ".concat(a)}}return(null===(o=n.Features)||void 0===o||null===(o=o[e])||void 0===o?void 0:o.abstract)||e}(k,n,e),c=(null===(o=e.Features)||void 0===o||null===(o=o[n])||void 0===o?void 0:o.definition)||"";return'\n            <div title="'.concat(c,'" class="chip d-flex align-items-center justify-content-between d-flex-grow" onclick="document.getElementById(\'').concat(t,"-checkbox-").concat(n,'\').click()">\n              <input id="').concat(t,"-checkbox-").concat(n,'" type="checkbox" onclick="passfeatValue(\'').concat(t,"', '").concat(n,"', '").concat(a.join(","),'\')">\n              <span class="d-flex-grow">').concat(r,'</span>\n              <span class="tag-label text-small">').concat(n,"</span>\n            </div>\n          ")}).join(""),"\n      </div>\n    ")},U=function(t,e,n,o,a,r){if(!n||!n[t]||!n[t][e])return console.warn("Missing proof data:",{stage:t,title:e}),"";var i=n[t][e];"Features"===t&&(i=n[t][e].sample||"");var l=s(o,i)||"",u=s("".concat(o,"-title"),e)||"",d=c(l),f=bt(o),m=localStorage.getItem("".concat(o,"-letterSpacing"))||"0em",v=localStorage.getItem("".concat(o,"-column-count"))||"1",p=localStorage.getItem("".concat(o,"-column-gap"))||"1em",g="\n      font-size: ".concat(d,"pt;\n      line-height: ").concat(f,";\n      letter-spacing: ").concat(m,";\n      column-count: ").concat(v,";\n      column-gap: ").concat(p,";\n    ");return'\n      <div class="d-flex justify-content-between">\n        <h6 class="h6" contentEditable="true" \n            id="'.concat(o,'-title"\n            onkeyup="saveEditableContent(\'').concat(o,"-title')\">").concat(u,'</h6>\n      </div>\n      <div class="testarea-container">\n        <div id="').concat(o,'" \n             style="').concat(g," ").concat(a,'" \n             class="t__importedfontfamily testarea" \n             contenteditable="true" \n             spellcheck="false" \n             onkeyup="saveEditableContent(\'').concat(o,"')\">\n          ").concat(l,"\n        </div>\n      </div>\n    ")},G=function(t,e,n){var o=document.querySelector("#".concat(t," .testarea-values"));if(o){var a=document.querySelector("#".concat(t,"-fontSize")),r=document.querySelector("#".concat(t,"-lineHeight")),c=document.querySelector("#".concat(t,"-letterSpacing")),i={"font-size":"".concat((null==a?void 0:a.value)||"14","pt"),"line-height":(null==r?void 0:r.value)||"1.0","letter-spacing":"".concat((null==c?void 0:c.value)||"0","em")},l=Object.entries(i).map(function(t){var e=u(t,2),n=e[0],o=e[1];return"".concat(n,": ").concat(o)}).join("; ");o.innerHTML=generateTestAreaValues(l)}},R=function(){return localStorage.getItem("proofingPhase")||"Hamburgers"},$=function(t,e,n){var o="-".concat(e,"-val"),a=document.querySelector('[id$="'.concat(t).concat(o,'"]'));if(["fontSize","lineHeight","letterSpacing","column-count","column-gap"].includes(e)){localStorage.setItem("".concat(t,"-").concat(e),n);var r=n;"fontSize"===e&&(r+="pt"),"letterSpacing"===e&&(r+="em"),a&&(a.textContent=r);var c=document.querySelector("#".concat(t,"-").concat(e));c&&c.classList.add("modified")}var i=document.querySelector("#".concat(t," .testarea"));if(i){var l=n;"fontSize"===e&&(l+="pt"),"letterSpacing"===e&&(l+="em"),i.style[e]=l}G(t)},K=function(t,e,n,o){var a=document.getElementById("".concat(t,"-").concat(e,"-val"));a?a.textContent=n:console.warn("Element with ID ".concat(t,"-").concat(e,"-val not found.")),i("".concat(t,"-").concat(e,"-val"),n);var r=o.split(",").map(function(o){var a,r=o===e?n:null===(a=document.getElementById("".concat(t,"-").concat(o)))||void 0===a?void 0:a.value;return"'".concat(o,"' ").concat(r)}).join(", "),c=document.querySelector("#".concat(t," .testarea"));c?c.style.fontVariationSettings=r:console.warn("Test area with ID ".concat(t," not found.")),G(t)},Y=function(t){var e=t.closest(".slider-container");if(e){var n=e.querySelectorAll(".slider-node"),o=parseFloat(t.value),a=.03*(t.max-t.min),r=t.dataset.axis,c=t.id.replace("-".concat(r),""),i=!1;n.forEach(function(e){var n=parseFloat(e.dataset.value),l=Math.abs(o-n);l<=a?(e.classList.add("active"),!i&&l>0&&(t.value=n,i=!0,K(c,r,n,k.tables.fvar.axes.map(function(t){return t.tag}).join(",")))):e.classList.remove("active")});var l=document.getElementById("".concat(c,"-").concat(r,"-val"));l&&(l.textContent=t.value)}};window.removeStyleValue=function(t,e){var n;if(localStorage.removeItem("".concat(t,"-").concat(e)),"fontSize"===e){var o,a,r=document.querySelector("#".concat(t," .testarea")),i=(null==r?void 0:r.textContent)||"",l=parseFloat((null===(o=document.getElementById("select__type-scale"))||void 0===o?void 0:o.value)||1.618),s=parseFloat((null===(a=document.getElementById("input__base-font-size"))||void 0===a?void 0:a.value)||14);n=c(i,s,l)}else n="lineHeight"===e?St():"0";var u=document.querySelector("#".concat(t,"-").concat(e));u&&(u.value=n,u.classList.remove("modified"));var d=document.querySelector("#".concat(t,"-").concat(e,"-val"));if(d){var f=n;"fontSize"===e&&(f+="pt"),"letterSpacing"===e&&(f+="em"),d.textContent=f}var m=document.querySelector("#".concat(t," .testarea"));if(m){var v=n;"fontSize"===e&&(v+="pt"),"letterSpacing"===e&&(v+="em"),m.style[e]=v}G(t)};var Q=function(t,e){var n=JSON.parse(localStorage.getItem("hiddenTabs")||"[]"),o=Object.keys(t).filter(function(t){return!n.includes(t)});if(0===o.length&&Object.keys(t).length>0){var a="Hamburgers"in t?"Hamburgers":Object.keys(t)[0];o.push(a);var r=n.filter(function(t){return t!==a});localStorage.setItem("hiddenTabs",JSON.stringify(r))}return o.map(function(t){return'\n      <div class="tab-item '.concat(t===e?"active":"",' tab__setstage" onclick="setStage(\'').concat(t,'\')">\n      <a href="#" class="stage-button d-flex justify-content-between g-2">\n        <span class="stage-name">\n        ').concat(t,'\n        </span>\n        <span class="t__right tab-remove material-symbols-outlined remove" \n          onclick="event.stopPropagation(); removeTab(\'').concat(t,"')\">\n        clear\n        </span>\n      </a>\n      </div>\n    ")}).join("")};window.removeTab=function(e){var n=JSON.parse(localStorage.getItem("hiddenTabs")||"[]");n.includes(e)||(n.push(e),localStorage.setItem("hiddenTabs",JSON.stringify(n)));var o=localStorage.getItem("proofingPhase");o===e?fetch(t).then(function(t){return t.json()}).then(function(t){var e=Object.keys(t),o=e.filter(function(t){return!n.includes(t)});if(o.length>0)B(o[0]);else{var a="Hamburgers"in t?"Hamburgers":e[0];n.splice(n.indexOf(a),1),localStorage.setItem("hiddenTabs",JSON.stringify(n)),B(a)}}):fetch(t).then(function(t){return t.json()}).then(function(t){document.getElementById("section__header-stage-buttons").innerHTML=Q(t,o)})};var X=window.localStorageClear;window.localStorageClear=function(){X(),localStorage.removeItem("hiddenTabs")};var Z=function(){var t=document.getElementById("section__header-file-buttons");fetch("../src/txt/fonts.txt").then(function(t){return t.text()}).then(function(n){var o,a,r=n.split("fonts/").filter(function(t){return""!==t.trim()}).map(function(t){return t.trim()}),c=(o=r.sort(),function(t){if(Array.isArray(t))return e(t)}(a=new Set(o))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(a)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,n):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());if(0===c.length)t.innerHTML="Place fonts you want to proof into <code>/fonts</code> to begin";else{var i=ut();t.appendChild(i),st(c,"local").then(function(e){t.appendChild(e);var n=localStorage.getItem("fontFamilySource")||"fonts/".concat(c[c.length-1]),o=localStorage.getItem("fontFamily")||n.replace(".","-");A(n,o)})}}).catch(function(e){console.error("Error loading fonts:",e),t.innerHTML="Place fonts you want to proof into <code>/fonts</code> to begin"})};function tt(t){t.preventDefault(),t.stopPropagation()}function et(t){document.getElementById("drag-drop-area").classList.add("highlight")}function nt(t){document.getElementById("drag-drop-area").classList.remove("highlight")}function ot(t){at(t.dataTransfer.files)}function at(t){var e;e=t instanceof Event?t.target.files:t;var n=(e=Array.from(e)).map(function(t){return function(t){return new Promise(function(e){F({target:{files:[t]}}),setTimeout(e,50)})}(t)});Promise.all(n).then(function(){setTimeout(function(){var t=document.querySelector(".btn__setfont");t&&t.click()},100)})}var rt=function(t){t.target.classList.contains("btn__setfont")&&(t.target.classList.add("active","visited"),Array.from(t.target.parentNode.children).filter(function(e){return e!==t.target}).forEach(function(t){return t.classList.remove("active")}))},ct=function(t){t.target.classList.contains("btn__setstage")&&(t.target.classList.add("active"),Array.from(t.target.parentNode.children).filter(function(e){return e!==t.target}).forEach(function(t){return t.classList.remove("active")}))},it=function(){document.body.classList.toggle("tools-visible")},lt=function(){document.addEventListener("paste",function(t){if(t.target.classList.contains("testarea")){t.preventDefault();var e=(t.clipboardData||window.clipboardData).getData("text/plain"),n=window.getSelection();if(n.rangeCount){var o=n.getRangeAt(0);o.deleteContents(),o.insertNode(document.createTextNode(e))}else t.target.textContent+=e;var a=new Event("keyup");t.target.dispatchEvent(a)}}),document.addEventListener("keydown",function(t){if((t.metaKey||t.ctrlKey)&&"i"===t.key){var e=document.activeElement;e&&e.classList.contains("testarea")&&localStorage.getItem("secondaryFontName")&&(t.preventDefault(),document.execCommand("italic",!1,null))}})},st=function(){var t=E(p().mark(function t(e){var n,o,a,r,c,i,l=arguments;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=l.length>1&&void 0!==l[1]?l[1]:"local",document.createElement("div").className="font-buttons-container",(o=document.createElement("div")).className="font-chips",a=d(e),t.prev=6,a.s();case 8:if((r=a.n()).done){t.next=16;break}return c=r.value,t.next=12,V(c,n);case 12:i=t.sent,o.appendChild(i);case 14:t.next=8;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(6),a.e(t.t0);case 21:return t.prev=21,a.f(),t.finish(21);case 24:return t.abrupt("return",o);case 25:case"end":return t.stop()}},t,null,[[6,18,21,24]])}));return function(e){return t.apply(this,arguments)}}(),ut=function(){var t=document.createElement("div");t.className="btn-group d-flex g-1 mb-2 font-nav-group";var e=document.createElement("button");e.className="btn d-flex align-items-center justify-content-between d-flex-grow",e.innerHTML='<span class="material-symbols-outlined">chevron_left</span> Prev',e.onclick=function(){return dt("prev")};var n=document.createElement("button");n.className="btn font-play-btn d-flex align-items-center justify-content-center",n.title="Auto-cycle through fonts",n.innerHTML='<span class="material-symbols-outlined">play_arrow</span>',n.setAttribute("data-playing","false"),n.onclick=Et;var o=document.createElement("button");return o.className="btn d-flex align-items-center justify-content-between d-flex-grow",o.innerHTML='Next <span class="material-symbols-outlined">chevron_right</span>',o.onclick=function(){return dt("next")},t.appendChild(e),t.appendChild(n),t.appendChild(o),t},dt=function(t){var e=document.querySelectorAll(".btn__setfont"),n=document.querySelector(".btn__setfont.active");if(e.length){var o=0;if(n){var a=Array.from(e).indexOf(n);o="next"===t?(a+1)%e.length:(a-1+e.length)%e.length}e[o].click()}},ft=function(){var t,e,n=parseFloat((null===(t=document.getElementById("select__type-scale"))||void 0===t?void 0:t.value)||1.618),o=parseFloat((null===(e=document.getElementById("input__base-font-size"))||void 0===e?void 0:e.value)||14);document.querySelectorAll(".item").forEach(function(t){var e=t.id,a=t.querySelector(".testarea"),r=(null==a?void 0:a.textContent)||"",c=bt(e),i=ht(e,r,o,n);a&&(a.style.fontSize="".concat(i,"pt"),a.style.lineHeight=c);var l=t.querySelector("#".concat(e,"-fontSize")),s=t.querySelector("#".concat(e,"-fontSize-val"));l&&(l.value=i,localStorage.getItem("".concat(e,"-fontSize"))&&l.classList.add("modified")),s&&(s.textContent="".concat(i,"pt"))})},mt=function(){var t,e,n=parseFloat((null===(t=document.getElementById("select__type-scale"))||void 0===t?void 0:t.value)||1.618),o=parseFloat((null===(e=document.getElementById("input__base-font-size"))||void 0===e?void 0:e.value)||14);localStorage.setItem("preferred-scale",n),document.querySelectorAll(".item").forEach(function(t){var e=t.id,a=t.querySelector(".testarea"),r=(null==a?void 0:a.textContent)||"",c=ht(e,r,o,n),i=bt(e);a&&(a.style.fontSize="".concat(c,"pt"),a.style.lineHeight=i);var l=t.querySelector("#".concat(e,"-fontSize")),s=t.querySelector("#".concat(e,"-fontSize-val"));l&&(l.value=c,localStorage.getItem("".concat(e,"-fontSize"))&&l.classList.add("modified")),s&&(s.textContent="".concat(c,"pt")),_t(e,i)})},vt=function(){var t=St();localStorage.setItem("line-height",t),document.querySelectorAll(".item").forEach(function(e){var n=e.id;localStorage.getItem("".concat(n,"-lineHeight"))||_t(n,t)})},pt=function(t){var e=t.target.checked;localStorage.setItem("showNameAndVersion",e),document.body.classList.toggle("show-font-details",e)},gt=function(t){document.querySelectorAll(".item__proof").forEach(function(e){t?e.classList.add("locked-dimensions"):e.classList.remove("locked-dimensions")})},yt=function(t){var e=t.target.checked;localStorage.setItem("lockProofDimensions",e),gt(e)},ht=function(t,e,n,o){var a=localStorage.getItem("".concat(t,"-fontSize"));return null!==a?parseFloat(a):c(e,n,o)},bt=function(t){return parseFloat(localStorage.getItem("".concat(t,"-lineHeight"))||St())},St=function(){var t;return parseFloat((null===(t=document.getElementById("input__line-height"))||void 0===t?void 0:t.value)||localStorage.getItem("line-height")||1)},_t=function(t,e){var n=document.getElementById(t);if(n){var o=n.querySelector(".testarea"),a=n.querySelector("#".concat(t,"-lineHeight")),r=n.querySelector("#".concat(t,"-lineHeight-val")),c=n.querySelector(".testarea-values");if(o&&(o.style.lineHeight=e),a&&(a.value=e),r&&(r.textContent=e),c){var i={"font-size":(null==o?void 0:o.style.fontSize)||"14pt","line-height":"".concat(e),"letter-spacing":(null==o?void 0:o.style.letterSpacing)||"0em"};c.innerHTML=generateTestAreaValues(Object.entries(i).map(function(t){var e=u(t,2),n=e[0],o=e[1];return"".concat(n,": ").concat(o)}).join("; "))}}},wt=function(t,e){console.log("Applying secondary font: ".concat(e," from ").concat(t)),opentype.load(t,function(o,a){if(o)return console.error("Error loading secondary font:",o),void n("Error loading secondary font: ".concat(o));if(window.secondaryFont=a,"FontFace"in window){var r="".concat(e,"-secondary"),c=new FontFace(r,"url('".concat(t,"')"),{format:"truetype"===a.outlinesFormat?"truetype":"opentype"});c.load().then(function(){document.fonts.add(c),console.log("Secondary font loaded successfully: ".concat(r));var e="\n          @font-face {\n            font-family: '".concat(r,"';\n            src: url('").concat(t,"') format('").concat("truetype"===a.outlinesFormat?"truetype":"opentype","');\n          }\n        "),n=document.getElementById("style__secondary-font");n||((n=document.createElement("style")).id="style__secondary-font",document.head.appendChild(n)),n.textContent=e,n.textContent+='\n          .testarea em, \n          .testarea i, \n          .testarea [style*="italic"],\n          .testarea .emphasis,\n          .font-italic {\n            font-family: \''.concat(r,"', var(--font-secondary, sans-serif) !important;\n            font-style: normal !important;\n          }\n        ");var o=localStorage.getItem("proofingPhase")||"Hamburgers";B(o)})}})},xt=function(){var t=document.getElementById("style__secondary-font");t&&t.remove(),localStorage.removeItem("secondaryFontPath"),localStorage.removeItem("secondaryFontName"),document.querySelectorAll(".btn__setfont.secondary").forEach(function(t){t.classList.remove("secondary")}),window.secondaryFont=null,console.log("Secondary font cleared")},It=null,Et=function(t){var e=t.currentTarget;"true"===e.getAttribute("data-playing")?(Lt(),e.innerHTML='<span class="material-symbols-outlined">play_arrow</span>',e.setAttribute("data-playing","false")):(kt(),e.innerHTML='<span class="material-symbols-outlined">pause</span>',e.setAttribute("data-playing","true"))},kt=function(){Lt();var t=document.getElementById("input__cycle-speed"),e=t?parseInt(t.value,10):300,n=Math.max(100,e);It=setInterval(function(){dt("next")},n)},Lt=function(){It&&(clearInterval(It),It=null)},Ft=function(){var t=document.getElementById("input__cycle-speed");if(t){var e=localStorage.getItem("font-cycle-speed");e&&(t.value=e),t.addEventListener("change",function(){localStorage.setItem("font-cycle-speed",t.value);var e=document.querySelector(".font-play-btn");e&&"true"===e.getAttribute("data-playing")&&kt()})}};window.removeCustomProofWindow=function(t){var e=JSON.parse(localStorage.getItem("customProofWindows")||"{}"),n=R();if(e[n]){var o=e[n].indexOf(t);-1!==o&&(e[n].splice(o,1),localStorage.setItem("customProofWindows",JSON.stringify(e)))}var a=document.getElementById(t);a&&a.remove()},window.addEventListener("unhandledrejection",function(t){console.error("Unhandled promise rejection:",t.reason)}),window.addEventListener("error",function(t){console.error("Uncaught error:",t.error)}),window.setFont=A,window.onReadFile=F,window.setStage=B,window.passStyleValue=$,window.passfvarValue=K,window.passfeatValue=function(t,e,n){for(var o=n.split(","),a="",r=0;r<o.length;r++)document.getElementById("".concat(t,"-checkbox-").concat(o[r])).checked&&(a+="'".concat(o[r],"',"));a=a.replace(/,\s*$/,""),document.querySelector("#".concat(t," .testarea")).style.fontFeatureSettings=a},window.handleSliderInput=function(t,e,n,o){var a=document.getElementById("".concat(t,"-").concat(e));if(a){Y(a);var r=a.value;K(t,e,r,o)}},window.updateSliderNodes=Y,window.applyNamedInstance=function(t,e,n){var o=n.options[n.selectedIndex];if(o&&o.value)try{var a=JSON.parse(o.dataset.coordinates);Object.entries(a).forEach(function(e){var n=u(e,2),o=n[0],a=n[1],r=document.getElementById("".concat(t,"-").concat(o)),c=document.getElementById("".concat(t,"-").concat(o,"-val"));r&&(r.value=a,c&&(c.textContent=a),Y(r),K(t,o,a,k.tables.fvar.axes.map(function(t){return t.tag}).join(",")))}),k.tables.fvar.axes.forEach(function(n){if(n.tag!==e){var o=document.getElementById("".concat(t,"-").concat(n.tag,"-instances"));o&&(o.value="")}})}catch(t){console.error("Error applying named instance:",t)}},window.applyMasterInstance=function(t,e){var n=e.options[e.selectedIndex];if(n&&n.value)try{var o=JSON.parse(n.value);Object.entries(o).forEach(function(e){var n=u(e,2),o=n[0],a=n[1],r=document.getElementById("".concat(t,"-").concat(o)),c=document.getElementById("".concat(t,"-").concat(o,"-val"));r&&(r.value=a,K(t,o,a,k.tables.fvar.axes.map(function(t){return t.tag}).join(",")),Y(r)),c&&(c.textContent=a)})}catch(t){console.error("Error applying master named instance:",t)}},window.snapToInstanceValue=function(t,e){document.querySelectorAll('input[data-axis="'.concat(t,'"]')).forEach(function(n){var o=n.id.replace("-".concat(t),"");n.value=e,Y(n),K(o,t,e,k.tables.fvar.axes.map(function(t){return t.tag}).join(","));var a=document.getElementById("".concat(o,"-").concat(t,"-instances"));if(a){var r=Array.from(a.options).find(function(t){return parseFloat(t.value)===e});a.value=r?e:""}})},window.insertField=function(t){var e=document.getElementById(t),n=e.cloneNode(!0),o=Date.now(),a="custom-item-".concat(o),r=e.id;n.id=a,n.querySelectorAll("[id]").forEach(function(t){t.id="".concat(t.id,"-clone-").concat(o)}),n.querySelectorAll("[oninput]").forEach(function(t){var e=t.getAttribute("oninput").replace(new RegExp("'".concat(r,"'"),"g"),"'".concat(a,"'"));t.setAttribute("oninput",e)}),n.querySelectorAll("[onclick]").forEach(function(t){var e=t.getAttribute("onclick").replace(new RegExp("'".concat(r,"'"),"g"),"'".concat(a,"'"));t.setAttribute("onclick",e)}),n.querySelectorAll("input").forEach(function(t){"range"===t.type||(t.value="")});var c=n.querySelector(".testarea");c&&(c.innerHTML="This is a new custom proof window. Type your text here.",l(c.id));var i=n.querySelector('[id$="-title"]');i&&(i.innerHTML="Custom Proof Window",l(i.id)),e.parentNode.insertBefore(n,e),n.style.height="0px",n.style.overflow="hidden",n.style.transition="height 0.6s ease",setTimeout(function(){n.style.height="".concat(n.scrollHeight,"px")},0),setTimeout(function(){var t,e,o;n.style.height="auto",n.style.overflow="visible",t=a,e=R(),(o=JSON.parse(localStorage.getItem("customProofWindows")||"{}"))[e]||(o[e]=[]),o[e].includes(t)||(o[e].push(t),localStorage.setItem("customProofWindows",JSON.stringify(o)),console.log('Added custom window "'.concat(t,'" to stage "').concat(e,'"')),console.log("Custom windows:",JSON.stringify(o)))},600)},window.clearSecondaryFont=xt,window.localStorageClear=o,window.saveEditableContent=l,window.saveInputValue=function(t){var e=document.getElementById(t);e?localStorage.setItem(t,e.value):console.warn("Element with ID ".concat(t," not found"))};var At=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{t||!["localhost","127.0.0.1",""].includes(location.hostname)?function(){var t=document.getElementById("section__header-file-buttons");A("fonts/gooper-VF.ttf","gooper-VF-ttf"),document.getElementById("style__fontface").innerHTML='@font-face { font-family: "gooper-VF-ttf"; src: url("fonts/gooper-VF.ttf");}',t.innerHTML='\n\t  <div id="drag-drop-area" class="drag-drop-area">\n\t\t<p>Drag & drop font files here or </p>\n\t\t<label for="fontInput" class="file-input-label">Choose Files</label>\n\t\t<input id="fontInput" type="file" class="file-input" multiple accept=".ttf,.otf,.woff,.woff2" />\n    <p class="">.woff2 variable fonts are not currently supported</p>\n\t  </div>\n\t';var e=document.getElementById("drag-drop-area"),n=document.getElementById("fontInput");["dragenter","dragover","dragleave","drop"].forEach(function(t){e.addEventListener(t,tt,!1),document.body.addEventListener(t,tt,!1)}),["dragenter","dragover"].forEach(function(t){e.addEventListener(t,et,!1)}),["dragleave","drop"].forEach(function(t){e.addEventListener(t,nt,!1)}),e.addEventListener("drop",ot,!1),n.addEventListener("change",at,!1)}():Z(),function(){var t=document.getElementById("section__header-file-buttons"),e=document.getElementById("section__header-stage-buttons"),n=document.getElementById("btn__view-tools-toggle"),c=document.getElementById("btn__mode-toggle"),i=document.getElementById("btn__reset-local-storage"),l=document.getElementById("btn__settings-toggle"),s=document.getElementById("checkbox__add-name-and-version"),u=document.getElementById("checkbox__lock-proof-dimensions");if(t&&t.addEventListener("click",rt),e&&e.addEventListener("click",ct),n&&n.addEventListener("click",it),c&&c.addEventListener("click",a),i&&i.addEventListener("click",o),l&&l.addEventListener("click",r),s){var d="true"===localStorage.getItem("showNameAndVersion");s.checked=d,document.body.classList.toggle("show-font-details",d),s.addEventListener("change",pt)}if(u){var f="true"===localStorage.getItem("lockProofDimensions");u.checked=f,gt(f),u.addEventListener("change",yt)}lt();var m=document.getElementById("select__aspect-ratio");if(m){document.querySelectorAll(".item__proof").forEach(function(t){return t.classList.add("ratio-letter")}),m.addEventListener("change",function(t){var e=t.target.value;document.querySelectorAll(".item__proof").forEach(function(t){t.classList.remove("ratio-letter","ratio-a4"),t.classList.add("8.5:11"===e?"ratio-letter":"ratio-a4")}),localStorage.setItem("preferred-ratio",e)});var v=localStorage.getItem("preferred-ratio");v&&(m.value=v,m.dispatchEvent(new Event("change")))}var p=document.getElementById("input__base-font-size");if(p){p.addEventListener("change",function(t){var e=parseFloat(t.target.value);localStorage.setItem("base-font-size",e),mt()});var g=localStorage.getItem("base-font-size")||"14";p.value=g}var y=document.getElementById("input__line-height");if(y){y.addEventListener("change",function(t){var e=parseFloat(t.target.value);localStorage.setItem("line-height",e),vt()});var h=St();y.value=h}var b,S,_=document.getElementById("select__type-scale");_&&_.addEventListener("change",function(){mt()}),b=localStorage.getItem("colorMode")||"light",S=document.body,"dark"===b?(S.setAttribute("data-theme","dark"),document.querySelector("#btn__mode-toggle .material-symbols-outlined").textContent="dark_mode"):(S.removeAttribute("data-theme"),document.querySelector("#btn__mode-toggle .material-symbols-outlined").textContent="light_mode"),Ft()}(),document.body.classList.add("loaded")}catch(t){console.error("Error during initialization:",t)}};document.addEventListener("DOMContentLoaded",function(){return At(!1)})})();
//# sourceMappingURL=application.js.map